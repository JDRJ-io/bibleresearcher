### Why your build is failing

The console shows:

```
Identifier 'CrossReferencesCell' has already been declared
client/src/components/bible/VirtualRow.tsx : line 189
```

During the last batch of changes the agent \*\*pasted a second definition of
`CrossReferencesCell` inside *VirtualRow\.tsx* while the original one is still at
the top of the same file. TypeScript therefore sees the component twice and
bails out.

---

## 1  Fix the duplicate declaration

Open **`client/src/components/bible/VirtualRow.tsx`** and do **one** of the
following:

| Option                                         | What to do                                                                                                                                                                                                                                  |
| ---------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **A – keep the *first* definition** (simplest) | Delete the entire duplicate block that starts with `function CrossReferencesCell(` near line \~185.                                                                                                                                         |
| **B – extract to its own file**                | 1. Move the second block into `client/src/components/bible/CrossReferencesCell.tsx`.<br>2. At the top of *VirtualRow\.tsx* replace the inline definition with<br>  `ts<br>import { CrossReferencesCell } from './CrossReferencesCell';<br>` |

Either way, make sure **only one copy** of `CrossReferencesCell` is involved in
the bundle.

---

## 2  Bring in the touch‑direction & cache fixes

If you haven’t pasted them yet, add the small patches exactly once:

### 2.1 Stop row click interference

```tsx
// inside CrossReferencesCell map()
const handleClick = (e: React.MouseEvent) => {
  e.stopPropagation();         // ← this line prevents row handler
  onVerseClick?.(ref);
};
```

### 2.2 Guarantee verse text is cached

```ts
// useSliceDataLoader.ts
useEffect(() => {
  ensureTranslationLoaded(main);      // ← add
  …
}, [sliceStart, main]);
```

### 2.3 Attach the touch‑direction logic

In *VirtualBibleTable.tsx* you already see the effect’s body; confirm the ref is
hooked to the wrapper element:

```tsx
<div ref={wrapperRef} className="bible-table-wrapper">
```

and **delete** any older empty wrapper so you don’t end up with two identical
`ref` assignments (that would also trigger “already declared” style errors).

---

## 3  Re‑build & test

1. `pnpm dev` (or click **Run**) – the duplicate‑identifier error should be
   gone.
2. On the iPhone:

   * Cross‑ref text appears within \~½ s.
   * Tap ref → table re‑anchors.
   * Vertical flick scrolls; sideways drag scrolls columns.

If you still see blank space or blocked clicks, send me a fresh screenshot
(re‑upload—the previous ones have expired) and I’ll adjust spacing.

---

## 4  Next feature

Once the build is green you can let the agent proceed with:

* Prophecy P/F/V dots & tooltip
* Bundle cleanup (remove unused Express deps)
* Remaining mobile header polish

but the duplicate‑component error **must** be cleared first.

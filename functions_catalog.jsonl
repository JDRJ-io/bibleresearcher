{"file":"client/src/App.tsx","lines":"73-946","symbol":"useBibleStore","kind":"react_hook","export":"named","signature":"create<BibleStoreInterface>((set, get) => ({ ... }))","governs":{"ui":"manages all Bible interface state including column visibility, search modals, theme switching","state":"central Zustand store: translations, prophecies, cross-refs, notes, bookmarks, column layout, size controls","data":"loads/caches Bible data from Supabase storage: translations, cross-refs, prophecy data, dates, labels","routing":"none","side_effects":"triggers data loading when features toggled, manages event emissions for UI updates","auth":"integrates with user session for personalized data","errors":"handles data loading failures with fallbacks and error logging","dependencies":["zustand","@/data/BibleDataAPI","@/lib/labelBits"]},"calls":["loadCrossRefsData","loadProphecyData","loadDatesData","getContextGroups","buildActiveColumns","getVisibleSlice"],"called_by":["App","BiblePage","NewColumnHeaders","VirtualRow","all Bible components"],"related_files":["client/src/data/BibleDataAPI.ts","client/src/hooks/useColumnData.ts"],"query_or_table_refs":[],"notes":"Central state management hub for entire Bible study application; controls 20-column layout system"}
{"file":"client/src/App.tsx","lines":"947-969","symbol":"App","kind":"component","export":"default","signature":"() => JSX.Element","governs":{"ui":"renders main application shell with routing, providers, background, toast notifications","state":"none directly - delegates to providers","data":"none directly - delegates to providers","routing":"uses wouter for client-side routing between pages (bible, auth, profile, etc.)","side_effects":"imports preloader for immediate Bible data loading","auth":"wraps app in AuthProvider for authentication context","errors":"none directly - handled by child components","dependencies":["wouter","@tanstack/react-query","@/lib/queryClient","@/components/ui/toaster"]},"calls":["Switch","Route","QueryClientProvider","TooltipProvider","ThemeProvider","AuthProvider","HighlightProvider","DynamicBackground"],"called_by":["main.tsx"],"related_files":["client/src/main.tsx","client/src/lib/preloader.ts"],"query_or_table_refs":[],"notes":"Main application component providing routing and context providers"}
{"file":"client/src/hooks/useResponsiveColumns.ts","lines":"29-147","symbol":"useResponsiveColumns","kind":"react_hook","export":"named","signature":"(): ResponsiveColumnConfig","governs":{"ui":"calculates responsive column widths and alignment based on screen size and orientation","state":"manages window dimensions state and responsive configuration","data":"none","routing":"none","side_effects":"listens to window resize events for responsive updates","auth":"none","errors":"none","dependencies":["react"]},"calls":["useState","useEffect","useMemo"],"called_by":["VirtualRow","NewColumnHeaders","BiblePage"],"related_files":["client/src/components/bible/VirtualRow.tsx"],"query_or_table_refs":[],"notes":"Core responsive design system for Bible column layout; calculates optimal widths for portrait/landscape modes"}
{"file":"client/src/data/BibleDataAPI.ts","lines":"24-42","symbol":"fetchFromStorage","kind":"function","export":"named","signature":"(path: string): Promise<string>","governs":{"ui":"none","state":"none","data":"downloads text files from Supabase 'anointed' storage bucket","routing":"none","side_effects":"network requests to Supabase storage","auth":"none directly - relies on Supabase auth","errors":"throws Error if download fails","dependencies":["@/lib/supabaseClient"]},"calls":["supabase.storage.from().download()"],"called_by":["loadTranslation","loadVerseKeys","loadProphecyData","getLabelsData","getDatesCanonical"],"related_files":["client/src/lib/supabaseClient.ts"],"query_or_table_refs":["supabase.storage.anointed"],"notes":"Core data loading function for all Bible content from Supabase Storage"}
{"file":"client/src/data/BibleDataAPI.ts","lines":"81-113","symbol":"loadTranslation","kind":"function","export":"named","signature":"(id: string): Promise<Map<string, string>>","governs":{"ui":"none","state":"caches translation data in masterCache for instant access","data":"loads Bible translation text files, parses verse format (reference#text)","routing":"none","side_effects":"caches parsed translation data, logs loading progress","auth":"none","errors":"none explicitly - relies on fetchFromStorage error handling","dependencies":["@/lib/supabaseClient"]},"calls":["fetchFromStorage","masterCache.set"],"called_by":["useBibleStore","BibleDataAPI.searchVerses","preloader"],"related_files":["client/src/lib/supabaseClient.ts","client/src/lib/preloader.ts"],"query_or_table_refs":["supabase.storage.anointed/translations/"],"notes":"Primary Bible text loader with aggressive caching; supports KJV, AMP, CSB, etc."}
{"file":"client/src/data/BibleDataAPI.ts","lines":"367-437","symbol":"getCrossRefsBatch","kind":"function","export":"named","signature":"(verseIds: string[], cfSet?: 'cf1' | 'cf2'): Promise<Record<string, string[]>>","governs":{"ui":"none","state":"none","data":"loads cross-reference data using optimized HTTP Range requests for batch verse loading","routing":"none","side_effects":"network requests with HTTP 206 Partial Content, logs optimization metrics","auth":"none","errors":"returns empty object on failure, logs errors","dependencies":["@/lib/supabaseClient"]},"calls":["getCfOffsets","fetchSlice","supabase.storage.download()"],"called_by":["getCrossReferences","useBibleStore.loadCrossRefsData","cross-reference system"],"related_files":["client/src/hooks/useCrossRefLoader.ts"],"query_or_table_refs":["supabase.storage.anointed/references/"],"notes":"Expert-optimized cross-reference loader using HTTP Range requests; handles 29k+ verses efficiently"}
{"file":"client/src/data/BibleDataAPI.ts","lines":"498-568","symbol":"loadProphecyData","kind":"function","export":"named","signature":"(): Promise<{verseRoles: Record<string, {P: number[], F: number[], V: number[]}>, prophecyIndex: Record<number, {summary: string, prophecy: string[], fulfillment: string[], verification: string[]}>}>","governs":{"ui":"none","state":"none","data":"loads prophecy system data from Supabase: verse roles (P/F/V) and prophecy definitions","routing":"none","side_effects":"parses complex prophecy format, logs loading progress","auth":"none","errors":"returns empty objects on failure, logs errors","dependencies":["@/data/BibleDataAPI"]},"calls":["loadProphecyRows","loadProphecyIndex"],"called_by":["useBibleStore.toggleProphecies","prophecy system"],"related_files":["client/src/lib/prophecyCache.ts"],"query_or_table_refs":["supabase.storage.anointed/references/prophecy_rows.json","supabase.storage.anointed/references/prophecy_index.txt"],"notes":"Loads Bible prophecy system linking predictions, fulfillments, and verification verses"}
{"file":"server/index.ts","lines":"14-45","symbol":"server","kind":"function","export":"internal","signature":"Express application setup","governs":{"ui":"none","state":"none","data":"none directly","routing":"Express server with /api routes for storage, users, auth, profile, Stripe","side_effects":"starts HTTP server on PORT 3001, serves static files","auth":"delegates to auth routes","errors":"none explicitly","dependencies":["express","cors","./routes/*"]},"calls":["app.use","app.listen","registerStripeRoutes"],"called_by":["main execution"],"related_files":["server/routes/auth.ts","server/routes/users.ts","server/routes/stripe.ts"],"query_or_table_refs":[],"notes":"Main Express server providing API endpoints for the Bible study application"}
{"file":"server/routes/auth.ts","lines":"19-37","symbol":"username-available","kind":"api_handler","export":"internal","signature":"GET /api/auth/username-available","governs":{"ui":"none","state":"none","data":"checks username availability in database","routing":"GET endpoint for username validation","side_effects":"database query to check username existence","auth":"none - public endpoint","errors":"returns 500 on database errors","dependencies":["express","zod","../lib/supabase"]},"calls":["supabaseAdmin.rpc('username_available')"],"called_by":["client signup forms"],"related_files":["migration-username-function.sql"],"query_or_table_refs":["username_available() SQL function"],"notes":"API endpoint for real-time username availability checking during signup"}
{"file":"server/routes/auth.ts","lines":"40-72","symbol":"signup","kind":"api_handler","export":"internal","signature":"POST /api/auth/signup","governs":{"ui":"none","state":"none","data":"creates new user account with username and email","routing":"POST endpoint for user registration","side_effects":"creates user in Supabase auth system","auth":"creates new authenticated user","errors":"returns 400 on validation/signup errors","dependencies":["express","zod","@supabase/supabase-js"]},"calls":["supabaseClient.auth.signUp()"],"called_by":["client signup forms"],"related_files":["shared/schema.ts","migration-username-function.sql"],"query_or_table_refs":["auth.users","profiles"],"notes":"User registration endpoint with username validation and profile creation"}
{"file":"shared/schema.ts","lines":"5-10","symbol":"users","kind":"sql_function","export":"named","signature":"pgTable definition","governs":{"ui":"none","state":"none","data":"PostgreSQL table definition for users with id, email, name, created_at","routing":"none","side_effects":"none","auth":"stores user authentication data","errors":"none","dependencies":["drizzle-orm"]},"calls":[],"called_by":["database migrations","user-related operations"],"related_files":["migration.sql"],"query_or_table_refs":["users table"],"notes":"Core user table definition for authentication and profile management"}
{"file":"shared/schema.ts","lines":"23-28","symbol":"notes","kind":"sql_function","export":"named","signature":"pgTable definition","governs":{"ui":"none","state":"none","data":"PostgreSQL table for verse notes with user_id, verse_ref, text","routing":"none","side_effects":"none","auth":"enforces user ownership via RLS","errors":"none","dependencies":["drizzle-orm"]},"calls":[],"called_by":["notes CRUD operations","user data sync"],"related_files":["client/src/hooks/useNotes.ts","migration.sql"],"query_or_table_refs":["notes table"],"notes":"Stores user's verse-specific notes with reference to Bible verses"}
{"file":"shared/schema.ts","lines":"43-51","symbol":"userBookmarks","kind":"sql_function","export":"named","signature":"pgTable definition","governs":{"ui":"none","state":"none","data":"PostgreSQL table for user bookmarks with translation, verse_key","routing":"none","side_effects":"none","auth":"user-specific via user_id foreign key","errors":"none","dependencies":["drizzle-orm"]},"calls":[],"called_by":["bookmark CRUD operations","user data sync"],"related_files":["client/src/hooks/useBookmarks.ts","migration.sql"],"query_or_table_refs":["user_bookmarks table"],"notes":"User bookmark storage linking to specific Bible verses and translations"}
{"file":"shared/schema.ts","lines":"66-78","symbol":"userHighlights","kind":"sql_function","export":"named","signature":"pgTable definition","governs":{"ui":"none","state":"none","data":"PostgreSQL table for verse text highlights with segments (JSON), translation, verse_key","routing":"none","side_effects":"none","auth":"user-specific via user_id foreign key","errors":"none","dependencies":["drizzle-orm"]},"calls":[],"called_by":["highlight CRUD operations","user data sync"],"related_files":["client/src/hooks/useHighlights.ts","migration.sql"],"query_or_table_refs":["user_highlights table"],"notes":"Stores user text highlighting data as JSON segments for Bible verses"}
{"file":"client/src/components/bible/NewColumnHeaders.tsx","lines":"52-535","symbol":"NewColumnHeaders","kind":"component","export":"named","signature":"(props: NewColumnHeadersProps) => JSX.Element","governs":{"ui":"renders column headers with drag-and-drop reordering, presentation mode toggle, width controls","state":"integrates with useBibleStore for column visibility and adaptive width system","data":"none directly","routing":"none","side_effects":"CSS variable updates for column widths, event emissions for column changes","auth":"checks unlockMode for editing permissions","errors":"none explicitly","dependencies":["react","@dnd-kit/core","@dnd-kit/sortable","zustand"]},"calls":["useAdaptivePortraitColumns","useBibleStore","useTranslationMaps","DndContext","SortableContext"],"called_by":["VirtualBibleTable","BiblePage"],"related_files":["client/src/hooks/useAdaptivePortraitColumns.ts","client/src/utils/scrollNav.ts"],"query_or_table_refs":[],"notes":"Advanced column header system with drag-and-drop reordering and responsive width management"}
{"file":"client/src/components/bible/VirtualRow.tsx","lines":"1-1031","symbol":"VirtualRow","kind":"component","export":"default","signature":"({ verse, index, style }: VirtualRowProps) => JSX.Element","governs":{"ui":"renders individual Bible verse rows with translation cells, cross-references, prophecy indicators, notes","state":"integrates with useBibleStore for verse data and column configuration","data":"displays verse text, cross-references, prophecy data, user notes","routing":"none","side_effects":"handles double-click navigation, responsive width calculations","auth":"requires user for notes and highlights functionality","errors":"handles missing verse data gracefully","dependencies":["react","zustand","@/data/BibleDataAPI"]},"calls":["useBibleStore","useResponsiveColumns","ReferenceCell","CrossReferencesCell","TranslationCell","renderSlot"],"called_by":["VirtualBibleTable","react-window"],"related_files":["client/src/hooks/useResponsiveColumns.ts","client/src/data/BibleDataAPI.ts"],"query_or_table_refs":[],"notes":"Core Bible verse rendering component with full column system integration"}
{"file":"client/src/components/bible/VirtualBibleTable.tsx","lines":"1-200","symbol":"VirtualBibleTable","kind":"component","export":"default","signature":"({ verses }: VirtualBibleTableProps) => JSX.Element","governs":{"ui":"manages virtual scrolling Bible table with headers and verse rows","state":"integrates multiple hooks for column management, scrolling, and data loading","data":"none directly - delegates to child components","routing":"none","side_effects":"virtual scrolling performance optimizations, column width measurements","auth":"none directly","errors":"none explicitly","dependencies":["react","react-window","@/components/bible/NewColumnHeaders","@/components/bible/VirtualRow"]},"calls":["NewColumnHeaders","FixedSizeList","VirtualRow","useMeasureVisibleColumns","useColumnData"],"called_by":["BiblePage"],"related_files":["client/src/hooks/useMeasureVisibleColumns.ts","client/src/hooks/useColumnData.ts"],"query_or_table_refs":[],"notes":"Main Bible table component implementing virtual scrolling for 31k+ verses"}
{"file":"client/src/lib/queryClient.ts","lines":"10-35","symbol":"apiRequest","kind":"function","export":"named","signature":"(url: string, method: string, data?: unknown, userId?: string): Promise<Response>","governs":{"ui":"none","state":"none","data":"makes HTTP requests to API endpoints with authentication headers","routing":"none","side_effects":"HTTP requests with credentials, JSON serialization","auth":"adds user ID header for authenticated requests","errors":"throws on non-OK responses with status and message","dependencies":["fetch API"]},"calls":["fetch","throwIfResNotOk"],"called_by":["TanStack Query mutations","user data operations"],"related_files":["server/routes/*"],"query_or_table_refs":[],"notes":"Primary HTTP client for API communication with error handling and auth"}
{"file":"client/src/lib/queryClient.ts","lines":"55-68","symbol":"queryClient","kind":"function","export":"named","signature":"QueryClient instance","governs":{"ui":"none","state":"manages React Query cache and configuration","data":"global query caching for API requests","routing":"none","side_effects":"HTTP requests via getQueryFn","auth":"handles 401 errors appropriately","errors":"configured retry behavior and error handling","dependencies":["@tanstack/react-query"]},"calls":["getQueryFn"],"called_by":["App","all components using useQuery/useMutation"],"related_files":["client/src/App.tsx"],"query_or_table_refs":[],"notes":"Global React Query client with custom configuration for Bible app"}
{"file":"client/src/hooks/useAdaptivePortraitColumns.ts","lines":"22-95","symbol":"calculatePrecisionPortraitWidths","kind":"function","export":"internal","signature":"(viewportWidth: number, viewportHeight: number): AdaptiveWidths","governs":{"ui":"calculates exact column widths for portrait mode responsive design","state":"none","data":"none","routing":"none","side_effects":"none","auth":"none","errors":"none","dependencies":["none"]},"calls":[],"called_by":["useAdaptivePortraitColumns"],"related_files":["client/src/hooks/useAdaptivePortraitColumns.ts"],"query_or_table_refs":[],"notes":"Precision calculator for 3-column portrait layout ensuring perfect fit"}
{"file":"client/src/hooks/useAdaptivePortraitColumns.ts","lines":"97-150","symbol":"useAdaptivePortraitColumns","kind":"react_hook","export":"named","signature":"(): AdaptivePortraitConfig","governs":{"ui":"manages adaptive column widths for portrait orientation","state":"tracks window dimensions and CSS variable updates","data":"none","routing":"none","side_effects":"updates CSS variables for adaptive widths, window resize listener","auth":"none","errors":"none","dependencies":["react"]},"calls":["calculatePrecisionPortraitWidths","useState","useEffect","document.documentElement.style.setProperty"],"called_by":["NewColumnHeaders","VirtualRow"],"related_files":["client/src/components/bible/NewColumnHeaders.tsx"],"query_or_table_refs":[],"notes":"Specialized responsive system for mobile portrait orientation"}
{"file":"client/src/hooks/useMeasureVisibleColumns.ts","lines":"4-67","symbol":"useMeasureVisibleColumns","kind":"react_hook","export":"named","signature":"(containerEl: HTMLElement | null): void","governs":{"ui":"none","state":"calculates and updates visible column count based on container width","data":"none","routing":"none","side_effects":"ResizeObserver for container width monitoring, store updates","auth":"none","errors":"none","dependencies":["react","zustand"]},"calls":["useBibleStore","ResizeObserver","setVisibleCount","setContainerWidthPx"],"called_by":["VirtualBibleTable","column layout system"],"related_files":["client/src/components/bible/VirtualBibleTable.tsx"],"query_or_table_refs":[],"notes":"Dynamic column visibility calculator for responsive layout system"}
{"file":"client/src/hooks/useColumnChangeSignal.ts","lines":"1-150","symbol":"ColumnChangeSignal","kind":"class","export":"internal","signature":"class ColumnChangeSignal extends EventTarget","governs":{"ui":"none","state":"manages column change event system for cross-component communication","data":"none","routing":"none","side_effects":"custom event emission and listening","auth":"none","errors":"none","dependencies":["EventTarget API"]},"calls":["dispatchEvent","addEventListener","removeEventListener"],"called_by":["useColumnChangeEmitter","useColumnChangeSignal"],"related_files":["client/src/hooks/useReferenceColumnWidth.ts"],"query_or_table_refs":[],"notes":"Event system for coordinating column width and visibility changes across components"}
{"file":"client/src/hooks/useColumnData.ts","lines":"6-38","symbol":"useColumnData","kind":"react_hook","export":"named","signature":"(): {loadProphecyData: () => Promise<void>}","governs":{"ui":"none","state":"triggers data loading when columns are toggled","data":"loads prophecy data when prophecy columns are enabled","routing":"none","side_effects":"data loading via dynamic imports","auth":"none","errors":"logs data loading failures","dependencies":["react","zustand"]},"calls":["useBibleStore","import('@/lib/prophecyCache')"],"called_by":["VirtualBibleTable","column toggle system"],"related_files":["client/src/lib/prophecyCache.ts"],"query_or_table_refs":[],"notes":"Data loading coordinator for column-specific features"}
{"file":"client/src/utils/scrollNav.ts","lines":"31-95","symbol":"makeColumnScroller","kind":"function","export":"named","signature":"({headerEl, bodyEl, navigableKeys}: ScrollNavOpts): ScrollerInstance","governs":{"ui":"manages horizontal column navigation and synchronized scrolling","state":"none","data":"none","routing":"none","side_effects":"DOM scroll synchronization, smooth scroll behavior","auth":"none","errors":"none","dependencies":["DOM APIs"]},"calls":["addEventListener","scrollTo","getStickyLeftPx","measureLefts"],"called_by":["ColumnNavigationArrows"],"related_files":["client/src/components/bible/ColumnNavigationArrows.tsx"],"query_or_table_refs":[],"notes":"Advanced column navigation system with header/body scroll synchronization"}
{"file":"client/src/utils/columnLayout.ts","lines":"30-91","symbol":"computeVisibleRangeDynamic","kind":"function","export":"named","signature":"(p: LayoutParams): LayoutResult","governs":{"ui":"calculates which columns are visible in current viewport","state":"none","data":"none","routing":"none","side_effects":"none","auth":"none","errors":"none","dependencies":["none"]},"calls":[],"called_by":["column navigation system","visibility calculations"],"related_files":["client/src/utils/scrollNav.ts"],"query_or_table_refs":[],"notes":"Core algorithm for dynamic column visibility calculation"}
{"file":"client/src/contexts/AuthContext.tsx","lines":"1-100","symbol":"AuthProvider","kind":"component","export":"named","signature":"({children}: {children: React.ReactNode}) => JSX.Element","governs":{"ui":"provides authentication UI state and user profile data","state":"manages user authentication state, profile data, session management","data":"loads user profile from Supabase","routing":"none","side_effects":"Supabase auth state monitoring, profile data loading","auth":"core authentication provider for entire app","errors":"handles auth errors and loading states","dependencies":["react","@supabase/supabase-js"]},"calls":["supabase.auth.onAuthStateChange","supabase.from('profiles').select()"],"called_by":["App"],"related_files":["client/src/lib/supabaseClient.ts","shared/schema.ts"],"query_or_table_refs":["profiles"],"notes":"Core authentication context providing user state throughout the application"}
{"file":"client/src/contexts/HighlightContext.tsx","lines":"1-80","symbol":"HighlightProvider","kind":"component","export":"named","signature":"({children}: {children: React.ReactNode}) => JSX.Element","governs":{"ui":"manages text highlighting interface and color selection","state":"manages highlight state, color palettes, selection ranges","data":"handles highlight data persistence via useHighlights hook","routing":"none","side_effects":"text selection detection, highlight rendering","auth":"requires authentication for highlight persistence","errors":"handles highlight save/load errors","dependencies":["react","@/hooks/useHighlights"]},"calls":["useHighlights","useState","useEffect"],"called_by":["App"],"related_files":["client/src/hooks/useHighlights.ts","shared/schema.ts"],"query_or_table_refs":["user_highlights"],"notes":"Context provider for Bible verse text highlighting functionality"}
{"file":"client/src/hooks/useAuth.ts","lines":"1-50","symbol":"useAuth","kind":"react_hook","export":"named","signature":"(): AuthHookReturn","governs":{"ui":"provides auth UI state (loading, user data)","state":"manages authentication state and user profile","data":"none directly - uses AuthContext","routing":"none","side_effects":"none","auth":"core auth hook for components","errors":"none","dependencies":["react","@/contexts/AuthContext"]},"calls":["useContext"],"called_by":["TopHeader","UserProfile","AuthModals","protected components"],"related_files":["client/src/contexts/AuthContext.tsx"],"query_or_table_refs":[],"notes":"Hook for accessing authentication state and user data"}
{"file":"client/src/hooks/useNotes.ts","lines":"1-100","symbol":"useNotes","kind":"react_hook","export":"named","signature":"(): NotesHookReturn","governs":{"ui":"manages notes UI state and interactions","state":"manages verse notes state with optimistic updates","data":"CRUD operations for verse notes via API","routing":"none","side_effects":"auto-save functionality, local state synchronization","auth":"requires user authentication","errors":"handles save/load failures with rollback","dependencies":["react","@tanstack/react-query","@/lib/queryClient"]},"calls":["useQuery","useMutation","queryClient.setQueryData"],"called_by":["NotesCell","note management components"],"related_files":["client/src/components/user/NotesCell.tsx","shared/schema.ts"],"query_or_table_refs":["notes"],"notes":"Notes management with optimistic updates and auto-save"}
{"file":"client/src/hooks/useBookmarks.ts","lines":"1-80","symbol":"useBookmarks","kind":"react_hook","export":"named","signature":"(): BookmarksHookReturn","governs":{"ui":"manages bookmark UI state and list rendering","state":"manages user bookmarks with real-time updates","data":"CRUD operations for bookmarks via API","routing":"none","side_effects":"bookmark synchronization with server","auth":"requires user authentication","errors":"handles bookmark save/delete failures","dependencies":["react","@tanstack/react-query","@/lib/queryClient"]},"calls":["useQuery","useMutation","queryClient.invalidateQueries"],"called_by":["BookmarkButton","BookmarksList"],"related_files":["client/src/components/user/BookmarkButton.tsx","shared/schema.ts"],"query_or_table_refs":["user_bookmarks"],"notes":"Bookmark management with real-time synchronization"}
{"file":"client/src/hooks/useHighlights.ts","lines":"1-120","symbol":"useHighlights","kind":"react_hook","export":"named","signature":"(): HighlightsHookReturn","governs":{"ui":"manages verse text highlighting UI and color selection","state":"manages highlight segments with conflict resolution","data":"CRUD operations for highlights with server synchronization","routing":"none","side_effects":"real-time highlight rendering, server_rev conflict resolution","auth":"requires user authentication","errors":"handles highlight save failures with conflict resolution","dependencies":["react","@tanstack/react-query","@/lib/queryClient"]},"calls":["useQuery","useMutation","queryClient.setQueryData"],"called_by":["HighlightableText","HighlightContext"],"related_files":["client/src/contexts/HighlightContext.tsx","shared/schema.ts"],"query_or_table_refs":["user_highlights"],"notes":"Advanced highlighting system with conflict resolution and real-time updates"}
{"file":"client/src/workers/crossReferencesWorker.ts","lines":"1-50","symbol":"crossReferencesWorker","kind":"function","export":"internal","signature":"Web Worker message handler","governs":{"ui":"none","state":"none","data":"processes cross-reference data in background thread","routing":"none","side_effects":"heavy data processing without blocking UI","auth":"none","errors":"posts error messages to main thread","dependencies":["Web Worker API"]},"calls":["postMessage","importScripts"],"called_by":["useCrossRefLoader"],"related_files":["client/src/hooks/useCrossRefLoader.ts"],"query_or_table_refs":[],"notes":"Background worker for processing large cross-reference datasets"}
{"file":"client/src/workers/labelsWorker.ts","lines":"1-60","symbol":"labelsWorker","kind":"function","export":"internal","signature":"Web Worker message handler","governs":{"ui":"none","state":"none","data":"processes semantic label data for verse highlighting","routing":"none","side_effects":"heavy label processing without blocking UI","auth":"none","errors":"posts error messages to main thread","dependencies":["Web Worker API"]},"calls":["postMessage"],"called_by":["useDynamicLabels"],"related_files":["client/src/hooks/useDynamicLabels.ts"],"query_or_table_refs":[],"notes":"Background worker for semantic label processing and highlighting"}
{"file":"client/src/main.tsx","lines":"1-14","symbol":"main","kind":"entry_point","export":"none","signature":"module execution","governs":{"ui":"bootstraps React root and renders App component","state":"none","data":"none","routing":"none","side_effects":"DOM mounting, CSS imports, service worker dev guard","auth":"none","errors":"none","dependencies":["react-dom/client","./App","./index.css"]},"calls":["createRoot","render"],"called_by":["Vite/browser"],"related_files":["client/src/App.tsx","client/src/index.css","client/src/styles/column-headers-scrollbar-fix.css"],"query_or_table_refs":[],"notes":"Application entry point that mounts React app to DOM root"}
{"file":"client/src/pages/bible.tsx","lines":"28-467","symbol":"BiblePage","kind":"component","export":"default","signature":"() => JSX.Element","governs":{"ui":"orchestrates complete Bible reading interface: table, overlays, modals, navigation","state":"manages verse selection, prophecy drawers, search modal, menu state, welcome flow","data":"coordinates Bible verse loading, translation management, verse navigation","routing":"handles URL hash parameters for verse navigation","side_effects":"localStorage management, event listeners for navigation/scrolling, adaptive loading","auth":"integrates with user authentication for personalized features","errors":"handles verse navigation failures with fallback search","dependencies":["react","@/hooks/useBibleData","@/hooks/useVerseNav","@/components/bible/VirtualBibleTable"]},"calls":["useBibleStore","useAuth","useBibleData","useVerseNav","useTranslationMaps","useReadingState","useHashParams","useBodyClass","useAdaptiveScaling","useLoadingDetection","VirtualBibleTable","TopHeader","StrongsOverlay","ProphecyDetailDrawer","SearchModal","HamburgerMenu","Welcome","IntroOverlay","Footer"],"called_by":["App (via routing)"],"related_files":["client/src/hooks/useBibleData.ts","client/src/hooks/useVerseNav.ts","client/src/components/bible/VirtualBibleTable.tsx"],"query_or_table_refs":[],"notes":"Main Bible reading page coordinating all Bible study features and user interface"}
{"file":"client/src/hooks/useBibleData.ts","lines":"631-1519","symbol":"useBibleData","kind":"react_hook","export":"named","signature":"(): BibleDataReturn","governs":{"ui":"none directly","state":"manages complete Bible data state: 31k+ verses, translations, loading progress","data":"loads Bible structure from Supabase, coordinates dynamic text loading, translation management","routing":"handles chronological vs canonical verse ordering","side_effects":"dynamic verse text loading around scroll position, translation caching","auth":"none directly","errors":"handles Bible data loading failures with fallbacks","dependencies":["react","@tanstack/react-query","@/data/BibleDataAPI","@/lib/translationLoader"]},"calls":["loadFullBibleIndex","loadKJVTextMap","createFullBibleIndexWithoutText","loadAdditionalData","parseActualSupabaseKJV","loadProphecyDataOnDemand","useState","useEffect","useQuery"],"called_by":["BiblePage"],"related_files":["client/src/data/BibleDataAPI.ts","client/src/lib/translationLoader.ts","client/src/lib/supabaseClient.ts"],"query_or_table_refs":["supabase.storage.anointed"],"notes":"Master Bible data management hook handling 31,102 verses with dynamic loading and translation coordination"}
{"file":"client/src/hooks/useBibleData.ts","lines":"20-36","symbol":"loadKJVTextMap","kind":"function","export":"internal","signature":"(): Promise<void>","governs":{"ui":"none","state":"loads and caches global KJV text map","data":"loads KJV translation from BibleDataAPI into global cache","routing":"none","side_effects":"populates globalKjvTextMap variable, console logging","auth":"none","errors":"sets empty Map on failure","dependencies":["@/data/BibleDataAPI"]},"calls":["loadTranslation"],"called_by":["loadFullBibleIndex","createFullBibleWithHeights"],"related_files":["client/src/data/BibleDataAPI.ts"],"query_or_table_refs":[],"notes":"Optimized KJV text loader for instant verse access"}
{"file":"client/src/hooks/useBibleData.ts","lines":"39-91","symbol":"loadFullBibleIndex","kind":"function","export":"internal","signature":"(progressCallback?: Function, isChronological?: boolean): Promise<BibleVerse[]>","governs":{"ui":"none","state":"none","data":"loads complete Bible index (31k+ verses) with empty text placeholders","routing":"none","side_effects":"progress callbacks, dynamic KJV loading","auth":"none","errors":"throws on Supabase loading failure","dependencies":["@/data/BibleDataAPI"]},"calls":["loadVerseKeys","loadKJVTextMap","createFullBibleIndexWithoutText"],"called_by":["useBibleData"],"related_files":["client/src/data/BibleDataAPI.ts"],"query_or_table_refs":[],"notes":"Creates foundation Bible structure for virtual scrolling without preloading all text"}
{"file":"client/src/hooks/useVerseNav.ts","lines":"9-168","symbol":"useVerseNav","kind":"react_hook","export":"named","signature":"(scrollToVerse: ScrollToFn): VerseNavReturn","governs":{"ui":"none directly","state":"manages navigation history (mobile internal stack vs desktop browser history)","data":"none","routing":"coordinates verse navigation with browser/internal history","side_effects":"browser history manipulation, navigation event emissions, localStorage","auth":"none","errors":"none","dependencies":["react","@/lib/verseKeysLoader","@/hooks/useMobileDetection"]},"calls":["useMobileDetection","useState","useEffect","window.history.pushState","window.history.back","window.history.forward","window.dispatchEvent"],"called_by":["BiblePage"],"related_files":["client/src/lib/verseKeysLoader.ts","client/src/hooks/useMobileDetection.ts"],"query_or_table_refs":[],"notes":"Intelligent navigation system with mobile-optimized internal history and desktop browser history integration"}
{"file":"client/src/components/bible/TopHeader.tsx","lines":"31-409","symbol":"TopHeader","kind":"component","export":"named","signature":"(props: TopHeaderProps): JSX.Element","governs":{"ui":"renders top navigation header with search, bookmarks, auth, navigation controls","state":"manages auth modals, bookmark modal, responsive layout","data":"none directly","routing":"none","side_effects":"search modal triggers, bookmark creation via Supabase","auth":"integrates authentication UI and bookmark saving","errors":"handles bookmark save failures with toasts","dependencies":["react","@/components/ui/*","@/contexts/AuthContext","@tanstack/react-query"]},"calls":["useTheme","useAuth","useState","useWindowSize","useBibleStore","useMutation","useQueryClient","useToast","useAdaptiveScaling","Button","Select","UserProfileDropdown","AuthModals","BookmarkModal"],"called_by":["BiblePage"],"related_files":["client/src/contexts/AuthContext.tsx","client/src/lib/supabaseClient.ts"],"query_or_table_refs":["bookmarks"],"notes":"Responsive header component with integrated authentication and bookmark management"}
{"file":"client/src/lib/supabaseClient.ts","lines":"18-25","symbol":"supabase","kind":"singleton","export":"named","signature":"ReturnType<typeof createClient>","governs":{"ui":"none","state":"none","data":"provides singleton Supabase client for all database/storage operations","routing":"none","side_effects":"globalThis attachment to prevent multiple GoTrue warnings","auth":"provides authentication methods and session management","errors":"throws on missing environment variables","dependencies":["@supabase/supabase-js"]},"calls":["createClient"],"called_by":["all components using Supabase"],"related_files":["client/src/contexts/AuthContext.tsx"],"query_or_table_refs":["supabase.storage.anointed","supabase.auth"],"notes":"Singleton Supabase client preventing multiple GoTrue warnings"}
{"file":"client/src/lib/supabaseClient.ts","lines":"34-82","symbol":"LRUCache","kind":"class","export":"internal","signature":"class with get/set/has methods","governs":{"ui":"none","state":"manages LRU eviction for translation cache","data":"optimizes memory usage with 12-translation limit","routing":"none","side_effects":"automatic cache eviction, console logging","auth":"none","errors":"none","dependencies":["none"]},"calls":[],"called_by":["masterCache"],"related_files":[],"query_or_table_refs":[],"notes":"Memory-optimized LRU cache with 12 translation limit per PR-B requirement"}
{"file":"client/src/lib/supabaseClient.ts","lines":"84","symbol":"masterCache","kind":"singleton","export":"named","signature":"LRUCache","governs":{"ui":"none","state":"global translation cache with LRU eviction","data":"caches Bible translations to prevent repeated downloads","routing":"none","side_effects":"automatic cache management","auth":"none","errors":"none","dependencies":["LRUCache"]},"calls":["LRUCache"],"called_by":["loadTranslationSecure","preloader"],"related_files":["client/src/lib/preloader.ts"],"query_or_table_refs":[],"notes":"Single master cache instance for all Bible translation data"}
{"file":"client/src/lib/supabaseClient.ts","lines":"90-116","symbol":"loadVerseKeys","kind":"function","export":"named","signature":"(): Promise<string[]>","governs":{"ui":"none","state":"caches verse keys globally","data":"loads master verse index from Supabase storage","routing":"none","side_effects":"verse keys caching, console logging","auth":"requires Supabase authentication","errors":"throws on Supabase download failure","dependencies":["supabase"]},"calls":["supabase.storage.from.download"],"called_by":["verseKeysLoader","useBibleData"],"related_files":["client/src/lib/verseKeysLoader.ts"],"query_or_table_refs":["supabase.storage.anointed.metadata/verseKeys-canonical.json"],"notes":"Loads 31k+ verse keys as foundation for Bible structure"}
{"file":"client/src/lib/supabaseClient.ts","lines":"119-167","symbol":"loadTranslationSecure","kind":"function","export":"named","signature":"(translationId: string): Promise<Map<string, string>>","governs":{"ui":"none","state":"none","data":"loads Bible translations from Supabase with caching","routing":"none","side_effects":"master cache updates, console logging","auth":"requires Supabase authentication","errors":"throws on network/parsing failures","dependencies":["supabase","masterCache"]},"calls":["supabase.storage.from.createSignedUrl","fetch","masterCache.get","masterCache.set"],"called_by":["BibleDataAPI","preloader"],"related_files":["client/src/data/BibleDataAPI.ts","client/src/lib/preloader.ts"],"query_or_table_refs":["supabase.storage.anointed.translations/*.txt"],"notes":"Secure translation loading with signed URLs and master cache integration"}
{"file":"client/src/lib/supabaseClient.ts","lines":"170-211","symbol":"auth_helpers","kind":"function_group","export":"named","signature":"various auth functions","governs":{"ui":"none","state":"none","data":"none","routing":"none","side_effects":"browser history, session management","auth":"provides complete authentication interface","errors":"returns auth errors","dependencies":["supabase"]},"calls":["supabase.auth.signInWithOtp","supabase.auth.signOut","supabase.auth.getUser","supabase.auth.getSession","supabase.auth.onAuthStateChange"],"called_by":["AuthContext","TopHeader"],"related_files":["client/src/contexts/AuthContext.tsx"],"query_or_table_refs":[],"notes":"Complete authentication helper functions for magic link and session management"}
{"file":"client/src/lib/preloader.ts","lines":"7-25","symbol":"preloadKJV","kind":"function","export":"named","signature":"(): Promise<Map<string, string>>","governs":{"ui":"none","state":"none","data":"aggressively loads KJV for instant display","routing":"none","side_effects":"module-level KJV loading, console logging","auth":"none directly","errors":"returns empty Map on failure","dependencies":["@/data/BibleDataAPI"]},"calls":["loadTranslation"],"called_by":["module initialization","isKJVReady","getKJVTextInstant"],"related_files":["client/src/data/BibleDataAPI.ts"],"query_or_table_refs":[],"notes":"Aggressive KJV preloader for instant verse display without waiting"}
{"file":"client/src/lib/preloader.ts","lines":"28-30","symbol":"isKJVReady","kind":"function","export":"named","signature":"(): boolean","governs":{"ui":"none","state":"none","data":"checks if KJV is ready for instant access","routing":"none","side_effects":"none","auth":"none","errors":"none","dependencies":["masterCache"]},"calls":["masterCache.has"],"called_by":["components needing instant KJV access"],"related_files":["client/src/lib/supabaseClient.ts"],"query_or_table_refs":[],"notes":"Instant readiness check for KJV text without async operations"}
{"file":"client/src/lib/preloader.ts","lines":"33-36","symbol":"getKJVTextInstant","kind":"function","export":"named","signature":"(verseId: string): string","governs":{"ui":"none","state":"none","data":"provides instant KJV text access","routing":"none","side_effects":"none","auth":"none","errors":"returns empty string on failure","dependencies":["masterCache"]},"calls":["masterCache.get"],"called_by":["components needing instant KJV display"],"related_files":["client/src/lib/supabaseClient.ts"],"query_or_table_refs":[],"notes":"Instant KJV text getter without async operations or loading delays"}
{"file":"client/src/hooks/useMobileDetection.ts","lines":"3-30","symbol":"useMobileDetection","kind":"react_hook","export":"named","signature":"(): boolean","governs":{"ui":"none directly","state":"tracks mobile device status with window resize","data":"none","routing":"none","side_effects":"window resize event listeners","auth":"none","errors":"none","dependencies":["react"]},"calls":["useState","useEffect","window.addEventListener","window.removeEventListener"],"called_by":["useVerseNav","VirtualBibleTable","mobile-responsive components"],"related_files":["client/src/hooks/useVerseNav.ts"],"query_or_table_refs":[],"notes":"Intelligent mobile detection combining user agent, touch capability, and screen size"}
{"file":"client/src/lib/verseKeysLoader.ts","lines":"19-124","symbol":"loadVerseKeysCanonical","kind":"function","export":"named","signature":"(): Promise<string[]>","governs":{"ui":"none","state":"caches canonical verse keys globally","data":"loads master 31k+ verse index in canonical order","routing":"none","side_effects":"global cache updates, console logging","auth":"none directly","errors":"falls back to hardcoded Bible structure","dependencies":["@/data/BibleDataAPI"]},"calls":["loadVerseKeys"],"called_by":["useBibleData","verseKeysLoader system"],"related_files":["client/src/data/BibleDataAPI.ts"],"query_or_table_refs":[],"notes":"Foundation loader for master verse index with complete 66-book fallback"}
{"file":"client/src/lib/verseKeysLoader.ts","lines":"130-154","symbol":"createVerseObjectsFromKeys","kind":"function","export":"named","signature":"(verseKeys: string[]): BibleVerse[]","governs":{"ui":"none","state":"none","data":"creates skeleton Bible verse objects from master key index","routing":"none","side_effects":"console logging","auth":"none","errors":"none","dependencies":["@/types/bible"]},"calls":[],"called_by":["useBibleData"],"related_files":["client/src/types/bible.ts"],"query_or_table_refs":[],"notes":"Creates 31k+ verse objects as foundation structure for all other data"}
{"file":"client/src/lib/verseKeysLoader.ts","lines":"167-284","symbol":"getVerseKeys","kind":"function","export":"named","signature":"(): string[]","governs":{"ui":"none","state":"none","data":"provides current verse keys with fallback generation","routing":"none","side_effects":"synchronous verse key generation if needed","auth":"none","errors":"none","dependencies":["useBibleStore (optional)"]},"calls":["useBibleStore.getState (optional)"],"called_by":["VirtualBibleTable","navigation components"],"related_files":["client/src/stores/useBibleStore.ts"],"query_or_table_refs":[],"notes":"Critical function providing verse keys for virtual scrolling with immediate fallback"}
{"file":"client/src/lib/verseKeysLoader.ts","lines":"298-322","symbol":"loadVerseKeysChronological","kind":"function","export":"named","signature":"(): Promise<string[]>","governs":{"ui":"none","state":"caches chronological verse keys globally","data":"loads master verse index in chronological order","routing":"none","side_effects":"global cache updates, console logging","auth":"none directly","errors":"falls back to canonical order","dependencies":["@/data/BibleDataAPI"]},"calls":["loadVerseKeys","loadVerseKeysCanonical"],"called_by":["useBibleData (chronological mode)"],"related_files":["client/src/data/BibleDataAPI.ts"],"query_or_table_refs":[],"notes":"Chronological verse ordering system with canonical fallback"}
{"file":"client/src/data/BibleDataAPI.ts","lines":"6-22","symbol":"paths","kind":"constant","export":"internal","signature":"Record<string, string | Function>","governs":{"ui":"none","state":"none","data":"defines canonical bucket paths for all Bible data sources","routing":"none","side_effects":"none","auth":"none","errors":"none","dependencies":["none"]},"calls":[],"called_by":["all data loading functions"],"related_files":[],"query_or_table_refs":["supabase.storage.anointed.*"],"notes":"Single source of truth for all Supabase storage paths including translations, references, metadata"}
{"file":"client/src/data/BibleDataAPI.ts","lines":"24-32","symbol":"fetchFromStorage","kind":"function","export":"named","signature":"(path: string): Promise<string>","governs":{"ui":"none","state":"none","data":"core Supabase storage download function","routing":"none","side_effects":"network requests, console logging","auth":"requires Supabase authentication","errors":"throws on download failure","dependencies":["supabase"]},"calls":["supabase.storage.from.download"],"called_by":["all data loading functions"],"related_files":["client/src/lib/supabaseClient.ts"],"query_or_table_refs":["supabase.storage.anointed"],"notes":"Foundation function for all Supabase storage operations with error handling"}
{"file":"client/src/data/BibleDataAPI.ts","lines":"70-79","symbol":"getOrFetch","kind":"function","export":"internal","signature":"<T>(key: string, fetchFn: () => Promise<T>): Promise<T>","governs":{"ui":"none","state":"none","data":"provides caching layer for all data operations","routing":"none","side_effects":"master cache updates","auth":"none directly","errors":"none","dependencies":["masterCache"]},"calls":["masterCache.has","masterCache.get","masterCache.set"],"called_by":["all caching data functions"],"related_files":["client/src/lib/supabaseClient.ts"],"query_or_table_refs":[],"notes":"Central caching mechanism preventing redundant Supabase requests"}
{"file":"client/src/data/BibleDataAPI.ts","lines":"81-113","symbol":"loadTranslation","kind":"function","export":"named","signature":"(id: string): Promise<Map<string, string>>","governs":{"ui":"none","state":"none","data":"loads Bible translations with optimized parsing and caching","routing":"none","side_effects":"master cache updates, console logging","auth":"requires Supabase authentication","errors":"throws on download/parsing failure","dependencies":["fetchFromStorage","masterCache"]},"calls":["fetchFromStorage","masterCache.has","masterCache.get","masterCache.set"],"called_by":["preloader","useBibleData","searchVerses"],"related_files":["client/src/lib/preloader.ts","client/src/hooks/useBibleData.ts"],"query_or_table_refs":["supabase.storage.anointed.translations/*.txt"],"notes":"Core translation loader with regex-optimized parsing for 31k+ verses"}
{"file":"client/src/data/BibleDataAPI.ts","lines":"121-153","symbol":"loadVerseKeys","kind":"function","export":"named","signature":"(chronological: boolean): Promise<string[]>","governs":{"ui":"none","state":"none","data":"loads master verse index from Supabase with chronological support","routing":"none","side_effects":"console logging","auth":"requires Supabase authentication","errors":"falls back to canonical on chronological failure","dependencies":["getOrFetch","fetchFromStorage"]},"calls":["getOrFetch","fetchFromStorage","JSON.parse"],"called_by":["verseKeysLoader","useBibleData"],"related_files":["client/src/lib/verseKeysLoader.ts"],"query_or_table_refs":["supabase.storage.anointed.metadata/verseKeys-*.json"],"notes":"Foundation loader providing 31k+ verse keys with chronological/canonical ordering"}
{"file":"client/src/data/BibleDataAPI.ts","lines":"256-295","symbol":"searchVerses","kind":"function","export":"named","signature":"(query: string, translationId: string): Promise<SearchResult[]>","governs":{"ui":"none","state":"none","data":"provides global Bible verse search with special % random feature","routing":"none","side_effects":"none","auth":"none directly","errors":"none","dependencies":["loadTranslation","loadVerseKeys"]},"calls":["loadTranslation","loadVerseKeys"],"called_by":["search components"],"related_files":[],"query_or_table_refs":[],"notes":"Global search system with 100-result limit and special % random verse feature"}
{"file":"client/src/data/BibleDataAPI.ts","lines":"367-437","symbol":"getCrossRefsBatch","kind":"function","export":"named","signature":"(verseIds: string[], cfSet: 'cf1' | 'cf2'): Promise<Record<string, string[]>>","governs":{"ui":"none","state":"none","data":"ultra-fast cross-reference loading using HTTP Range requests","routing":"none","side_effects":"console logging","auth":"requires Supabase authentication","errors":"returns empty object on failure","dependencies":["getCfOffsets","fetchSlice"]},"calls":["getCfOffsets","fetchSlice","Promise.all"],"called_by":["cross-reference components"],"related_files":[],"query_or_table_refs":["supabase.storage.anointed.references/*.txt"],"notes":"Expert implementation using HTTP 206 Partial Content for optimized cross-reference batch loading"}
{"file":"client/src/data/BibleDataAPI.ts","lines":"200-225","symbol":"prophecy_loaders","kind":"function_group","export":"named","signature":"various prophecy functions","governs":{"ui":"none","state":"none","data":"loads prophecy data from JSON and text files","routing":"none","side_effects":"console logging, caching","auth":"requires Supabase authentication","errors":"throws on load failure","dependencies":["getOrFetch","fetchFromStorage"]},"calls":["getOrFetch","fetchFromStorage","JSON.parse"],"called_by":["prophecy components"],"related_files":[],"query_or_table_refs":["supabase.storage.anointed.references/prophecy_*"],"notes":"Prophecy data loading system with rows and index files"}
{"file":"client/src/store/translationSlice.ts","lines":"27-92","symbol":"useTranslationMaps","kind":"zustand_store","export":"named","signature":"() => TranslationState & Actions","governs":{"ui":"none directly","state":"manages main/alternate translation state with persistence","data":"none directly","routing":"none","side_effects":"localStorage persistence, custom events for slot visibility","auth":"none","errors":"none","dependencies":["zustand/middleware/persist"]},"calls":["create","persist","window.dispatchEvent"],"called_by":["Bible components","TopHeader"],"related_files":["client/src/components/bible/*"],"query_or_table_refs":[],"notes":"Central translation state store with alternate translation management and mobile reset capabilities"}
{"file":"client/src/contexts/AuthContext.tsx","lines":"19-113","symbol":"AuthProvider","kind":"component","export":"named","signature":"({ children }): JSX.Element","governs":{"ui":"none directly","state":"manages complete authentication state and profile data","data":"none directly","routing":"none","side_effects":"URL parameter cleanup, custom events, cross-domain cookies","auth":"provides complete authentication interface for entire app","errors":"handles auth state changes","dependencies":["react","@/lib/supabaseClient","@/hooks/useMyProfile"]},"calls":["useState","useEffect","supabase.auth.getSession","supabase.auth.onAuthStateChange","useMyProfile","window.dispatchEvent"],"called_by":["App (root provider)"],"related_files":["client/src/hooks/useMyProfile.ts","client/src/lib/supabaseClient.ts"],"query_or_table_refs":[],"notes":"Root authentication provider with magic link handling, cross-domain cookie sharing, and profile integration"}
{"file":"client/src/contexts/AuthContext.tsx","lines":"16-17","symbol":"useAuth","kind":"react_hook","export":"named","signature":"(): AuthCtx","governs":{"ui":"none","state":"none","data":"provides authentication context access","routing":"none","side_effects":"none","auth":"provides user, session, profile data and auth functions","errors":"none","dependencies":["react"]},"calls":["useContext"],"called_by":["all components needing auth"],"related_files":[],"query_or_table_refs":[],"notes":"Authentication context hook providing user, session, profile, and auth functions throughout the app"}
{"file":"client/src/components/bible/VirtualBibleTable.tsx","lines":"64-919","symbol":"VirtualBibleTable","kind":"component","export":"default","signature":"forwardRef<VirtualBibleTableHandle, VirtualBibleTableProps>","governs":{"ui":"renders complete virtual scrolling Bible table with 20-column system","state":"manages scrollbar dragging, tooltip visibility, anchor-based navigation","data":"coordinates verse loading, translation maps, cross-references, notes, labels","routing":"none directly","side_effects":"scroll event handling, custom events, performance optimization","auth":"integrates user authentication for notes and bookmarks","errors":"handles verse loading failures and navigation errors","dependencies":["react","@tanstack/react-query","20+ custom hooks"]},"calls":["useAuth","useToast","useNotesCache","useBibleData","useTranslationMaps","useAnchorSlice","useRowData","useViewportLabels","useBibleStore","useVerseNav","NewColumnHeaders","VirtualRow","ScrollbarTooltip"],"called_by":["BiblePage"],"related_files":["client/src/hooks/useAnchorSlice.ts","client/src/hooks/useRowData.ts","client/src/components/bible/VirtualRow.tsx"],"query_or_table_refs":[],"notes":"Core 919-line Bible table component orchestrating virtual scrolling, anchor-centered navigation, and 20-column responsive layout"}
{"file":"client/src/components/bible/VirtualBibleTable.tsx","lines":"115-117","symbol":"useAnchorSlice","kind":"hook_call","export":"internal","signature":"(containerRef, verseKeys, options): { anchorIndex, slice }","governs":{"ui":"none directly","state":"manages anchor-centered virtual scrolling","data":"provides current verse slice for rendering","routing":"none","side_effects":"scroll position tracking, performance pausing during drag","auth":"none","errors":"none","dependencies":["useAnchorSlice hook"]},"calls":["useAnchorSlice"],"called_by":["VirtualBibleTable"],"related_files":["client/src/hooks/useAnchorSlice.ts"],"query_or_table_refs":[],"notes":"Anchor-centered virtual scrolling with performance optimization during scrollbar dragging"}
{"file":"client/src/components/bible/VirtualBibleTable.tsx","lines":"131-134","symbol":"getCurrentVerse","kind":"function","export":"internal","signature":"(): { reference: string, index: number }","governs":{"ui":"none","state":"none","data":"provides current verse reference and index","routing":"none","side_effects":"none","auth":"none","errors":"falls back to Gen.1:1","dependencies":["anchorIndex","verseKeys"]},"calls":[],"called_by":["useEffect","onCurrentVerseChange"],"related_files":[],"query_or_table_refs":[],"notes":"Current verse getter with fallback to Genesis 1:1 for navigation"}
{"file":"client/src/hooks/useMyProfile.ts","lines":"15-85","symbol":"useMyProfile","kind":"react_hook","export":"named","signature":"(user: User | null, authLoading: boolean): ProfileHookReturn","governs":{"ui":"none directly","state":"manages user profile state with loading/error states","data":"CRUD operations for user profiles","routing":"none","side_effects":"Supabase profile queries, console logging","auth":"requires authenticated user for profile operations","errors":"handles profile loading and update errors","dependencies":["react","@supabase/supabase-js","@/lib/supabaseClient"]},"calls":["useState","useEffect","supabase.from.select","supabase.from.update"],"called_by":["AuthProvider"],"related_files":["client/src/contexts/AuthContext.tsx","client/src/lib/supabaseClient.ts"],"query_or_table_refs":["profiles"],"notes":"Profile management hook with tier system (free/premium/lifetime) and dev code upgrade functionality"}
{"file":"client/src/hooks/useMyProfile.ts","lines":"51-59","symbol":"save","kind":"function","export":"internal","signature":"(update: Partial<ProfileData>): Promise<void>","governs":{"ui":"none","state":"updates local profile state","data":"saves profile updates to Supabase","routing":"none","side_effects":"database updates, local state sync","auth":"requires authenticated user","errors":"throws on save failure","dependencies":["supabase"]},"calls":["supabase.from.update","setProfile"],"called_by":["AuthProvider","profile components"],"related_files":[],"query_or_table_refs":["profiles"],"notes":"Profile save helper with local state synchronization"}
{"file":"client/src/hooks/useMyProfile.ts","lines":"62-82","symbol":"upgradeToPremium","kind":"function","export":"internal","signature":"(code?: string): Promise<{ ok: boolean, msg: string }>","governs":{"ui":"none","state":"updates user tier to premium","data":"updates profile tier in database","routing":"none","side_effects":"database updates, local state sync","auth":"requires authenticated user","errors":"returns error messages for invalid codes","dependencies":["supabase"]},"calls":["supabase.from.update","setProfile"],"called_by":["AuthProvider","upgrade components"],"related_files":[],"query_or_table_refs":["profiles"],"notes":"Premium upgrade function with DEV-ALPHA-2025 code validation"}
{"file":"client/src/hooks/useAnchorSlice.ts","lines":"7-17","symbol":"getOptimalBuffer","kind":"function","export":"internal","signature":"(): number","governs":{"ui":"none","state":"none","data":"calculates optimal buffer size based on device capabilities","routing":"none","side_effects":"none","auth":"none","errors":"none","dependencies":["navigator","window"]},"calls":[],"called_by":["loadChunk"],"related_files":[],"query_or_table_refs":[],"notes":"Smart mobile optimization: 40 verses mobile/low-memory, 100 verses desktop for crash prevention"}
{"file":"client/src/hooks/useAnchorSlice.ts","lines":"20-48","symbol":"loadChunk","kind":"function","export":"internal","signature":"(anchorIndex: number, verseKeys: string[], buffer?: number): ChunkResult","governs":{"ui":"none","state":"none","data":"loads verse chunk around anchor with device-aware buffer","routing":"none","side_effects":"memory monitoring, console logging","auth":"none","errors":"handles empty verse keys","dependencies":["getOptimalBuffer","getVerseKeys"]},"calls":["getOptimalBuffer","getVerseKeys"],"called_by":["useAnchorSlice"],"related_files":["client/src/lib/verseKeysLoader.ts"],"query_or_table_refs":[],"notes":"Core chunk loading with memory pressure monitoring and preemptive loading for scroll performance"}
{"file":"client/src/hooks/useAnchorSlice.ts","lines":"51-59","symbol":"getOptimalThreshold","kind":"function","export":"internal","signature":"(): number","governs":{"ui":"none","state":"none","data":"calculates optimal scroll threshold for reloading","routing":"none","side_effects":"none","auth":"none","errors":"none","dependencies":["navigator","window"]},"calls":[],"called_by":["useAnchorSlice"],"related_files":[],"query_or_table_refs":[],"notes":"Smart threshold: 5 verses mobile/low-memory, 8 verses desktop for frequent loading"}
{"file":"client/src/hooks/useAnchorSlice.ts","lines":"61-130","symbol":"useAnchorSlice","kind":"react_hook","export":"named","signature":"(containerRef, verseKeys, options): { anchorIndex, slice }","governs":{"ui":"none directly","state":"manages anchor index and verse slice state","data":"provides verse slice data for virtual scrolling","routing":"none","side_effects":"scroll event listeners, position restoration, performance pausing","auth":"none","errors":"handles invalid anchor bounds","dependencies":["react","getVerseKeys","loadChunk"]},"calls":["useState","useLayoutEffect","loadChunk","requestAnimationFrame","addEventListener","removeEventListener"],"called_by":["VirtualBibleTable"],"related_files":["client/src/components/bible/VirtualBibleTable.tsx"],"query_or_table_refs":[],"notes":"Advanced anchor-centered virtual scrolling with instant mobile loading, scroll position preservation, and performance optimization during drag"}
{"file":"client/src/hooks/useRowData.ts","lines":"4-12","symbol":"useRowData","kind":"react_hook","export":"named","signature":"(verseIDs: string[], mainTranslation: string): QueryResult","governs":{"ui":"none","state":"none","data":"loads Bible verse text data for current slice","routing":"none","side_effects":"TanStack Query caching","auth":"none","errors":"none","dependencies":["@tanstack/react-query","@/data/BibleDataAPI"]},"calls":["useQuery","BibleDataAPI.getTranslationText"],"called_by":["VirtualBibleTable"],"related_files":["client/src/data/BibleDataAPI.ts","client/src/components/bible/VirtualBibleTable.tsx"],"query_or_table_refs":[],"notes":"Simple hook for loading verse row data with 30s stale time and object mapping"}
{"file":"client/src/components/bible/VirtualRow.tsx","lines":"22-1056","symbol":"VirtualRow","kind":"component","export":"default","signature":"(props: VirtualRowProps): JSX.Element","governs":{"ui":"renders complete Bible verse row with all column types","state":"manages cell interactions, hover states","data":"coordinates verse text, cross-references, notes, labels across translations","routing":"none","side_effects":"click event handling, touch optimization","auth":"integrates user authentication for notes","errors":"handles missing verse text with fallbacks","dependencies":["react","20+ custom hooks","multiple cell components"]},"calls":["useBibleStore","useTranslationMaps","useEnsureTranslationLoaded","useIsMobile","getVisibleColumns","useColumnData","useResponsiveColumns","useLabeledText","useViewportLabels","ReferenceCell","CrossReferencesCell","NotesCell","VerseText","HoverVerseBar","InlineDateInfo"],"called_by":["VirtualBibleTable"],"related_files":["client/src/components/bible/VirtualBibleTable.tsx"],"query_or_table_refs":[],"notes":"Complex 1056-line row component handling 20-column system with responsive layout and full feature integration"}
{"file":"client/src/components/bible/VirtualRow.tsx","lines":"46-60","symbol":"ReferenceCell","kind":"component","export":"internal","signature":"({ verse }: CellProps): JSX.Element","governs":{"ui":"renders verse reference column with mobile optimization","state":"none","data":"displays verse reference","routing":"none","side_effects":"none","auth":"none","errors":"none","dependencies":["useIsMobile"]},"calls":["useIsMobile"],"called_by":["VirtualRow"],"related_files":[],"query_or_table_refs":[],"notes":"Reference column component with glass morphism styling and mobile-specific CSS classes"}
{"file":"client/src/components/bible/VirtualRow.tsx","lines":"62-175","symbol":"CrossReferencesCell","kind":"component","export":"internal","signature":"({ verse, getVerseText, mainTranslation, onVerseClick, getVerseLabels }: CellProps): JSX.Element","governs":{"ui":"renders cross-reference column with clickable references and verse text","state":"manages click event handling and hover states","data":"displays cross-reference text with label integration","routing":"none","side_effects":"click/touch event handling, navigation triggering","auth":"none","errors":"handles missing cross-reference text","dependencies":["useBibleStore","LabeledText"]},"calls":["useBibleStore","renderTextWithLabels","handleCrossRefClick","LabeledText"],"called_by":["VirtualRow"],"related_files":["client/src/components/bible/LabeledText.tsx"],"query_or_table_refs":[],"notes":"Complex cross-reference cell with touch optimization, label rendering, and navigation handling"}
{"file":"client/src/components/bible/NewColumnHeaders.tsx","lines":"52-535","symbol":"NewColumnHeaders","kind":"component","export":"named","signature":"(props: NewColumnHeadersProps): JSX.Element","governs":{"ui":"renders adaptive column headers with drag-and-drop, presentation mode, navigation","state":"manages presentation mode, column drag state, CSS variable tracking","data":"coordinates column configuration with store state","routing":"none","side_effects":"CSS variable manipulation, custom events, async imports","auth":"integrates guest mode handling","errors":"handles async import failures with fallbacks","dependencies":["react","@dnd-kit/core","@dnd-kit/sortable","15+ custom hooks"]},"calls":["useTranslationMaps","useBibleStore","useAdaptivePortraitColumns","useState","useEffect","useCallback","useMemo","DndContext","SortableContext","ColumnNavigationArrows","Button","togglePresentationMode"],"called_by":["VirtualBibleTable"],"related_files":["client/src/store/translationSlice.ts","client/src/hooks/useAdaptivePortraitColumns.ts"],"query_or_table_refs":[],"notes":"Complex 535-line header component with presentation mode (width x2, text x1.5, row x1.35) and drag-and-drop column reordering"}
{"file":"client/src/components/bible/NewColumnHeaders.tsx","lines":"143-175","symbol":"togglePresentationMode","kind":"function","export":"internal","signature":"(): Promise<void>","governs":{"ui":"toggles presentation mode with instant visual scaling","state":"manages presentation mode state","data":"none","routing":"none","side_effects":"CSS variable manipulation, console logging, custom events","auth":"none","errors":"handles async import failures","dependencies":["document.documentElement","useColumnChangeEmitter"]},"calls":["document.documentElement.style.setProperty","setIsPresentationMode","useColumnChangeEmitter","window.import"],"called_by":["NewColumnHeaders"],"related_files":["client/src/hooks/useColumnChangeSignal.ts"],"query_or_table_refs":[],"notes":"Presentation mode toggle: width x2, text x1.5, row height x1.35 with signal emission"}
{"file":"client/src/components/bible/LabeledText.tsx","lines":"15-63","symbol":"LabeledText","kind":"component","export":"default","signature":"({ text, labelData, activeLabels, verseKey }: Props): JSX.Element","governs":{"ui":"renders text with semantic label highlighting","state":"none","data":"processes label data for text segments","routing":"none","side_effects":"console logging for debugging","auth":"none","errors":"handles empty text with loading fallback","dependencies":["react","@/hooks/useLabeledText","@/lib/labelRenderer","@/lib/labelBits"]},"calls":["useLabeledText","classesForMask","text.slice","React.Fragment"],"called_by":["CrossReferencesCell","VirtualRow"],"related_files":["client/src/hooks/useLabeledText.ts","client/src/lib/labelRenderer.ts"],"query_or_table_refs":[],"notes":"Text rendering component with semantic label styling using mask-based CSS classes"}
{"file":"client/src/workers/strongsWorker.ts","lines":"1-80","symbol":"strongsWorker","kind":"function","export":"internal","signature":"Web Worker message handler","governs":{"ui":"none","state":"none","data":"processes Strong's concordance data for word analysis","routing":"none","side_effects":"heavy concordance processing without blocking UI","auth":"none","errors":"posts error messages to main thread","dependencies":["Web Worker API"]},"calls":["postMessage"],"called_by":["useStrongsWorker"],"related_files":["client/src/hooks/useStrongsWorker.ts"],"query_or_table_refs":[],"notes":"Background worker for Strong's concordance word analysis"}
{"file":"migration.sql","lines":"4-13","symbol":"DROP_TABLES","kind":"sql_function","export":"internal","signature":"DROP TABLE statements","governs":{"ui":"none","state":"none","data":"drops existing database tables for clean migration","routing":"none","side_effects":"destroys existing table data","auth":"none","errors":"none","dependencies":["PostgreSQL"]},"calls":[],"called_by":["database migration"],"related_files":["shared/schema.ts"],"query_or_table_refs":["navigation_history","user_sessions","user_highlights","user_bookmarks","user_notes","notes","profiles","users"],"notes":"Database cleanup for fresh schema migration"}
{"file":"migration.sql","lines":"15-71","symbol":"CREATE_TABLES","kind":"sql_function","export":"internal","signature":"CREATE TABLE statements","governs":{"ui":"none","state":"none","data":"creates core database schema for users, bookmarks, notes, highlights, navigation","routing":"none","side_effects":"creates database structure","auth":"establishes user relationship constraints","errors":"none","dependencies":["PostgreSQL"]},"calls":[],"called_by":["database migration"],"related_files":["shared/schema.ts"],"query_or_table_refs":["users","user_bookmarks","user_notes","user_highlights","navigation_history","user_sessions"],"notes":"Core database schema creation for Bible study application"}
{"file":"migration.sql","lines":"74-77","symbol":"CREATE_INDEXES","kind":"sql_function","export":"internal","signature":"CREATE INDEX statements","governs":{"ui":"none","state":"none","data":"creates database indexes for query performance","routing":"none","side_effects":"improves database query performance","auth":"none","errors":"none","dependencies":["PostgreSQL"]},"calls":[],"called_by":["database migration"],"related_files":[],"query_or_table_refs":["idx_user_bookmarks_user_id","idx_user_notes_user_id","idx_user_highlights_user_id","idx_navigation_history_user_visited"],"notes":"Performance optimization indexes for user data queries"}
{"file":"client/src/hooks/useAdaptivePortraitColumns.ts","lines":"22-119","symbol":"calculatePrecisionPortraitWidths","kind":"function","export":"internal","signature":"(viewportWidth: number, viewportHeight: number): AdaptivePortraitConfig['adaptiveWidths']","governs":{"ui":"none","state":"none","data":"calculates precise column widths for portrait mode with equal main/cross division","routing":"none","side_effects":"console logging for debugging","auth":"none","errors":"none","dependencies":["Math.floor","Math.max","Math.min"]},"calls":["console.log","Math.floor","Math.max","Math.min"],"called_by":["useAdaptivePortraitColumns"],"related_files":[],"query_or_table_refs":[],"notes":"Complex width calculation: reference column by breakpoint, then equal division of remaining space between main/cross-reference columns"}
{"file":"client/src/hooks/useAdaptivePortraitColumns.ts","lines":"158-175","symbol":"updateCSSVariables","kind":"function","export":"internal","signature":"(widths: AdaptivePortraitConfig['adaptiveWidths']): void","governs":{"ui":"none directly","state":"none","data":"none","routing":"none","side_effects":"updates CSS custom properties for adaptive column widths","auth":"none","errors":"none","dependencies":["document.documentElement"]},"calls":["document.documentElement.style.setProperty","console.log"],"called_by":["useAdaptivePortraitColumns","updateConfig"],"related_files":[],"query_or_table_refs":[],"notes":"Updates 7 CSS variables: --adaptive-ref-width, --adaptive-main-width, --adaptive-cross-width, etc. for real-time column width updates"}
{"file":"client/src/hooks/useAdaptivePortraitColumns.ts","lines":"121-236","symbol":"useAdaptivePortraitColumns","kind":"react_hook","export":"named","signature":"(): AdaptivePortraitConfig","governs":{"ui":"none directly","state":"manages adaptive column configuration state","data":"provides viewport-aware column width calculations","routing":"none","side_effects":"resize/orientation event listeners, CSS variable updates","auth":"none","errors":"none","dependencies":["react","calculatePrecisionPortraitWidths","updateCSSVariables"]},"calls":["useState","useEffect","calculatePrecisionPortraitWidths","updateCSSVariables","addEventListener","removeEventListener","setTimeout"],"called_by":["NewColumnHeaders","VirtualRow"],"related_files":["client/src/components/bible/NewColumnHeaders.tsx"],"query_or_table_refs":[],"notes":"Advanced responsive column system with SSR fallback, live viewport tracking, and CSS variable synchronization for portrait mode optimization"}
{"file":"client/src/hooks/useColumnData.ts","lines":"6-38","symbol":"useColumnData","kind":"react_hook","export":"named","signature":"(): { loadProphecyData: Function }","governs":{"ui":"none","state":"none","data":"orchestrates column-specific data loading","routing":"none","side_effects":"async data loading, console logging","auth":"none","errors":"handles prophecy loading failures","dependencies":["react","@/App","@/data/BibleDataAPI","@/lib/prophecyCache"]},"calls":["useBibleStore","useEffect","loadProphecyData","import"],"called_by":["VirtualRow","column components"],"related_files":["client/src/lib/prophecyCache.ts","client/src/data/BibleDataAPI.ts"],"query_or_table_refs":[],"notes":"Column data orchestrator: prophecy loading on column toggle, cross-refs handled by separate loader"}
{"file":"client/src/hooks/useColumnData.ts","lines":"20-33","symbol":"loadProphecyData","kind":"function","export":"internal","signature":"(): Promise<void>","governs":{"ui":"none","state":"none","data":"loads prophecy data via cache system","routing":"none","side_effects":"async cache loading, console logging","auth":"none","errors":"logs prophecy loading failures","dependencies":["@/lib/prophecyCache"]},"calls":["console.log","console.error","import","ensureProphecyLoaded"],"called_by":["useColumnData"],"related_files":["client/src/lib/prophecyCache.ts"],"query_or_table_refs":[],"notes":"Async prophecy data loader using prophecyCache.ensureProphecyLoaded() with error handling"}
{"file":"client/src/hooks/useTranslationMaps.ts","lines":"32-219","symbol":"useTranslationMaps","kind":"react_hook","export":"named","signature":"(): UseTranslationMapsReturn","governs":{"ui":"none directly","state":"manages translation state via Zustand store","data":"coordinates translation loading, caching, and verse text access","routing":"none","side_effects":"translation loading, cache management, toast notifications","auth":"none","errors":"handles translation loading failures with toasts","dependencies":["react","masterCache","Zustand store","BibleDataAPI","preloader"]},"calls":["useTranslationStore","useState","useEffect","useCallback","useRef","preloadKJV","isKJVReady","masterCache.get","masterCache.has","toggleTranslation","removeTranslation","getVerseText","setMain","setAlternates"],"called_by":["VirtualRow","translation components"],"related_files":["client/src/store/translationSlice.ts","client/src/lib/supabaseClient.ts","client/src/data/BibleDataAPI.ts"],"query_or_table_refs":[],"notes":"Master translation coordination hook: handles main/alternate translations, cache management, instant KJV access, and verse text retrieval"}
{"file":"client/src/hooks/useTranslationMaps.ts","lines":"96-148","symbol":"toggleTranslation","kind":"function","export":"internal","signature":"(code: string, setAsMain = false): Promise<void>","governs":{"ui":"none","state":"updates translation state via Zustand","data":"loads translations into master cache","routing":"none","side_effects":"translation loading, cache updates, toast notifications","auth":"none","errors":"shows toast for failed translation loads","dependencies":["masterCache","BibleDataAPI","Zustand store","toast"]},"calls":["setIsLoading","masterCache.has","import","loadTranslation","console.log","console.error","toast","translationStore.setMain","translationStore.toggleAlternate"],"called_by":["useTranslationMaps","translation selectors"],"related_files":["client/src/data/BibleDataAPI.ts","client/src/hooks/use-toast.ts"],"query_or_table_refs":[],"notes":"Translation toggle with validation: loads from anointed bucket, validates map size, shows fail-loud toast for missing translations"}
{"file":"client/src/hooks/useTranslationMaps.ts","lines":"169-175","symbol":"getVerseText","kind":"function","export":"internal","signature":"(verseID: string, translationCode: string): string | undefined","governs":{"ui":"none","state":"none","data":"retrieves specific verse text from translation cache","routing":"none","side_effects":"none","auth":"none","errors":"returns undefined for missing translations/verses","dependencies":["masterCache"]},"calls":["masterCache.get","translationMap.get"],"called_by":["VirtualRow","verse display components"],"related_files":[],"query_or_table_refs":[],"notes":"Direct verse text lookup: translationMap.get(verseID) with dot format verse IDs for O(1) access"}
{"file":"client/src/hooks/useTranslationMaps.ts","lines":"181-187","symbol":"getMainVerseText","kind":"function","export":"internal","signature":"(verseID: string): string | undefined","governs":{"ui":"none","state":"none","data":"retrieves verse text from main translation only","routing":"none","side_effects":"none","auth":"none","errors":"returns undefined for missing main translation/verses","dependencies":["masterCache","mainTranslation"]},"calls":["masterCache.get","mainTranslationMap.get"],"called_by":["cross-reference components","prophecy components","date components"],"related_files":[],"query_or_table_refs":[],"notes":"Main translation verse lookup: used by cross-refs, prophecy, dates that always display main translation text"}
{"file":"client/src/hooks/useResponsiveColumns.ts","lines":"29-147","symbol":"useResponsiveColumns","kind":"react_hook","export":"named","signature":"(): ResponsiveColumnConfig","governs":{"ui":"none directly","state":"manages window size state for responsive calculations","data":"provides responsive column configuration","routing":"none","side_effects":"resize event listeners","auth":"none","errors":"none","dependencies":["react","window"]},"calls":["useState","useEffect","useMemo","addEventListener","removeEventListener","calculateOptimalWidths","handleResize"],"called_by":["VirtualRow","column components"],"related_files":[],"query_or_table_refs":[],"notes":"Responsive column system with intelligent width calculation for portrait/landscape modes and 20-column layout support"}
{"file":"client/src/hooks/useResponsiveColumns.ts","lines":"36-41","symbol":"handleResize","kind":"function","export":"internal","signature":"(): void","governs":{"ui":"none","state":"updates window size state","data":"none","routing":"none","side_effects":"none","auth":"none","errors":"none","dependencies":["window","setWindowSize"]},"calls":["setWindowSize","window.innerWidth","window.innerHeight"],"called_by":["useResponsiveColumns"],"related_files":[],"query_or_table_refs":[],"notes":"Window resize handler for reactive column calculations"}
{"file":"client/src/hooks/useResponsiveColumns.ts","lines":"57-119","symbol":"calculateOptimalWidths","kind":"function","export":"internal","signature":"(): ColumnPixelWidths","governs":{"ui":"none","state":"none","data":"calculates optimal column widths based on viewport characteristics","routing":"none","side_effects":"none","auth":"none","errors":"none","dependencies":["Math.floor","windowSize"]},"calls":["Math.floor"],"called_by":["useResponsiveColumns"],"related_files":[],"query_or_table_refs":[],"notes":"Intelligent width calculation: portrait mode (3 breakpoints), landscape mode, with equal main/cross-ref division"}
{"file":"client/src/hooks/useAuth.ts","lines":"5-102","symbol":"useAuth","kind":"react_hook","export":"named","signature":"(): AuthHookReturn","governs":{"ui":"none directly","state":"manages user authentication state","data":"coordinates Supabase auth operations","routing":"none","side_effects":"Supabase auth calls, console logging","auth":"manages entire authentication lifecycle","errors":"handles auth errors with graceful fallbacks","dependencies":["react","@/lib/supabaseClient","@shared/schema"]},"calls":["useState","useEffect","checkAuth","signIn","signUp","signOut","supabase.auth"],"called_by":["AuthProvider","auth components"],"related_files":["client/src/contexts/AuthContext.tsx","client/src/lib/supabaseClient.ts"],"query_or_table_refs":[],"notes":"Master authentication hook with user state management and complete auth lifecycle (sign in/up/out)"}
{"file":"client/src/hooks/useAuth.ts","lines":"11-28","symbol":"checkAuth","kind":"function","export":"internal","signature":"(): Promise<void>","governs":{"ui":"none","state":"updates user state on auth check","data":"retrieves current user from Supabase","routing":"none","side_effects":"Supabase user query, console logging","auth":"validates current session","errors":"handles auth check failures gracefully","dependencies":["supabase.auth","setUser","setLoading"]},"calls":["supabase.auth.getUser","setUser","setLoading","console.info"],"called_by":["useAuth"],"related_files":[],"query_or_table_refs":[],"notes":"Authentication verification on hook initialization with user mapping"}
{"file":"client/src/hooks/useAuth.ts","lines":"33-55","symbol":"signIn","kind":"function","export":"internal","signature":"(email: string, password: string): Promise<AuthResult>","governs":{"ui":"none","state":"updates user state on successful sign in","data":"authenticates user via Supabase","routing":"none","side_effects":"Supabase auth call","auth":"handles password-based authentication","errors":"returns error messages for failed auth","dependencies":["supabase.auth","setUser"]},"calls":["supabase.auth.signInWithPassword","setUser"],"called_by":["useAuth","sign in components"],"related_files":[],"query_or_table_refs":[],"notes":"Password-based authentication with user mapping and error handling"}
{"file":"client/src/hooks/useAuth.ts","lines":"57-82","symbol":"signUp","kind":"function","export":"internal","signature":"(email: string, password: string, name: string): Promise<AuthResult>","governs":{"ui":"none","state":"updates user state on successful sign up","data":"creates new user via Supabase","routing":"none","side_effects":"Supabase auth call","auth":"handles user registration","errors":"returns error messages for failed registration","dependencies":["supabase.auth","setUser"]},"calls":["supabase.auth.signUp","setUser"],"called_by":["useAuth","sign up components"],"related_files":[],"query_or_table_refs":[],"notes":"User registration with metadata (name) and user mapping"}
{"file":"client/src/hooks/useAuth.ts","lines":"84-91","symbol":"signOut","kind":"function","export":"internal","signature":"(): Promise<void>","governs":{"ui":"none","state":"clears user state on sign out","data":"ends Supabase session","routing":"none","side_effects":"Supabase auth call, console logging","auth":"handles session termination","errors":"logs sign out failures","dependencies":["supabase.auth","setUser"]},"calls":["supabase.auth.signOut","setUser","console.error"],"called_by":["useAuth","sign out components"],"related_files":[],"query_or_table_refs":[],"notes":"Session termination with state cleanup"}
{"file":"client/src/hooks/useBookmarks.ts","lines":"7-144","symbol":"useBookmarks","kind":"react_hook","export":"named","signature":"(): BookmarksHookReturn","governs":{"ui":"none directly","state":"manages bookmarks state and loading","data":"coordinates bookmark CRUD operations","routing":"none","side_effects":"Supabase database calls, localStorage access","auth":"requires authenticated user for operations","errors":"handles database errors with logging","dependencies":["react","@/lib/supabaseClient","@/contexts/AuthContext","localStorage"]},"calls":["useState","useEffect","useAuth","getCurrentIndex","loadBookmarks","addBookmark","deleteBookmark","updateBookmark"],"called_by":["bookmark components"],"related_files":["client/src/contexts/AuthContext.tsx","shared/schema.ts"],"query_or_table_refs":["bookmarks"],"notes":"Complete bookmark management with CRUD operations and reading state integration"}
{"file":"client/src/hooks/useBookmarks.ts","lines":"12-22","symbol":"getCurrentIndex","kind":"function","export":"internal","signature":"(): number","governs":{"ui":"none","state":"none","data":"retrieves current reading position from localStorage","routing":"none","side_effects":"localStorage access, console logging","auth":"none","errors":"handles localStorage parsing errors","dependencies":["localStorage","JSON.parse"]},"calls":["localStorage.getItem","JSON.parse","console.log","console.error"],"called_by":["addBookmark"],"related_files":[],"query_or_table_refs":[],"notes":"Reading state integration for bookmark positioning with error handling"}
{"file":"client/src/hooks/useBookmarks.ts","lines":"36-57","symbol":"loadBookmarks","kind":"function","export":"internal","signature":"(): Promise<void>","governs":{"ui":"none","state":"updates bookmarks state","data":"loads user bookmarks from database","routing":"none","side_effects":"Supabase database query, console logging","auth":"requires authenticated user","errors":"handles database query errors","dependencies":["supabase","user","setBookmarks","setLoading"]},"calls":["supabase.from.select.eq","setBookmarks","setLoading","console.log","console.error"],"called_by":["useBookmarks","refresh"],"related_files":[],"query_or_table_refs":["bookmarks"],"notes":"Bookmark loading with user filtering and error handling"}
{"file":"client/src/hooks/useBookmarks.ts","lines":"59-93","symbol":"addBookmark","kind":"function","export":"internal","signature":"(name: string, color = '#ef4444'): Promise<Bookmark>","governs":{"ui":"none","state":"updates bookmarks state with new entry","data":"creates bookmark in database","routing":"none","side_effects":"Supabase database insert, localStorage access","auth":"requires authenticated user","errors":"handles database insert errors","dependencies":["supabase","user","getCurrentIndex","setBookmarks"]},"calls":["getCurrentIndex","supabase.from.insert.select.single","setBookmarks","console.log","console.error"],"called_by":["bookmark creation components"],"related_files":[],"query_or_table_refs":["bookmarks"],"notes":"Bookmark creation with current reading position and color customization"}
{"file":"client/src/hooks/useBookmarks.ts","lines":"95-112","symbol":"deleteBookmark","kind":"function","export":"internal","signature":"(id: number): Promise<void>","governs":{"ui":"none","state":"removes bookmark from state","data":"deletes bookmark from database","routing":"none","side_effects":"Supabase database delete","auth":"requires authenticated user and ownership","errors":"handles database delete errors","dependencies":["supabase","user","setBookmarks"]},"calls":["supabase.from.delete.eq","setBookmarks","console.error"],"called_by":["bookmark management components"],"related_files":[],"query_or_table_refs":["bookmarks"],"notes":"Bookmark deletion with user ownership verification"}
{"file":"client/src/hooks/useBookmarks.ts","lines":"114-134","symbol":"updateBookmark","kind":"function","export":"internal","signature":"(id: number, updates: Partial<Pick<Bookmark, 'name' | 'color'>>): Promise<Bookmark>","governs":{"ui":"none","state":"updates bookmark in state","data":"updates bookmark in database","routing":"none","side_effects":"Supabase database update","auth":"requires authenticated user and ownership","errors":"handles database update errors","dependencies":["supabase","user","setBookmarks"]},"calls":["supabase.from.update.eq.select.single","setBookmarks","console.error"],"called_by":["bookmark edit components"],"related_files":[],"query_or_table_refs":["bookmarks"],"notes":"Bookmark update with name and color modification support"}
{"file":"client/src/hooks/useHighlights.ts","lines":"6-120","symbol":"useHighlights","kind":"react_hook","export":"named","signature":"(verseRef?: string): HighlightsHookReturn","governs":{"ui":"none directly","state":"manages highlights state and loading","data":"coordinates highlight CRUD operations","routing":"none","side_effects":"Supabase database calls","auth":"requires authenticated user for operations","errors":"handles database errors with logging","dependencies":["react","@/lib/supabaseClient","@/contexts/AuthContext"]},"calls":["useState","useEffect","useAuth","loadHighlights","addHighlight","deleteHighlight","updateHighlightColor"],"called_by":["highlighting components","VerseText"],"related_files":["client/src/contexts/AuthContext.tsx","shared/schema.ts"],"query_or_table_refs":["highlights"],"notes":"Text highlighting system with verse-specific highlights, color management, and position-based sorting"}
{"file":"client/src/hooks/useHighlights.ts","lines":"20-39","symbol":"loadHighlights","kind":"function","export":"internal","signature":"(): Promise<void>","governs":{"ui":"none","state":"updates highlights state","data":"loads user highlights for specific verse","routing":"none","side_effects":"Supabase database query","auth":"requires authenticated user","errors":"handles database query errors","dependencies":["supabase","user","verseRef","setHighlights","setLoading"]},"calls":["supabase.from.select.eq.order","setHighlights","setLoading","console.error"],"called_by":["useHighlights"],"related_files":[],"query_or_table_refs":["highlights"],"notes":"Highlights loading with verse filtering and position-based ordering"}
{"file":"client/src/hooks/useHighlights.ts","lines":"41-69","symbol":"addHighlight","kind":"function","export":"internal","signature":"(translation: string, startPos: number, endPos: number, colorHsl: string): Promise<Highlight>","governs":{"ui":"none","state":"adds highlight to state","data":"creates highlight in database","routing":"none","side_effects":"Supabase database insert","auth":"requires authenticated user","errors":"handles database insert errors","dependencies":["supabase","user","verseRef","setHighlights"]},"calls":["supabase.from.insert.select.single","setHighlights","console.error"],"called_by":["text selection components"],"related_files":[],"query_or_table_refs":["highlights"],"notes":"Highlight creation with position range and color, maintains sorted order by start position"}
{"file":"client/src/hooks/useHighlights.ts","lines":"71-88","symbol":"deleteHighlight","kind":"function","export":"internal","signature":"(id: number): Promise<void>","governs":{"ui":"none","state":"removes highlight from state","data":"deletes highlight from database","routing":"none","side_effects":"Supabase database delete","auth":"requires authenticated user and ownership","errors":"handles database delete errors","dependencies":["supabase","user","setHighlights"]},"calls":["supabase.from.delete.eq","setHighlights","console.error"],"called_by":["highlight management components"],"related_files":[],"query_or_table_refs":["highlights"],"notes":"Highlight deletion with user ownership verification"}
{"file":"client/src/hooks/useHighlights.ts","lines":"90-110","symbol":"updateHighlightColor","kind":"function","export":"internal","signature":"(id: number, colorHsl: string): Promise<Highlight>","governs":{"ui":"none","state":"updates highlight color in state","data":"updates highlight color in database","routing":"none","side_effects":"Supabase database update","auth":"requires authenticated user and ownership","errors":"handles database update errors","dependencies":["supabase","user","setHighlights"]},"calls":["supabase.from.update.eq.select.single","setHighlights","console.error"],"called_by":["color picker components"],"related_files":[],"query_or_table_refs":["highlights"],"notes":"Highlight color modification with ownership verification"}
{"file":"client/src/hooks/useHighlights.ts","lines":"123-138","symbol":"adaptColorForTheme","kind":"function","export":"named","signature":"(hslColor: string, theme: 'light' | 'dark'): string","governs":{"ui":"none directly","state":"none","data":"adapts highlight colors for theme changes","routing":"none","side_effects":"none","auth":"none","errors":"returns original color for invalid format","dependencies":["Math.min","Math.max","parseInt"]},"calls":["hslColor.match","parseInt","Math.min","Math.max"],"called_by":["theme switching components","highlight rendering"],"related_files":[],"query_or_table_refs":[],"notes":"Theme-aware color adaptation: lightens for dark theme, darkens for light theme"}
{"file":"client/src/hooks/useNotes.ts","lines":"7-80","symbol":"useNotes","kind":"react_hook","export":"named","signature":"(verseRef?: string): NotesHookReturn","governs":{"ui":"none directly","state":"manages notes state via cache integration","data":"coordinates note CRUD operations with caching","routing":"none","side_effects":"Supabase database calls, cache updates","auth":"requires authenticated user for operations","errors":"handles database errors","dependencies":["react","@/lib/supabaseClient","@/contexts/AuthContext","useNotesCache"]},"calls":["useAuth","useNotesCache","useState","useEffect","useCallback","getCachedNotes","addNote","updateNote","deleteNote","updateCache"],"called_by":["NotesCell","note components"],"related_files":["client/src/hooks/useNotesCache.ts","client/src/contexts/AuthContext.tsx"],"query_or_table_refs":["notes"],"notes":"Notes management with global cache integration for performance optimization"}
{"file":"client/src/hooks/useNotes.ts","lines":"31-46","symbol":"addNote","kind":"function","export":"internal","signature":"(text: string): Promise<void>","governs":{"ui":"none","state":"updates local notes state and global cache","data":"creates note in database","routing":"none","side_effects":"Supabase database insert, cache updates","auth":"requires authenticated user","errors":"handles database insert errors","dependencies":["supabase","user","verseRef","setNotes","updateCache"]},"calls":["supabase.from.insert.select.single","setNotes","updateCache"],"called_by":["note creation components"],"related_files":[],"query_or_table_refs":["notes"],"notes":"Note creation with dual state update: local component state and global cache"}
{"file":"client/src/hooks/useNotes.ts","lines":"48-65","symbol":"updateNote","kind":"function","export":"internal","signature":"(id: number, text: string): Promise<void>","governs":{"ui":"none","state":"updates local notes state and global cache","data":"updates note in database","routing":"none","side_effects":"Supabase database update, cache updates","auth":"implicit user ownership through database design","errors":"handles database update errors","dependencies":["supabase","setNotes","updateCache"]},"calls":["supabase.from.update.eq.select.single","setNotes","updateCache"],"called_by":["note editing components"],"related_files":[],"query_or_table_refs":["notes"],"notes":"Note text modification with dual state update pattern"}
{"file":"client/src/hooks/useNotes.ts","lines":"67-77","symbol":"deleteNote","kind":"function","export":"internal","signature":"(id: number): Promise<void>","governs":{"ui":"none","state":"removes note from local state and global cache","data":"deletes note from database","routing":"none","side_effects":"Supabase database delete, cache updates","auth":"implicit user ownership through database design","errors":"handles database delete errors","dependencies":["supabase","setNotes","updateCache"]},"calls":["supabase.from.delete.eq","setNotes","updateCache"],"called_by":["note deletion components"],"related_files":[],"query_or_table_refs":["notes"],"notes":"Note deletion with dual state cleanup pattern"}
{"file":"client/src/hooks/useVerseNav.ts","lines":"9-168","symbol":"useVerseNav","kind":"react_hook","export":"named","signature":"(scrollToVerse: ScrollToFn): VerseNavReturn","governs":{"ui":"none directly","state":"manages navigation history state","data":"none","routing":"coordinates verse navigation and history","side_effects":"browser history manipulation, custom events, scroll triggering","auth":"none","errors":"none","dependencies":["react","@/lib/verseKeysLoader","useMobileDetection","window.history"]},"calls":["getVerseKeys","useMobileDetection","useState","useRef","useEffect","goTo","goBack","goForward","addEventListener","removeEventListener"],"called_by":["cross-reference links","navigation components"],"related_files":["client/src/hooks/useMobileDetection.ts","client/src/lib/verseKeysLoader.ts"],"query_or_table_refs":[],"notes":"Dual navigation system: mobile internal history (10 entries max), desktop browser history with popstate handling"}
{"file":"client/src/hooks/useVerseNav.ts","lines":"19-74","symbol":"goTo","kind":"function","export":"internal","signature":"(ref: string): void","governs":{"ui":"none","state":"updates navigation history","data":"none","routing":"navigates to specific verse","side_effects":"history updates, scroll triggering, custom events","auth":"none","errors":"none","dependencies":["scrollToVerse","window.history","CustomEvent"]},"calls":["scrollToVerse","setMobileHistory","setMobileHistoryIndex","window.history.pushState","window.dispatchEvent","setTimeout"],"called_by":["cross-reference clicks","navigation controls"],"related_files":[],"query_or_table_refs":[],"notes":"Smart navigation: mobile history stack vs desktop browser history, with loading detection events"}
{"file":"client/src/hooks/useVerseNav.ts","lines":"77-97","symbol":"goBack","kind":"function","export":"internal","signature":"(): boolean","governs":{"ui":"none","state":"updates navigation history index","data":"none","routing":"navigates backward in history","side_effects":"scroll triggering, browser back","auth":"none","errors":"none","dependencies":["scrollToVerse","window.history"]},"calls":["scrollToVerse","setMobileHistoryIndex","window.history.back"],"called_by":["navigation controls"],"related_files":[],"query_or_table_refs":[],"notes":"Dual back navigation: mobile internal history vs desktop browser back"}
{"file":"client/src/hooks/useVerseNav.ts","lines":"99-119","symbol":"goForward","kind":"function","export":"internal","signature":"(): boolean","governs":{"ui":"none","state":"updates navigation history index","data":"none","routing":"navigates forward in history","side_effects":"scroll triggering, browser forward","auth":"none","errors":"none","dependencies":["scrollToVerse","window.history"]},"calls":["scrollToVerse","setMobileHistoryIndex","window.history.forward"],"called_by":["navigation controls"],"related_files":[],"query_or_table_refs":[],"notes":"Dual forward navigation: mobile internal history vs desktop browser forward"}
{"file":"client/src/hooks/useLabeledText.ts","lines":"6-50","symbol":"useLabeledText","kind":"react_hook","export":"named","signature":"(text: string, labelData: Record<string, string[]>, activeLabels: (keyof typeof LabelBits)[]): Segment[]","governs":{"ui":"none directly","state":"none","data":"processes text into labeled segments with bitmask styling","routing":"none","side_effects":"none","auth":"none","errors":"none","dependencies":["react","@/lib/labelBits"]},"calls":["useMemo","LabelBits","RegExp","JSON.stringify","join"],"called_by":["LabeledText","text rendering components"],"related_files":["client/src/lib/labelBits.ts","client/src/components/bible/LabeledText.tsx"],"query_or_table_refs":[],"notes":"Advanced text segmentation: regex pattern matching, bitmask overlays, event-based range handling for semantic label rendering"}
{"file":"client/src/hooks/useColumnChangeSignal.ts","lines":"8-44","symbol":"ColumnChangeSignal","kind":"class","export":"internal","signature":"singleton class for column layout coordination","governs":{"ui":"none directly","state":"none","data":"none","routing":"none","side_effects":"custom event dispatching and listening","auth":"none","errors":"none","dependencies":["EventTarget","CustomEvent"]},"calls":["EventTarget","CustomEvent","dispatchEvent","addEventListener","removeEventListener"],"called_by":["useColumnChangeSignal","useColumnChangeEmitter"],"related_files":[],"query_or_table_refs":[],"notes":"Singleton event system for column layout coordination across components"}
{"file":"client/src/hooks/useColumnChangeSignal.ts","lines":"47-54","symbol":"useColumnChangeSignal","kind":"react_hook","export":"named","signature":"(callback: (detail: any) => void): void","governs":{"ui":"none","state":"none","data":"none","routing":"none","side_effects":"event listener registration","auth":"none","errors":"none","dependencies":["react","ColumnChangeSignal"]},"calls":["useEffect","ColumnChangeSignal.getInstance","signal.listen"],"called_by":["NewColumnHeaders","column components"],"related_files":["client/src/components/bible/NewColumnHeaders.tsx"],"query_or_table_refs":[],"notes":"Column change listener hook for reactive layout updates"}
{"file":"client/src/hooks/useColumnChangeSignal.ts","lines":"57-63","symbol":"useColumnChangeEmitter","kind":"react_hook","export":"named","signature":"(): (changeType: string, data?: any) => void","governs":{"ui":"none","state":"none","data":"none","routing":"none","side_effects":"event emission for column changes","auth":"none","errors":"none","dependencies":["react","ColumnChangeSignal"]},"calls":["useCallback","ColumnChangeSignal.getInstance","signal.emit"],"called_by":["NewColumnHeaders","presentation mode toggles"],"related_files":["client/src/components/bible/NewColumnHeaders.tsx"],"query_or_table_refs":[],"notes":"Column change emitter hook for triggering layout updates"}
{"file":"client/src/hooks/useMeasureVisibleColumns.ts","lines":"4-67","symbol":"useMeasureVisibleColumns","kind":"react_hook","export":"named","signature":"(containerEl: HTMLElement | null): void","governs":{"ui":"none directly","state":"updates visible column count and container width in store","data":"none","routing":"none","side_effects":"ResizeObserver, getBoundingClientRect, console logging","auth":"none","errors":"none","dependencies":["react","@/App","ResizeObserver"]},"calls":["useEffect","useBibleStore","getBoundingClientRect","setVisibleCount","setContainerWidthPx","ResizeObserver","observe","disconnect"],"called_by":["VirtualBibleTable","column management components"],"related_files":["client/src/App.tsx"],"query_or_table_refs":[],"notes":"Real-time column visibility calculator: measures container width, calculates fixed + navigable column fit with ResizeObserver"}
{"file":"client/src/hooks/useMeasureVisibleColumns.ts","lines":"16-52","symbol":"updateVisibleCount","kind":"function","export":"internal","signature":"(): void","governs":{"ui":"none","state":"updates store with calculated visible column count","data":"none","routing":"none","side_effects":"console logging, store updates","auth":"none","errors":"none","dependencies":["containerEl","getBoundingClientRect","Math.round","Math.max"]},"calls":["getBoundingClientRect","Math.round","Math.max","setContainerWidthPx","setVisibleCount","console.log"],"called_by":["useMeasureVisibleColumns","ResizeObserver"],"related_files":[],"query_or_table_refs":[],"notes":"Column fit calculator: fixed columns first, then navigable until width exceeded, with fallback widths (50px fixed, 200px navigable)"}
{"file":"client/src/hooks/useViewportLabels.ts","lines":"13-134","symbol":"useViewportLabels","kind":"react_hook","export":"named","signature":"({ verses, activeLabels, mainTranslation }: UseViewportLabelsProps): ViewportLabelsReturn","governs":{"ui":"none directly","state":"manages viewport labels loading state","data":"coordinates semantic label loading for visible verses plus cross-refs and prophecies","routing":"none","side_effects":"async label cache loading, console logging","auth":"none","errors":"handles label loading failures","dependencies":["react","@/lib/labelsCache","@/lib/labelBits","@/App"]},"calls":["useState","useMemo","useEffect","useBibleStore","ensureLabelCacheLoaded","getLabelsForVerses","setIsLoading","setLabelsData"],"called_by":["VirtualRow","LabeledText"],"related_files":["client/src/lib/labelsCache.ts","client/src/App.tsx"],"query_or_table_refs":[],"notes":"Advanced viewport label system: dynamically collects ALL verses (viewport + cross-refs + prophecies) for comprehensive semantic labeling"}
{"file":"client/src/hooks/useViewportLabels.ts","lines":"24-66","symbol":"allRequiredVerseKeys","kind":"memoized_value","export":"internal","signature":"useMemo calculation","governs":{"ui":"none","state":"none","data":"computes expanded verse list including cross-references and prophecy verses","routing":"none","side_effects":"console logging","auth":"none","errors":"none","dependencies":["useMemo","useBibleStore","Set","Array.from"]},"calls":["useMemo","useBibleStore.getState","Set","Array.from","console.log"],"called_by":["useViewportLabels"],"related_files":[],"query_or_table_refs":[],"notes":"Smart verse expansion: starts with viewport verses, adds all cross-references and prophecy verses for comprehensive labeling coverage"}
{"file":"client/src/hooks/useViewportLabels.ts","lines":"86-121","symbol":"loadLabels","kind":"function","export":"internal","signature":"(): Promise<void>","governs":{"ui":"none","state":"updates labels data and loading state","data":"loads semantic labels for expanded verse list","routing":"none","side_effects":"async cache operations, console logging","auth":"none","errors":"handles label loading failures with fallback","dependencies":["ensureLabelCacheLoaded","getLabelsForVerses","setIsLoading","setLabelsData"]},"calls":["setIsLoading","ensureLabelCacheLoaded","getLabelsForVerses","setLabelsData","console.log","console.error"],"called_by":["useViewportLabels"],"related_files":["client/src/lib/labelsCache.ts"],"query_or_table_refs":[],"notes":"Async label loader: normalizes active labels, ensures cache loaded for translation, gets labels for ALL expanded verses"}
{"file":"client/src/hooks/useViewportLabels.ts","lines":"125-127","symbol":"getVerseLabels","kind":"function","export":"internal","signature":"(verseReference: string): Partial<Record<LabelName, string[]>>","governs":{"ui":"none","state":"none","data":"retrieves labels for specific verse","routing":"none","side_effects":"none","auth":"none","errors":"returns empty object for missing verse labels","dependencies":["labelsData"]},"calls":[],"called_by":["LabeledText","VirtualRow"],"related_files":[],"query_or_table_refs":[],"notes":"Label accessor function: returns labels for specific verse or empty object if not found"}
{"file":"client/src/hooks/useStrongsWorker.ts","lines":"21-130","symbol":"useStrongsWorker","kind":"react_hook","export":"named","signature":"(): StrongsWorkerHook","governs":{"ui":"none directly","state":"manages worker ready state and pending requests","data":"coordinates Strong's concordance data via web worker","routing":"none","side_effects":"web worker lifecycle, async message passing","auth":"none","errors":"handles worker initialization and operation failures","dependencies":["react","@/data/BibleDataAPI","Worker"]},"calls":["useEffect","useRef","useState","getStrongsOffsets","Worker","addEventListener","removeEventListener"],"called_by":["Strong's overlay components","concordance features"],"related_files":["public/strongsWorker.js","client/src/data/BibleDataAPI.ts"],"query_or_table_refs":[],"notes":"Web worker interface for Strong's concordance: manages worker lifecycle, coordinates verse and lemma lookups with message queue"}
{"file":"client/src/hooks/useStrongsWorker.ts","lines":"28-84","symbol":"initWorker","kind":"function","export":"internal","signature":"(): Promise<void>","governs":{"ui":"none","state":"updates worker ready state","data":"initializes worker with Strong's offset data","routing":"none","side_effects":"worker creation, message handler setup, async data loading","auth":"none","errors":"handles worker initialization failures","dependencies":["Worker","getStrongsOffsets","console"]},"calls":["Worker","getStrongsOffsets","postMessage","console.log","console.error"],"called_by":["useStrongsWorker"],"related_files":["public/strongsWorker.js"],"query_or_table_refs":[],"notes":"Worker initialization: creates worker, sets up message handlers, loads Strong's offset data"}
{"file":"client/src/hooks/useStrongsWorker.ts","lines":"95-108","symbol":"getVerseStrongsData","kind":"function","export":"internal","signature":"(verseKey: string): Promise<StrongsWorkerData>","governs":{"ui":"none","state":"manages pending requests queue","data":"requests Strong's data for specific verse","routing":"none","side_effects":"worker message passing","auth":"none","errors":"returns empty data if worker unavailable","dependencies":["workerRef","isReady","pendingRequests"]},"calls":["postMessage","Promise","resolve"],"called_by":["Strong's overlay","verse analysis components"],"related_files":[],"query_or_table_refs":[],"notes":"Verse Strong's data requester: queues request, returns promise for word analysis data"}
{"file":"client/src/hooks/useStrongsWorker.ts","lines":"110-123","symbol":"getLemmaVerses","kind":"function","export":"internal","signature":"(strongsId: string): Promise<string[]>","governs":{"ui":"none","state":"manages pending requests queue","data":"requests verses containing specific Strong's number","routing":"none","side_effects":"worker message passing","auth":"none","errors":"returns empty array if worker unavailable","dependencies":["workerRef","isReady","pendingRequests"]},"calls":["postMessage","Promise","resolve"],"called_by":["Strong's concordance","word study features"],"related_files":[],"query_or_table_refs":[],"notes":"Lemma verse lookup: requests all verses containing specific Strong's number"}
{"file":"client/src/hooks/useSearchWorker.ts","lines":"21-136","symbol":"useSearchWorker","kind":"react_hook","export":"named","signature":"(): SearchWorkerHook","governs":{"ui":"none directly","state":"manages search results and loading state","data":"coordinates Bible text and Strong's searches via web worker","routing":"none","side_effects":"web worker lifecycle, custom event dispatching","auth":"none","errors":"handles worker operation failures","dependencies":["react","@/types/bible","Worker"]},"calls":["useEffect","useRef","useState","Worker","addEventListener","removeEventListener"],"called_by":["SearchModal","random verse navigation"],"related_files":["public/searchWorker.js"],"query_or_table_refs":[],"notes":"Search worker interface: manages text search, Strong's search, random verse selection with result state management"}
{"file":"client/src/hooks/useSearchWorker.ts","lines":"79-95","symbol":"initializeData","kind":"function","export":"internal","signature":"(verses: BibleVerse[], translations?: Map<string, Map<string, string>>): void","governs":{"ui":"none","state":"none","data":"sends initial data to search worker","routing":"none","side_effects":"worker message passing","auth":"none","errors":"none","dependencies":["workerRef","Array.from"]},"calls":["postMessage","Array.from"],"called_by":["useSearchWorker","search initialization"],"related_files":[],"query_or_table_refs":[],"notes":"Worker data initialization: sends verses and translation maps to search worker"}
{"file":"client/src/hooks/useSearchWorker.ts","lines":"97-105","symbol":"searchText","kind":"function","export":"internal","signature":"(query: string, translations: string[], caseSensitive?: boolean): void","governs":{"ui":"none","state":"sets searching state","data":"initiates text search in worker","routing":"none","side_effects":"worker message passing","auth":"none","errors":"none","dependencies":["workerRef","isReady","setIsSearching"]},"calls":["setIsSearching","postMessage"],"called_by":["SearchModal","text search components"],"related_files":[],"query_or_table_refs":[],"notes":"Text search dispatcher: triggers worker text search with query parameters"}
{"file":"client/src/hooks/useSearchWorker.ts","lines":"107-115","symbol":"searchStrongs","kind":"function","export":"internal","signature":"(strongsNumber: string): void","governs":{"ui":"none","state":"sets searching state","data":"initiates Strong's number search in worker","routing":"none","side_effects":"worker message passing","auth":"none","errors":"none","dependencies":["workerRef","isReady","setIsSearching"]},"calls":["setIsSearching","postMessage"],"called_by":["Strong's search components"],"related_files":[],"query_or_table_refs":[],"notes":"Strong's search dispatcher: triggers worker Strong's number search"}
{"file":"client/src/hooks/useSearchWorker.ts","lines":"117-124","symbol":"getRandomVerse","kind":"function","export":"internal","signature":"(): void","governs":{"ui":"none","state":"none","data":"requests random verse from worker","routing":"triggers navigation event","side_effects":"worker message passing, navigation events","auth":"none","errors":"none","dependencies":["workerRef","isReady"]},"calls":["postMessage"],"called_by":["random verse controls","Ctrl+R shortcut"],"related_files":[],"query_or_table_refs":[],"notes":"Random verse requester: triggers worker random verse selection with navigation"}
{"file":"client/src/hooks/useSearchWorker.ts","lines":"139-176","symbol":"performSearch","kind":"function","export":"named","signature":"({ query, translations, allVerses }: SearchParams): Promise<SearchResult[]>","governs":{"ui":"none","state":"none","data":"performs direct search without worker","routing":"none","side_effects":"console logging","auth":"none","errors":"none","dependencies":["RegExp","console"]},"calls":["console.log","toLowerCase","includes","RegExp","replace"],"called_by":["direct search scenarios","fallback search"],"related_files":[],"query_or_table_refs":[],"notes":"Direct search function: synchronous text search with highlighting, fallback for worker unavailability"}
{"file":"client/src/hooks/useInstallPrompt.ts","lines":"8-62","symbol":"useInstallPrompt","kind":"react_hook","export":"named","signature":"(): InstallPromptHook","governs":{"ui":"none directly","state":"manages install prompt state and platform detection","data":"none","routing":"none","side_effects":"PWA install prompt handling, event listeners","auth":"none","errors":"none","dependencies":["react","window"]},"calls":["useState","useEffect","addEventListener","removeEventListener","matchMedia"],"called_by":["PWA install components","app shell"],"related_files":[],"query_or_table_refs":[],"notes":"PWA install manager: handles beforeinstallprompt events, detects standalone mode, iOS Safari detection"}
{"file":"client/src/hooks/useInstallPrompt.ts","lines":"45-55","symbol":"installApp","kind":"function","export":"internal","signature":"(): Promise<void>","governs":{"ui":"none","state":"updates install prompt state","data":"none","routing":"none","side_effects":"triggers PWA install prompt","auth":"none","errors":"none","dependencies":["deferredPrompt","prompt","userChoice"]},"calls":["prompt","userChoice","setDeferredPrompt","setIsInstallable"],"called_by":["install buttons","PWA promotion components"],"related_files":[],"query_or_table_refs":[],"notes":"PWA install trigger: prompts user for app installation, handles user choice"}
{"file":"client/src/hooks/use-toast.ts","lines":"171-189","symbol":"useToast","kind":"react_hook","export":"named","signature":"(): ToastHook","governs":{"ui":"none directly","state":"manages toast notification state","data":"none","routing":"none","side_effects":"global toast listener registration","auth":"none","errors":"none","dependencies":["react","listeners array","memoryState"]},"calls":["useState","useEffect","listeners.push","listeners.splice"],"called_by":["notification components","error handling"],"related_files":["client/src/components/ui/toast.tsx"],"query_or_table_refs":[],"notes":"Toast notification hook: subscribes to global toast state changes, provides toast management functions"}
{"file":"client/src/hooks/use-toast.ts","lines":"74-127","symbol":"reducer","kind":"function","export":"named","signature":"(state: State, action: Action): State","governs":{"ui":"none","state":"manages toast state transitions","data":"none","routing":"none","side_effects":"timeout management for toast removal","auth":"none","errors":"none","dependencies":["addToRemoveQueue","TOAST_LIMIT"]},"calls":["addToRemoveQueue","slice","map","filter"],"called_by":["dispatch","toast management"],"related_files":[],"query_or_table_refs":[],"notes":"Toast state reducer: handles ADD, UPDATE, DISMISS, REMOVE actions with automatic timeout management"}
{"file":"client/src/hooks/use-toast.ts","lines":"142-169","symbol":"toast","kind":"function","export":"named","signature":"({ ...props }: Toast): ToastControl","governs":{"ui":"none directly","state":"adds toast to global state","data":"none","routing":"none","side_effects":"global toast dispatch","auth":"none","errors":"none","dependencies":["genId","dispatch","UPDATE_TOAST","DISMISS_TOAST"]},"calls":["genId","dispatch"],"called_by":["notification systems","error handlers"],"related_files":[],"query_or_table_refs":[],"notes":"Toast creator function: generates unique ID, creates toast with controls for update and dismiss"}
{"file":"client/src/hooks/use-mobile.tsx","lines":"5-19","symbol":"useIsMobile","kind":"react_hook","export":"named","signature":"(): boolean","governs":{"ui":"none directly","state":"manages mobile detection state","data":"none","routing":"none","side_effects":"window resize listeners, matchMedia","auth":"none","errors":"none","dependencies":["react","window.matchMedia","window.innerWidth"]},"calls":["useState","useEffect","matchMedia","addEventListener","removeEventListener","setIsMobile"],"called_by":["responsive components","mobile-specific logic"],"related_files":[],"query_or_table_refs":[],"notes":"Mobile breakpoint detection: 640px threshold with matchMedia and resize listener"}
{"file":"client/src/hooks/use-mobile.tsx","lines":"22-43","symbol":"useScreenSize","kind":"react_hook","export":"named","signature":"(): 'mobile' | 'tablet' | 'desktop'","governs":{"ui":"none directly","state":"manages screen size category state","data":"none","routing":"none","side_effects":"window resize listeners","auth":"none","errors":"none","dependencies":["react","window.innerWidth","window.addEventListener"]},"calls":["useState","useEffect","addEventListener","removeEventListener","setScreenSize"],"called_by":["responsive layout components","adaptive UI logic"],"related_files":[],"query_or_table_refs":[],"notes":"Screen size categorization: mobile (≤640px), tablet (641-1023px), desktop (≥1024px)"}
{"file":"client/src/components/bible/TopHeader.tsx","lines":"31-408","symbol":"TopHeader","kind":"react_component","export":"named","signature":"(props: TopHeaderProps): JSX.Element","governs":{"ui":"renders complete application header with navigation, search, authentication, and bookmarking","state":"manages modal states and responsive layout","data":"none directly","routing":"none directly","side_effects":"adaptive scaling application, localStorage access","auth":"integrates with authentication system","errors":"handles bookmark creation failures","dependencies":["@/components/ui/button","@/hooks/useAuth","@/hooks/useToast","@/hooks/useAdaptiveScaling"]},"calls":["useTheme","useAuth","useState","useWindowSize","useBibleStore","useMutation","useQueryClient","useToast","useAdaptiveScaling","getCurrentCentralVerse","handleSaveBookmark","handleBookmarkSave"],"called_by":["BiblePage","main application layout"],"related_files":["client/src/components/auth/AuthModals.tsx","client/src/components/bible/BookmarkModal.tsx"],"query_or_table_refs":["bookmarks"],"notes":"Main header component: responsive mobile/desktop layout, navigation controls, search trigger, bookmark management, authentication integration"}
{"file":"client/src/components/bible/TopHeader.tsx","lines":"58-78","symbol":"getCurrentCentralVerse","kind":"function","export":"internal","signature":"(): { reference: string; index: number }","governs":{"ui":"none","state":"none","data":"retrieves current verse position from table or localStorage fallback","routing":"none","side_effects":"localStorage access, console logging","auth":"none","errors":"handles parsing errors with fallback","dependencies":["getCurrentVerse","localStorage","JSON.parse","bibleStore"]},"calls":["getCurrentVerse","JSON.parse","localStorage.getItem","console.log","console.error"],"called_by":["createBookmarkMutation","handleBookmarkSave","TopHeader"],"related_files":[],"query_or_table_refs":[],"notes":"Central verse detector: priority to table ref, fallback to localStorage reading state, ultimate fallback to Gen.1:1"}
{"file":"client/src/components/bible/TopHeader.tsx","lines":"81-127","symbol":"createBookmarkMutation","kind":"react_mutation","export":"internal","signature":"useMutation for bookmark creation","governs":{"ui":"none directly","state":"manages mutation state","data":"creates/updates bookmarks in database","routing":"none","side_effects":"Supabase database operations, query invalidation, toast notifications","auth":"requires authenticated user","errors":"handles database errors with user feedback","dependencies":["useMutation","supabase","useQueryClient","useToast"]},"calls":["useMutation","supabase.from.upsert","queryClient.invalidateQueries","toast","console.log","console.error"],"called_by":["handleBookmarkSave"],"related_files":["shared/schema.ts"],"query_or_table_refs":["bookmarks"],"notes":"Bookmark mutation: upsert with composite key (user_id, name), handles conflicts, provides user feedback via toast"}
{"file":"client/src/components/bible/TopHeader.tsx","lines":"129-144","symbol":"handleSaveBookmark","kind":"function","export":"internal","signature":"(): void","governs":{"ui":"opens bookmark modal or shows authentication prompt","state":"updates modal state","data":"none","routing":"none","side_effects":"toast notifications for unauthenticated users","auth":"checks user authentication status","errors":"none","dependencies":["user","toast","setIsBookmarkModalOpen"]},"calls":["toast","setIsBookmarkModalOpen","console.log"],"called_by":["bookmark buttons","TopHeader"],"related_files":[],"query_or_table_refs":[],"notes":"Bookmark trigger: authentication check, opens modal for authenticated users, prompts sign-in for guests"}
{"file":"client/src/components/bible/TopHeader.tsx","lines":"146-148","symbol":"handleBookmarkSave","kind":"function","export":"internal","signature":"(name: string, color: string): void","governs":{"ui":"none","state":"none","data":"triggers bookmark creation mutation","routing":"none","side_effects":"database operations via mutation","auth":"implicit via mutation","errors":"handled by mutation","dependencies":["createBookmarkMutation"]},"calls":["createBookmarkMutation.mutate"],"called_by":["BookmarkModal","TopHeader"],"related_files":[],"query_or_table_refs":[],"notes":"Bookmark creation dispatcher: passes bookmark data to mutation for database persistence"}
{"file":"client/src/components/bible/SearchModal.tsx","lines":"39-740","symbol":"SearchModal","kind":"react_component","export":"named","signature":"(props: SearchModalProps): JSX.Element","governs":{"ui":"renders comprehensive search interface with tabs, filters, results, and keyboard navigation","state":"manages search state, results, history, and modal interactions","data":"coordinates Bible search across multiple translations","routing":"none directly","side_effects":"translation loading, search execution, console logging","auth":"none","errors":"handles search execution failures","dependencies":["@/components/ui/dialog","@/lib/bibleSearchEngine","@/hooks/useTranslationMaps"]},"calls":["useState","useEffect","useMemo","useIsMobile","useTranslationMaps","BibleSearchEngine","performSearch","handleKeyDown","handleResultClick","getRandomVerse","loadTranslationForSearch"],"called_by":["BiblePage","main search workflow"],"related_files":["client/src/lib/bibleSearchEngine.ts","client/src/hooks/useTranslationMaps.ts"],"query_or_table_refs":[],"notes":"Advanced search modal: multi-translation search, intelligent reference parsing, keyboard navigation, search history, random verse selection"}
{"file":"client/src/components/bible/SearchModal.tsx","lines":"15-29","symbol":"useIsMobile","kind":"react_hook","export":"internal","signature":"(): boolean","governs":{"ui":"none directly","state":"manages mobile detection state","data":"none","routing":"none","side_effects":"window resize listeners","auth":"none","errors":"none","dependencies":["react","window.innerWidth","addEventListener"]},"calls":["useState","useEffect","addEventListener","removeEventListener","setIsMobile"],"called_by":["SearchModal"],"related_files":[],"query_or_table_refs":[],"notes":"Mobile detection hook: 768px threshold with resize listener"}
{"file":"client/src/components/bible/SearchModal.tsx","lines":"66-85","symbol":"loadTranslationForSearch","kind":"function","export":"internal","signature":"(translationCode: string): Promise<Map<string, string> | null>","governs":{"ui":"none","state":"updates loaded translations cache","data":"loads translation data for search","routing":"none","side_effects":"dynamic import, async translation loading","auth":"none","errors":"handles translation loading failures","dependencies":["loadedTranslations","BibleDataAPI","setLoadedTranslations"]},"calls":["import","loadTranslation","setLoadedTranslations"],"called_by":["performSearch"],"related_files":["client/src/data/BibleDataAPI.ts"],"query_or_table_refs":[],"notes":"Dynamic translation loader: caches loaded translations, imports BibleDataAPI on demand"}
{"file":"client/src/components/bible/SearchModal.tsx","lines":"88-117","symbol":"versesWithText","kind":"memoized_value","export":"internal","signature":"useMemo calculation","governs":{"ui":"none","state":"none","data":"creates searchable verse objects with text from multiple translations","routing":"none","side_effects":"none","auth":"none","errors":"none","dependencies":["useMemo","verses","getVerseText","activeTranslation"]},"calls":["useMemo","getVerseText","map","forEach"],"called_by":["searchEngine"],"related_files":[],"query_or_table_refs":[],"notes":"Verse data preparation: transforms verse array into searchable format with 13 translation texts per verse"}
{"file":"client/src/components/bible/SearchModal.tsx","lines":"149-262","symbol":"performSearch","kind":"function","export":"internal","signature":"(): Promise<void>","governs":{"ui":"none directly","state":"updates search results and loading state","data":"executes search across multiple translations with result ranking","routing":"none","side_effects":"translation loading, search execution, console logging, search history updates","auth":"none","errors":"handles search execution failures","dependencies":["searchQuery","selectedTranslations","loadTranslationForSearch","getVerseText","verses"]},"calls":["setIsSearching","setHasSearched","setSearchHistory","loadTranslationForSearch","getVerseText","setAllResults","setSearchResults","console.log","console.error"],"called_by":["SearchModal","handleKeyDown"],"related_files":[],"query_or_table_refs":[],"notes":"Core search engine: direct text matching across selected translations, result highlighting, confidence scoring, search history management"}
{"file":"client/src/components/bible/SearchModal.tsx","lines":"264-322","symbol":"handleKeyDown","kind":"function","export":"internal","signature":"(e: React.KeyboardEvent): void","governs":{"ui":"none directly","state":"manages result selection and modal state","data":"none","routing":"triggers navigation to selected verse","side_effects":"keyboard event handling, result navigation","auth":"none","errors":"none","dependencies":["selectedResultIndex","searchResults","onClose","performSearch","handleResultClick"]},"calls":["preventDefault","handleResultClick","performSearch","setSelectedResultIndex","onClose","setShowAdvanced","setShowHistory","getRandomVerse"],"called_by":["SearchModal input events"],"related_files":[],"query_or_table_refs":[],"notes":"Advanced keyboard navigation: Enter (search/navigate), arrows (selection), Escape (clear/close), Ctrl shortcuts (F, H, R)"}
{"file":"client/src/components/bible/SearchModal.tsx","lines":"324-336","symbol":"handleResultClick","kind":"function","export":"internal","signature":"(result: SearchResult): void","governs":{"ui":"none","state":"none","data":"none","routing":"navigates to verse and switches translation","side_effects":"translation switching, verse navigation, modal closure","auth":"none","errors":"none","dependencies":["onNavigateToVerse","onSwitchTranslation","onClose"]},"calls":["onSwitchTranslation","onNavigateToVerse","onClose","console.log"],"called_by":["search result clicks","handleKeyDown"],"related_files":[],"query_or_table_refs":[],"notes":"Result handler: switches to result translation if different, navigates to verse, closes modal"}
{"file":"client/src/components/bible/SearchModal.tsx","lines":"338-343","symbol":"handleHistoryClick","kind":"function","export":"internal","signature":"(query: string): void","governs":{"ui":"none","state":"updates search query and triggers new search","data":"none","routing":"none","side_effects":"search execution after timeout","auth":"none","errors":"none","dependencies":["setSearchQuery","setShowHistory","performSearch"]},"calls":["setSearchQuery","setShowHistory","setTimeout","performSearch"],"called_by":["search history items"],"related_files":[],"query_or_table_refs":[],"notes":"History replay: sets query from history, auto-triggers search with slight delay"}
{"file":"client/src/components/bible/SearchModal.tsx","lines":"350-360","symbol":"getRandomVerse","kind":"function","export":"internal","signature":"(): void","governs":{"ui":"none","state":"none","data":"none","routing":"navigates to random verse","side_effects":"random number generation, verse navigation, modal closure","auth":"none","errors":"none","dependencies":["verses","Math.random","onNavigateToVerse","onClose"]},"calls":["Math.floor","Math.random","onNavigateToVerse","onClose","console.log"],"called_by":["random verse button","handleKeyDown Ctrl+R"],"related_files":[],"query_or_table_refs":[],"notes":"Random verse selector: generates random index from verses array, navigates to selected verse"}
{"file":"client/src/lib/bibleSearchEngine.ts","lines":"100-201","symbol":"parseVerseReference","kind":"function","export":"named","signature":"(input: string): ParsedReference | null","governs":{"ui":"none","state":"none","data":"parses various Bible reference formats into structured data","routing":"none","side_effects":"none","auth":"none","errors":"returns null for unparseable references","dependencies":["ABBREVIATION_TO_BOOK","match","parseInt"]},"calls":["toLowerCase","trim","replace","match","parseInt"],"called_by":["BibleSearchEngine.search","SearchModal"],"related_files":["client/src/lib/verseReferenceParser.ts"],"query_or_table_refs":[],"notes":"Comprehensive reference parser: handles John 3:16, Gen.1:1, 1 Sam 1:1, chapter/book only, with confidence scoring and 66+ book abbreviations"}
{"file":"client/src/lib/bibleSearchEngine.ts","lines":"279-332","symbol":"BibleSearchEngine","kind":"class","export":"named","signature":"class with constructor(verses: any[])","governs":{"ui":"none","state":"none","data":"manages Bible search operations with intelligent ranking","routing":"none","side_effects":"verse map building, search execution","auth":"none","errors":"none","dependencies":["parseVerseReference","canonicalToReference"]},"calls":["buildVerseMap","searchByReference","searchByText","searchByTextAllTranslations","sort","slice"],"called_by":["SearchModal"],"related_files":[],"query_or_table_refs":[],"notes":"Main search engine: reference parsing priority, multi-translation support, intelligent ranking by confidence and verse order"}
{"file":"client/src/lib/bibleSearchEngine.ts","lines":"334-401","symbol":"searchByReference","kind":"function","export":"internal","signature":"(parsed: ParsedReference, translationCode: string): SearchResult[]","governs":{"ui":"none","state":"none","data":"searches verses by parsed reference with high confidence","routing":"none","side_effects":"none","auth":"none","errors":"none","dependencies":["canonicalToReference","verseMap","verses"]},"calls":["canonicalToReference","verseMap.get","push"],"called_by":["BibleSearchEngine.search"],"related_files":[],"query_or_table_refs":[],"notes":"Reference search: handles specific verses (Gen.1:1), verse ranges (Ps.23:1-3), chapters (Gen.1), and whole books with 0.98-0.7 confidence"}
{"file":"client/src/lib/bibleSearchEngine.ts","lines":"403-458","symbol":"searchByText","kind":"function","export":"internal","signature":"(query: string, translationCode: string, maxResults: number): SearchResult[]","governs":{"ui":"none","state":"none","data":"searches verse text content with scoring and highlighting","routing":"none","side_effects":"console logging","auth":"none","errors":"none","dependencies":["verses","toLowerCase","includes","replace","RegExp"]},"calls":["split","filter","forEach","toLowerCase","includes","replace","RegExp","push","slice"],"called_by":["BibleSearchEngine.search"],"related_files":[],"query_or_table_refs":[],"notes":"Text search: exact phrase (score 10), individual words (score 1), HTML highlighting with <mark> tags, max confidence 0.6"}
{"file":"client/src/components/bible/VirtualBibleTable.tsx","lines":"64-917","symbol":"VirtualBibleTable","kind":"react_component","export":"forwardRef","signature":"forwardRef<VirtualBibleTableHandle, VirtualBibleTableProps>","governs":{"ui":"renders virtualized Bible table with infinite scrolling and column management","state":"manages scroll state, drag state, and tooltip visibility","data":"coordinates data loading for visible verses, cross-refs, prophecies, and notes","routing":"none directly","side_effects":"DOM mutations, scroll handling, batch note loading, runtime error dismissal","auth":"integrates with user authentication for notes/highlights","errors":"handles mutation failures with toast notifications","dependencies":["useAnchorSlice","useRowData","useViewportLabels","useTranslationMaps","multiple column hooks"]},"calls":["useAuth","useToast","useBibleStore","useAnchorSlice","useRowData","useViewportLabels","useNotesCache","useTranslationMaps","forwardRef","useImperativeHandle","makeScrollToVerse","useMutation","apiRequest"],"called_by":["BiblePage","main application"],"related_files":["client/src/components/bible/VirtualRow.tsx","client/src/components/bible/NewColumnHeaders.tsx"],"query_or_table_refs":["notes","highlights","bookmarks"],"notes":"Core virtual table: 919 lines, anchor-centered scrolling, multi-column layout, real-time data loading, sophisticated scroll performance optimization"}
{"file":"client/src/components/bible/VirtualBibleTable.tsx","lines":"131-134","symbol":"getCurrentVerse","kind":"function","export":"internal","signature":"(): { reference: string; index: number }","governs":{"ui":"none","state":"none","data":"retrieves current anchor verse information","routing":"none","side_effects":"none","auth":"none","errors":"provides fallback verse","dependencies":["anchorIndex","verseKeys"]},"calls":[],"called_by":["parent components","useImperativeHandle"],"related_files":[],"query_or_table_refs":[],"notes":"Current verse tracker: returns anchor-based position with Gen.1:1 fallback"}
{"file":"client/src/components/bible/VirtualBibleTable.tsx","lines":"459-494","symbol":"scrollToVerse","kind":"function","export":"internal","signature":"(ref: string): void","governs":{"ui":"triggers verse highlighting animation","state":"updates scroll position","data":"none","routing":"none","side_effects":"DOM scroll manipulation, element highlighting, console logging","auth":"none","errors":"handles missing verses gracefully","dependencies":["containerRef","getVerseIndex","verseKeys","ROW_HEIGHT"]},"calls":["getVerseIndex","Math.round","Math.max","Math.min","setTimeout","document.querySelector","classList.add","classList.remove","console.log"],"called_by":["navigation system","useImperativeHandle","useVerseNav"],"related_files":["client/src/lib/verseIndexMap.ts"],"query_or_table_refs":[],"notes":"Instant navigation: O(1) verse lookup, precise centering, flash highlight animation, bounds checking"}
{"file":"client/src/components/bible/VirtualBibleTable.tsx","lines":"343-354","symbol":"noteMutation","kind":"react_mutation","export":"internal","signature":"useMutation for note creation","governs":{"ui":"none directly","state":"manages mutation state","data":"creates/updates verse notes","routing":"none","side_effects":"API requests, cache invalidation, toast notifications","auth":"none directly","errors":"handles API failures with user feedback","dependencies":["useMutation","apiRequest","useQueryClient","useToast"]},"calls":["useMutation","apiRequest","queryClient.invalidateQueries","toast"],"called_by":["note creation workflow"],"related_files":[],"query_or_table_refs":["notes"],"notes":"Note persistence: POST to /api/notes, cache invalidation, user feedback"}
{"file":"client/src/components/bible/VirtualBibleTable.tsx","lines":"356-367","symbol":"highlightMutation","kind":"react_mutation","export":"internal","signature":"useMutation for highlight creation","governs":{"ui":"none directly","state":"manages mutation state","data":"creates/updates verse highlights","routing":"none","side_effects":"API requests, cache invalidation, toast notifications","auth":"none directly","errors":"handles API failures with user feedback","dependencies":["useMutation","apiRequest","useQueryClient","useToast"]},"calls":["useMutation","apiRequest","queryClient.invalidateQueries","toast"],"called_by":["highlight creation workflow"],"related_files":[],"query_or_table_refs":["highlights"],"notes":"Highlight persistence: POST to /api/highlights with text and color, cache invalidation"}
{"file":"client/src/components/bible/VirtualRow.tsx","lines":"22-1056","symbol":"VirtualRow","kind":"react_component","export":"default","signature":"(props: VirtualRowProps): JSX.Element","governs":{"ui":"renders individual table row with multiple cell types","state":"none directly","data":"displays verse content across all columns","routing":"none","side_effects":"none","auth":"none","errors":"none","dependencies":["multiple cell components","useBibleStore","useTranslationMaps"]},"calls":["useBibleStore","useTranslationMaps","getVisibleColumns","ReferenceCell","MainTranslationCell","CrossReferencesCell","ProphecyCell","AlternateTranslationCell","NotesCell"],"called_by":["VirtualBibleTable"],"related_files":["client/src/components/bible/LabeledText.tsx","client/src/components/user/NotesCell.tsx"],"query_or_table_refs":[],"notes":"Row renderer: 1056 lines, handles all column types, integrates labeling system, responsive layout"}
{"file":"client/src/components/bible/VirtualRow.tsx","lines":"46-60","symbol":"ReferenceCell","kind":"react_component","export":"internal","signature":"(props: CellProps): JSX.Element","governs":{"ui":"renders verse reference column","state":"none","data":"displays verse reference","routing":"none","side_effects":"none","auth":"none","errors":"none","dependencies":["useIsMobile"]},"calls":["useIsMobile"],"called_by":["VirtualRow"],"related_files":[],"query_or_table_refs":[],"notes":"Reference display: mobile-responsive glass morphism styling, verse reference text"}
{"file":"client/src/components/bible/VirtualRow.tsx","lines":"62-178","symbol":"CrossReferencesCell","kind":"react_component","export":"internal","signature":"(props: CellProps): JSX.Element","governs":{"ui":"renders cross-reference links with verse text","state":"none","data":"displays cross-reference data from store","routing":"triggers navigation to cross-referenced verses","side_effects":"cross-reference navigation, event handling","auth":"none","errors":"none","dependencies":["useBibleStore","crossRefs store","LabeledText"]},"calls":["useBibleStore","handleCrossRefClick","renderTextWithLabels","LabeledText","stopPropagation","preventDefault"],"called_by":["VirtualRow"],"related_files":["client/src/components/bible/LabeledText.tsx"],"query_or_table_refs":[],"notes":"Cross-reference renderer: clickable refs with full verse text, label integration, touch-optimized navigation"}
{"file":"client/src/components/bible/VirtualRow.tsx","lines":"180-311","symbol":"ProphecyCell","kind":"react_component","export":"internal","signature":"(props: CellProps & { type: 'P' | 'F' | 'V' }): JSX.Element","governs":{"ui":"renders prophecy data with expandable interface","state":"manages prophecy collapse state","data":"displays prophecy predictions, fulfillments, and verifications","routing":"triggers navigation to prophecy verses","side_effects":"prophecy expansion/collapse, verse navigation","auth":"none","errors":"none","dependencies":["useBibleStore","prophecyData","prophecyIndex","LabeledText"]},"calls":["useBibleStore","toggleProphecyCollapse","renderTextWithLabels","LabeledText"],"called_by":["VirtualRow"],"related_files":["client/src/components/bible/LabeledText.tsx"],"query_or_table_refs":[],"notes":"Prophecy display: P/F/V columns, collapsible summaries, verse navigation, label integration for prophecy text"}
{"file":"client/src/App.tsx","lines":"73-947","symbol":"useBibleStore","kind":"zustand_store","export":"named","signature":"create<BibleStoreInterface>","governs":{"ui":"none directly","state":"manages all application state including translations, columns, preferences, and data loading","data":"coordinates all Bible data loading, cross-references, prophecies, and user preferences","routing":"none","side_effects":"dynamic imports, data loading, console logging, localStorage operations","auth":"none directly","errors":"handles data loading failures","dependencies":["zustand","BibleDataAPI imports"]},"calls":["create","dynamic imports","loadCrossRefsData","loadProphecyData","loadDatesData","console.log","set","get"],"called_by":["all components","hooks"],"related_files":["client/src/data/BibleDataAPI.ts"],"query_or_table_refs":[],"notes":"Main application store: 947 lines, manages translations, columns, cross-refs, prophecies, dates, labels, navigation state, and dynamic data loading"}
{"file":"client/src/App.tsx","lines":"214-259","symbol":"loadCrossRefsData","kind":"function","export":"internal","signature":"(verseIds?: string[]): Promise<void>","governs":{"ui":"none","state":"updates cross-references store","data":"loads cross-reference data for specified verses","routing":"none","side_effects":"dynamic import, data loading, console logging","auth":"none","errors":"handles loading failures with warnings","dependencies":["BibleDataAPI","getCrossReferences","crossRefs store"]},"calls":["import","getCrossReferences","set","console.log","console.warn","console.error"],"called_by":["toggleCrossRefs","on-demand loading"],"related_files":["client/src/data/BibleDataAPI.ts"],"query_or_table_refs":[],"notes":"Cross-ref loader: on-demand loading for visible verses, maintains dot format keys, handles failures gracefully"}
{"file":"client/src/App.tsx","lines":"261-282","symbol":"toggleCrossRefs","kind":"function","export":"internal","signature":"(): void","governs":{"ui":"none directly","state":"toggles cross-references visibility and updates column state","data":"triggers cross-reference data loading when enabled","routing":"none","side_effects":"data loading, column state updates, console logging","auth":"none","errors":"none","dependencies":["showCrossRefs","columnState","loadCrossRefsData"]},"calls":["set","get","loadCrossRefsData","setTimeout","console.log"],"called_by":["column header toggles","UI controls"],"related_files":[],"query_or_table_refs":[],"notes":"Cross-ref toggle: controls visibility, triggers data loading, updates column layout slot 7"}
{"file":"client/src/App.tsx","lines":"284-326","symbol":"toggleProphecies","kind":"function","export":"internal","signature":"(): void","governs":{"ui":"none directly","state":"toggles prophecy visibility and enables all P/F/V columns","data":"triggers prophecy data loading from Supabase files","routing":"none","side_effects":"dynamic import, prophecy data loading, column state updates","auth":"none","errors":"handles loading failures with empty data fallback","dependencies":["showProphecies","columnState","loadProphecyData"]},"calls":["set","import","loadProphecyData","setProphecyData","setProphecyIndex","console.log","console.error"],"called_by":["column header toggles","UI controls"],"related_files":["client/src/data/BibleDataAPI.ts"],"query_or_table_refs":[],"notes":"Prophecy toggle: loads prophecy_rows.json and prophecy_index.txt, enables slots 8-10, handles loading failures"}
{"file":"client/src/lib/queryClient.ts","lines":"10-35","symbol":"apiRequest","kind":"function","export":"named","signature":"(url: string, method: string, data?: unknown, userId?: string): Promise<Response>","governs":{"ui":"none","state":"none","data":"makes authenticated API requests","routing":"none","side_effects":"HTTP requests, credential handling","auth":"includes credentials in requests, optional user ID header","errors":"throws on non-OK responses","dependencies":["fetch","throwIfResNotOk"]},"calls":["fetch","JSON.stringify","throwIfResNotOk"],"called_by":["mutations","API operations"],"related_files":[],"query_or_table_refs":[],"notes":"Core API client: handles JSON serialization, credentials, user ID headers, and error checking"}
{"file":"client/src/lib/queryClient.ts","lines":"55-68","symbol":"queryClient","kind":"query_client","export":"named","signature":"new QueryClient","governs":{"ui":"none","state":"manages TanStack Query cache and configuration","data":"handles all query caching and fetching behavior","routing":"none","side_effects":"HTTP requests, cache management","auth":"integrates authentication via getQueryFn","errors":"configures error handling and retry behavior","dependencies":["QueryClient","getQueryFn"]},"calls":["QueryClient","getQueryFn"],"called_by":["App.tsx QueryClientProvider","all components using queries"],"related_files":[],"query_or_table_refs":[],"notes":"Query client config: infinite stale time, no refetch, no retry, 401 handling, credentials included"}
{"file":"client/src/data/BibleDataAPI.ts","lines":"24-32","symbol":"fetchFromStorage","kind":"function","export":"named","signature":"(path: string): Promise<string>","governs":{"ui":"none","state":"none","data":"fetches files from Supabase storage bucket","routing":"none","side_effects":"Supabase storage API calls","auth":"uses Supabase authentication","errors":"throws on storage errors","dependencies":["supabase","storage API"]},"calls":["supabase.storage.from.download"],"called_by":["all data loading functions"],"related_files":["client/src/lib/supabaseClient.ts"],"query_or_table_refs":[],"notes":"Storage interface: downloads from 'anointed' bucket, converts to text, central error handling"}
{"file":"client/src/data/BibleDataAPI.ts","lines":"81-113","symbol":"loadTranslation","kind":"function","export":"named","signature":"(id: string): Promise<Map<string, string>>","governs":{"ui":"none","state":"none","data":"loads Bible translation text with caching","routing":"none","side_effects":"storage downloads, master cache updates, console logging","auth":"none directly","errors":"none","dependencies":["masterCache","fetchFromStorage","parseRegex"]},"calls":["masterCache.has","masterCache.get","masterCache.set","fetchFromStorage","split","match","console.log"],"called_by":["translation loading system","search system"],"related_files":[],"query_or_table_refs":[],"notes":"Translation loader: immediate cache return, regex parsing, 31k+ verses per translation, permanent caching"}
{"file":"client/src/data/BibleDataAPI.ts","lines":"121-153","symbol":"loadVerseKeys","kind":"function","export":"named","signature":"(chronological?: boolean): Promise<string[]>","governs":{"ui":"none","state":"none","data":"loads verse key arrays for canonical or chronological order","routing":"none","side_effects":"storage downloads, caching, console logging","auth":"none","errors":"falls back to canonical if chronological fails","dependencies":["getOrFetch","fetchFromStorage","JSON.parse"]},"calls":["getOrFetch","fetchFromStorage","JSON.parse","console.log","console.warn"],"called_by":["verse navigation system","store initialization"],"related_files":[],"query_or_table_refs":[],"notes":"Verse keys loader: 31k+ verse array, chronological fallback to canonical, master index for navigation"}
{"file":"client/src/data/BibleDataAPI.ts","lines":"256-295","symbol":"searchVerses","kind":"function","export":"named","signature":"(query: string, translationId?: string): Promise<SearchResult[]>","governs":{"ui":"none","state":"none","data":"searches Bible text content across verses","routing":"none","side_effects":"translation loading","auth":"none","errors":"none","dependencies":["loadTranslation","loadVerseKeys","Math.random"]},"calls":["loadTranslation","loadVerseKeys","toLowerCase","includes","Math.floor","Math.random","findIndex"],"called_by":["search system","random verse feature"],"related_files":[],"query_or_table_refs":[],"notes":"Text search: supports '%' for random verse, case-insensitive matching, 100 result limit, includes verse indices"}
{"file":"client/src/contexts/AuthContext.tsx","lines":"19-113","symbol":"AuthProvider","kind":"react_context","export":"named","signature":"React.FC<{ children: React.ReactNode }>","governs":{"ui":"none directly","state":"manages global authentication state and profile data","data":"coordinates user session and profile loading","routing":"none","side_effects":"URL parameter handling, magic link processing, auth state changes, cross-domain cookie sharing","auth":"provides authentication context to entire application","errors":"none","dependencies":["supabase","useMyProfile","onAuthStateChange"]},"calls":["useState","useEffect","useMyProfile","supabase.auth.getSession","supabase.auth.onAuthStateChange","supabase.auth.signOut","window.history.replaceState","document.cookie","CustomEvent"],"called_by":["App.tsx","all components via useAuth"],"related_files":["client/src/hooks/useMyProfile.ts","client/src/lib/supabaseClient.ts"],"query_or_table_refs":[],"notes":"Auth provider: magic link handling, session management, cross-domain cookie sharing for *.anointed.io, profile integration"}
{"file":"client/src/contexts/AuthContext.tsx","lines":"30-80","symbol":"initializeAuth","kind":"function","export":"internal","signature":"(): Promise<void>","governs":{"ui":"none","state":"initializes authentication state","data":"loads existing session and handles magic link flow","routing":"handles URL parameter cleanup","side_effects":"URL manipulation, custom event dispatch, session loading","auth":"establishes initial auth state","errors":"none","dependencies":["URLSearchParams","supabase.auth.getSession","window.history","CustomEvent"]},"calls":["URLSearchParams","supabase.auth.getSession","setSession","setUser","setAuthReady","window.history.replaceState","setTimeout","CustomEvent","window.dispatchEvent"],"called_by":["AuthProvider useEffect"],"related_files":[],"query_or_table_refs":[],"notes":"Auth initializer: magic link detection, session restoration, URL cleanup, success event dispatch"}
{"file":"client/src/pages/bible.tsx","lines":"28-467","symbol":"BiblePage","kind":"react_component","export":"default","signature":"(): JSX.Element","governs":{"ui":"renders main Bible study interface","state":"manages modals, overlays, selected verses, and navigation state","data":"coordinates Bible data loading and verse navigation","routing":"none directly","side_effects":"localStorage operations, event listeners, console logging","auth":"integrates with authentication for user-specific features","errors":"handles verse navigation failures","dependencies":["useBibleStore","useAuth","useBibleData","useVerseNav","multiple hooks"]},"calls":["useState","useEffect","useCallback","useRef","useBibleStore","useAuth","useBibleData","useVerseNav","useTranslationMaps","useReadingState","useHashParams","useBodyClass","useAdaptiveScaling","useLoadingDetection"],"called_by":["App.tsx routing"],"related_files":["client/src/components/bible/VirtualBibleTable.tsx","client/src/components/bible/TopHeader.tsx","client/src/components/bible/SearchModal.tsx"],"query_or_table_refs":[],"notes":"Main page: 467 lines, orchestrates Bible study interface, handles all modals and navigation, integrates data loading with UI"}
{"file":"client/src/pages/bible.tsx","lines":"105-108","symbol":"scrollToVerse","kind":"function","export":"internal","signature":"(ref: string): void","governs":{"ui":"none","state":"none","data":"none","routing":"delegates to VirtualBibleTable scroll function","side_effects":"console logging, table scrolling","auth":"none","errors":"none","dependencies":["tableRef","VirtualBibleTable.scrollToVerse"]},"calls":["tableRef.current?.scrollToVerse","console.log"],"called_by":["useVerseNav","navigation system"],"related_files":["client/src/components/bible/VirtualBibleTable.tsx"],"query_or_table_refs":[],"notes":"Navigation dispatcher: delegates to VirtualBibleTable's optimized scroll implementation"}
{"file":"client/src/pages/bible.tsx","lines":"158-206","symbol":"handleNavigateToVerse","kind":"function","export":"internal","signature":"(reference: string): void","governs":{"ui":"none","state":"none","data":"none","routing":"performs verse navigation with robust reference matching","side_effects":"console logging, verse navigation","auth":"none","errors":"handles missing verses with warnings","dependencies":["allVerses","goTo","normalizeReference"]},"calls":["normalizeReference","find","match","parseInt","goTo","console.log","console.warn"],"called_by":["Strong's overlay","cross-reference navigation"],"related_files":[],"query_or_table_refs":[],"notes":"Verse navigator: robust reference matching (space/dot formats), book/chapter/verse parsing, fallback handling"}
{"file":"client/src/lib/supabaseClient.ts","lines":"34-81","symbol":"LRUCache","kind":"class","export":"internal","signature":"class with get, set, has methods","governs":{"ui":"none","state":"none","data":"manages memory-efficient caching with LRU eviction","routing":"none","side_effects":"console logging for cache operations","auth":"none","errors":"none","dependencies":["Map","Date.now"]},"calls":["Map","forEach","delete","set","has","get","Date.now","console.log"],"called_by":["masterCache instance"],"related_files":[],"query_or_table_refs":[],"notes":"Memory cache: 12 translation limit, LRU eviction by timestamp, access count tracking, automatic cleanup"}
{"file":"client/src/lib/supabaseClient.ts","lines":"90-116","symbol":"loadVerseKeys","kind":"function","export":"named","signature":"(): Promise<string[]>","governs":{"ui":"none","state":"none","data":"loads canonical verse keys from Supabase storage","routing":"none","side_effects":"Supabase storage access, caching, console logging","auth":"uses Supabase authentication","errors":"throws on storage or parsing errors","dependencies":["supabase","storage API","JSON.parse","verseKeysCache"]},"calls":["supabase.storage.from.download","data.text","JSON.parse","console.log","console.error"],"called_by":["verse navigation system","initialization"],"related_files":["client/src/data/BibleDataAPI.ts"],"query_or_table_refs":[],"notes":"Verse keys loader: singleton cache, 31k+ verse references, canonical order from Supabase 'anointed' bucket"}
{"file":"client/src/lib/supabaseClient.ts","lines":"119-167","symbol":"loadTranslationSecure","kind":"function","export":"named","signature":"(translationId: string): Promise<Map<string, string>>","governs":{"ui":"none","state":"none","data":"loads Bible translations with secure signed URLs and LRU caching","routing":"none","side_effects":"Supabase storage access, HTTP requests, master cache updates","auth":"uses Supabase authentication for signed URLs","errors":"throws on storage, HTTP, or parsing errors","dependencies":["masterCache","supabase","createSignedUrl","fetch"]},"calls":["masterCache.has","masterCache.get","supabase.storage.from.createSignedUrl","fetch","response.text","split","masterCache.set","console.log","console.error"],"called_by":["translation loading system"],"related_files":[],"query_or_table_refs":[],"notes":"Secure translation loader: signed URLs for private bucket access, verse-by-verse parsing, permanent LRU caching"}
{"file":"client/src/lib/supabaseClient.ts","lines":"170-183","symbol":"signInWithMagicLink","kind":"function","export":"named","signature":"(email: string, displayName?: string): Promise<{ data: any, error: any }>","governs":{"ui":"none","state":"none","data":"none","routing":"none","side_effects":"Supabase auth operations","auth":"initiates magic link authentication flow","errors":"returns Supabase auth errors","dependencies":["supabase","signInWithOtp","window.location.origin"]},"calls":["supabase.auth.signInWithOtp","window.location.origin"],"called_by":["authentication forms","sign-in workflow"],"related_files":["client/src/contexts/AuthContext.tsx"],"query_or_table_refs":[],"notes":"Magic link auth: dynamic redirect URL generation, optional display name, email OTP with callback support"}
{"file":"client/src/components/bible/NewColumnHeaders.tsx","lines":"52-535","symbol":"NewColumnHeaders","kind":"react_component","export":"named","signature":"(props: NewColumnHeadersProps): JSX.Element | null","governs":{"ui":"renders column headers with responsive width calculation and drag-and-drop reordering","state":"manages presentation mode, column ordering, drag states","data":"none directly","routing":"none","side_effects":"CSS custom property manipulation, console logging, dynamic imports","auth":"none","errors":"handles import failures with fallbacks","dependencies":["useBibleStore","useTranslationMaps","useAdaptivePortraitColumns","dnd-kit"]},"calls":["useState","useEffect","useCallback","useRef","useMemo","useBibleStore","useTranslationMaps","useAdaptivePortraitColumns","import","getComputedStyle","document.documentElement.style.setProperty"],"called_by":["VirtualBibleTable"],"related_files":["client/src/hooks/useAdaptivePortraitColumns.ts","client/src/hooks/useColumnChangeSignal.ts"],"query_or_table_refs":[],"notes":"Column headers: 535 lines, drag-and-drop reordering, presentation mode (2x width), responsive CSS calc() widths, dynamic imports"}
{"file":"client/src/components/bible/NewColumnHeaders.tsx","lines":"143-177","symbol":"togglePresentationMode","kind":"function","export":"internal","signature":"(): Promise<void>","governs":{"ui":"none","state":"toggles presentation mode state","data":"none","routing":"none","side_effects":"CSS custom property updates for layout scaling, console logging, column change signals","auth":"none","errors":"handles signal emission failures","dependencies":["document.documentElement","useColumnChangeEmitter","async import"]},"calls":["document.documentElement.style.setProperty","setIsPresentationMode","console.log","import","useColumnChangeEmitter"],"called_by":["presentation mode button click"],"related_files":["client/src/hooks/useColumnChangeSignal.ts"],"query_or_table_refs":[],"notes":"Presentation mode: width x2, text x1.5, row height x1.35, emits column change signals, async import fallback"}
{"file":"client/src/components/bible/NewColumnHeaders.tsx","lines":"198-222","symbol":"getResponsiveWidth","kind":"function","export":"internal","signature":"(columnType: string): string","governs":{"ui":"none","state":"none","data":"none","routing":"none","side_effects":"none","auth":"none","errors":"none","dependencies":["window.innerHeight","window.innerWidth","CSS calc expressions"]},"calls":["window.innerHeight","window.innerWidth"],"called_by":["columns useMemo","column width calculations"],"related_files":[],"query_or_table_refs":[],"notes":"Responsive widths: portrait/landscape detection, CSS calc() with --column-width-mult variable, all column types supported"}
{"file":"client/src/lib/verseKeysLoader.ts","lines":"19-124","symbol":"loadVerseKeysCanonical","kind":"function","export":"named","signature":"(): Promise<string[]>","governs":{"ui":"none","state":"none","data":"loads canonical verse keys as master row index","routing":"none","side_effects":"caching, console logging, Supabase storage access","auth":"none","errors":"falls back to generated keys on failure","dependencies":["loadVerseKeys","BibleDataAPI","cachedCanonicalKeys"]},"calls":["loadVerseKeys","console.log","console.error","push"],"called_by":["verse navigation system","store initialization"],"related_files":["client/src/data/BibleDataAPI.ts"],"query_or_table_refs":[],"notes":"Master verse loader: 31k+ keys, canonical order, fallback generation with 66 books, foundation for all other data"}
{"file":"client/src/lib/verseKeysLoader.ts","lines":"130-154","symbol":"createVerseObjectsFromKeys","kind":"function","export":"named","signature":"(verseKeys: string[]): BibleVerse[]","governs":{"ui":"none","state":"none","data":"creates verse object skeleton from master key index","routing":"none","side_effects":"console logging","auth":"none","errors":"none","dependencies":["BibleVerse type","map","split","parseInt"]},"calls":["map","split","parseInt","toLowerCase","console.log"],"called_by":["verse data initialization"],"related_files":["client/src/types/bible.ts"],"query_or_table_refs":[],"notes":"Verse skeleton creator: maps keys to BibleVerse objects, empty text containers, preserves dot format references"}
{"file":"client/src/lib/verseKeysLoader.ts","lines":"167-191","symbol":"getVerseKeys","kind":"function","export":"named","signature":"(): string[]","governs":{"ui":"none","state":"none","data":"gets current verse keys from store or cache","routing":"none","side_effects":"console logging, store access","auth":"none","errors":"handles store access failures","dependencies":["window._appModule","useBibleStore","cached keys"]},"calls":["useBibleStore.getState","console.warn"],"called_by":["VirtualBibleTable","navigation system"],"related_files":["client/src/App.tsx"],"query_or_table_refs":[],"notes":"Verse keys accessor: tries store first, falls back to cache based on chronological state, handles missing keys"}
{"file":"client/src/workers/strongsWorker.ts","lines":"31-67","symbol":"onmessage","kind":"web_worker_handler","export":"internal","signature":"(event: MessageEvent<StrongsWorkerMessage>): Promise<void>","governs":{"ui":"none","state":"none","data":"processes Strong's concordance data off main thread","routing":"none","side_effects":"HTTP requests for range data, postMessage responses","auth":"none","errors":"handles fetch and parsing errors","dependencies":["fetchVerseStrongsData","fetchLemmaData","postMessage"]},"calls":["postMessage","fetchVerseStrongsData","fetchLemmaData","switch"],"called_by":["main thread Strong's operations"],"related_files":[],"query_or_table_refs":[],"notes":"Worker handler: INIT/VERSE/LEMMA message types, byte range requests, error handling with postMessage"}
{"file":"client/src/workers/strongsWorker.ts","lines":"70-91","symbol":"fetchVerseStrongsData","kind":"function","export":"internal","signature":"(verseKey: string): Promise<StrongsVerseData>","governs":{"ui":"none","state":"none","data":"fetches Strong's word data for specific verse using byte ranges","routing":"none","side_effects":"HTTP range requests to Supabase Storage","auth":"none","errors":"throws on fetch failures","dependencies":["strongsVerseOffsets","fetch","parseVerseStrongsData"]},"calls":["fetch","response.text","parseVerseStrongsData","Error"],"called_by":["worker message handler"],"related_files":[],"query_or_table_refs":[],"notes":"Strong's verse fetcher: byte range requests, offset-based data retrieval, parses verse word analysis"}
{"file":"client/src/workers/strongsWorker.ts","lines":"94-117","symbol":"parseVerseStrongsData","kind":"function","export":"internal","signature":"(verseKey: string, rawData: string): StrongsVerseData","governs":{"ui":"none","state":"none","data":"parses Strong's word data from pipe-delimited format","routing":"none","side_effects":"none","auth":"none","errors":"none","dependencies":["split","string manipulation"]},"calls":["trim","split","includes","push"],"called_by":["fetchVerseStrongsData"],"related_files":[],"query_or_table_refs":[],"notes":"Strong's parser: pipe-delimited format (word|transliteration|H1234|definition), builds StrongsWordData array"}
{"file":"client/src/workers/strongsWorker.ts","lines":"120-143","symbol":"fetchLemmaData","kind":"function","export":"internal","signature":"(strongsId: string): Promise<string[]>","governs":{"ui":"none","state":"none","data":"fetches verse list for specific Strong's number using byte ranges","routing":"none","side_effects":"HTTP range requests to Strong's index","auth":"none","errors":"throws on fetch failures","dependencies":["strongsIndexOffsets","fetch"]},"calls":["fetch","response.text","trim","split","filter"],"called_by":["worker message handler"],"related_files":[],"query_or_table_refs":[],"notes":"Strong's lemma fetcher: byte range requests for verse lists, parses newline-separated verse references"}
{"file":"client/src/components/bible/ColumnNavigationArrows.tsx","lines":"13-178","symbol":"ColumnNavigationArrows","kind":"react_component","export":"named","signature":"(props: ColumnNavigationArrowsProps): JSX.Element | null","governs":{"ui":"renders left/right arrow buttons for horizontal column navigation","state":"manages visible range state and scroller instance","data":"none directly","routing":"none","side_effects":"scroll event listeners, DOM element access","auth":"none","errors":"handles missing scroller gracefully","dependencies":["useBibleStore","buildActiveColumns","makeColumnScroller"]},"calls":["useMemo","useState","useEffect","useBibleStore","buildActiveColumns","makeColumnScroller","addEventListener","removeEventListener","getVisibleRange","left","right","destroy"],"called_by":["TopHeader or parent components"],"related_files":["client/src/utils/scrollNav.ts","client/src/App.tsx"],"query_or_table_refs":[],"notes":"Column navigation: left/right arrows with disable states, visible range indicator (start-end/total), scroller cleanup on unmount"}
{"file":"client/src/utils/scrollNav.ts","lines":"31-98","symbol":"makeColumnScroller","kind":"function","export":"named","signature":"(opts: ScrollNavOpts): { left, right, getVisibleRange, destroy }","governs":{"ui":"none","state":"none","data":"none","routing":"none","side_effects":"scroll event listeners, DOM measurements, smooth scrolling","auth":"none","errors":"handles missing DOM elements","dependencies":["getStickyLeftPx","measureLefts","scroll events"]},"calls":["addEventListener","removeEventListener","querySelector","getBoundingClientRect","scrollTo","Math.max","Math.min","Math.round"],"called_by":["ColumnNavigationArrows"],"related_files":["client/src/components/bible/ColumnNavigationArrows.tsx"],"query_or_table_refs":[],"notes":"Column scroller: sticky-aware navigation, smooth scrolling, header sync, visible range detection, cleanup on destroy"}
{"file":"client/src/utils/scrollNav.ts","lines":"9-14","symbol":"getStickyLeftPx","kind":"function","export":"internal","signature":"(headerEl: HTMLElement): number","governs":{"ui":"none","state":"none","data":"none","routing":"none","side_effects":"DOM measurements","auth":"none","errors":"none","dependencies":["querySelector","getBoundingClientRect"]},"calls":["querySelector","getBoundingClientRect"],"called_by":["makeColumnScroller"],"related_files":[],"query_or_table_refs":[],"notes":"Sticky width calculator: measures index + reference column widths for scroll offset calculations"}
{"file":"client/src/utils/scrollNav.ts","lines":"16-29","symbol":"measureLefts","kind":"function","export":"internal","signature":"(headerEl: HTMLElement, keys: string[], stickyLeft: number): Array<{key, left, width, ok}>","governs":{"ui":"none","state":"none","data":"none","routing":"none","side_effects":"DOM measurements, console logging","auth":"none","errors":"handles missing columns gracefully","dependencies":["querySelector","getBoundingClientRect"]},"calls":["map","querySelector","getBoundingClientRect","Math.max","console.log"],"called_by":["makeColumnScroller"],"related_files":[],"query_or_table_refs":[],"notes":"Column measurements: maps column keys to positions, handles missing elements, calculates relative positions from sticky columns"}
{"file":"client/src/lib/utils.ts","lines":"4-6","symbol":"cn","kind":"function","export":"named","signature":"(...inputs: ClassValue[]): string","governs":{"ui":"none","state":"none","data":"none","routing":"none","side_effects":"none","auth":"none","errors":"none","dependencies":["clsx","twMerge"]},"calls":["twMerge","clsx"],"called_by":["all components using className utilities"],"related_files":[],"query_or_table_refs":[],"notes":"CSS utility: merges and deduplicates Tailwind classes using clsx and tailwind-merge"}
{"file":"client/src/store/translationSlice.ts","lines":"26-92","symbol":"useTranslationMaps","kind":"zustand_store","export":"named","signature":"create<TranslationState>","governs":{"ui":"none directly","state":"manages main and alternate translation selection","data":"none","routing":"none","side_effects":"localStorage persistence, custom events for slot visibility","auth":"none","errors":"none","dependencies":["zustand","persist middleware","CustomEvent"]},"calls":["create","persist","get","set","filter","findIndex","window.dispatchEvent","CustomEvent","console.log","console.error"],"called_by":["all components using translation state"],"related_files":["client/src/App.tsx"],"query_or_table_refs":[],"notes":"Translation store: main/alternate selection, slot visibility events, mobile defaults, localStorage persistence"}
{"file":"client/src/store/translationSlice.ts","lines":"31-39","symbol":"setMain","kind":"store_action","export":"internal","signature":"(id: string): void","governs":{"ui":"none","state":"updates main translation and removes from alternates","data":"none","routing":"none","side_effects":"none","auth":"none","errors":"none","dependencies":["store.get","store.set","filter"]},"calls":["get","set","filter"],"called_by":["translation selection UI"],"related_files":[],"query_or_table_refs":[],"notes":"Main translation setter: prevents duplicate selection, removes new main from alternates list"}
{"file":"client/src/store/translationSlice.ts","lines":"40-80","symbol":"toggleAlternate","kind":"store_action","export":"internal","signature":"(id: string): void","governs":{"ui":"none","state":"toggles alternate translation visibility","data":"none","routing":"none","side_effects":"dispatches custom events for slot visibility","auth":"none","errors":"handles invalid slots","dependencies":["store.get","store.set","getSlotForAlternateIndex","CustomEvent"]},"calls":["get","set","filter","findIndex","getSlotForAlternateIndex","window.dispatchEvent","CustomEvent","console.log","console.error"],"called_by":["translation toggle UI"],"related_files":[],"query_or_table_refs":[],"notes":"Alternate toggle: adds/removes from list, dispatches slot visibility events, handles 8 slot limit"}
{"file":"client/src/store/translationSlice.ts","lines":"95-98","symbol":"useColumnKeys","kind":"hook","export":"named","signature":"(): string[]","governs":{"ui":"none","state":"none","data":"none","routing":"none","side_effects":"none","auth":"none","errors":"none","dependencies":["useTranslationMaps"]},"calls":["useTranslationMaps"],"called_by":["column management components"],"related_files":[],"query_or_table_refs":[],"notes":"Column keys selector: returns [main, ...alternates] array for column ordering"}
{"file":"client/src/types/bible.ts","lines":"1-122","symbol":"TYPE_DEFINITIONS","kind":"type_definitions","export":"named","signature":"TypeScript interfaces for Bible data structures","governs":{"ui":"none","state":"none","data":"defines core data structures for Bible verses, translations, user data, and application state","routing":"none","side_effects":"none","auth":"none","errors":"none","dependencies":["TypeScript"]},"calls":[],"called_by":["all components and functions using Bible data"],"related_files":["shared/schema.ts"],"query_or_table_refs":[],"notes":"Core types: BibleVerse, CrossReference, StrongsWord, ProphecyData, Translation, UserNote, Bookmark, Highlight, AppPreferences"}
{"file":"shared/schema.ts","lines":"1-168","symbol":"DATABASE_SCHEMA","kind":"drizzle_schema","export":"named","signature":"Drizzle ORM database schema definitions","governs":{"ui":"none","state":"none","data":"defines all database tables, relationships, and validation schemas","routing":"none","side_effects":"none","auth":"includes user authentication and authorization structures","errors":"none","dependencies":["drizzle-orm","zod"]},"calls":["pgTable","createInsertSchema","z.infer"],"called_by":["database operations","type checking"],"related_files":["client/src/types/bible.ts"],"query_or_table_refs":["users","profiles","notes","bookmarks","userBookmarks","highlights","userHighlights","forumPosts","forumVotes","userPreferences","navigationHistory","userSessions"],"notes":"Complete schema: user management, Bible annotations, forum features, preferences, session tracking with RLS policies"}
{"file":"migration.sql","lines":"80-100","symbol":"RLS_POLICIES","kind":"sql_function","export":"internal","signature":"CREATE POLICY statements","governs":{"ui":"none","state":"none","data":"enforces row-level security for user data isolation","routing":"none","side_effects":"database security enforcement","auth":"enforces user data access control","errors":"none","dependencies":["PostgreSQL RLS"]},"calls":["auth.uid()"],"called_by":["database security system"],"related_files":[],"query_or_table_refs":["user_bookmarks","user_notes","user_highlights","navigation_history","user_sessions"],"notes":"Row-level security policies ensuring users can only access their own data"}
{"file":"migration-username-function.sql","lines":"4-17","symbol":"username_available","kind":"sql_function","export":"named","signature":"(u text) RETURNS boolean","governs":{"ui":"none","state":"none","data":"checks if username is available in profiles table","routing":"none","side_effects":"database query for username validation","auth":"requires authenticated user to execute","errors":"returns false for invalid usernames","dependencies":["PostgreSQL","profiles table"]},"calls":["EXISTS","SELECT"],"called_by":["server/routes/auth.ts signup endpoint"],"related_files":["server/routes/auth.ts"],"query_or_table_refs":["profiles.username"],"notes":"SQL function for real-time username availability checking"}
{"file":"migration-username-function.sql","lines":"29-41","symbol":"handle_new_user","kind":"sql_function","export":"internal","signature":"() RETURNS trigger","governs":{"ui":"none","state":"none","data":"creates profile record when new user signs up","routing":"none","side_effects":"inserts into profiles table on user creation","auth":"triggered by auth.users INSERT","errors":"none","dependencies":["PostgreSQL triggers"]},"calls":["INSERT INTO profiles"],"called_by":["on_auth_user_created trigger"],"related_files":["shared/schema.ts"],"query_or_table_refs":["profiles","auth.users"],"notes":"Database trigger for automatic profile creation on user signup"}
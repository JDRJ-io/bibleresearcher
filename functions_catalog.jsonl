{"file":"client/src/App.tsx","lines":"73-946","symbol":"useBibleStore","kind":"react_hook","export":"named","signature":"create<BibleStoreInterface>((set, get) => ({ ... }))","governs":{"ui":"manages all Bible interface state including column visibility, search modals, theme switching","state":"central Zustand store: translations, prophecies, cross-refs, notes, bookmarks, column layout, size controls","data":"loads/caches Bible data from Supabase storage: translations, cross-refs, prophecy data, dates, labels","routing":"none","side_effects":"triggers data loading when features toggled, manages event emissions for UI updates","auth":"integrates with user session for personalized data","errors":"handles data loading failures with fallbacks and error logging","dependencies":["zustand","@/data/BibleDataAPI","@/lib/labelBits"]},"calls":["loadCrossRefsData","loadProphecyData","loadDatesData","getContextGroups","buildActiveColumns","getVisibleSlice"],"called_by":["App","BiblePage","NewColumnHeaders","VirtualRow","all Bible components"],"related_files":["client/src/data/BibleDataAPI.ts","client/src/hooks/useColumnData.ts"],"query_or_table_refs":[],"notes":"Central state management hub for entire Bible study application; controls 20-column layout system"}
{"file":"client/src/App.tsx","lines":"947-969","symbol":"App","kind":"component","export":"default","signature":"() => JSX.Element","governs":{"ui":"renders main application shell with routing, providers, background, toast notifications","state":"none directly - delegates to providers","data":"none directly - delegates to providers","routing":"uses wouter for client-side routing between pages (bible, auth, profile, etc.)","side_effects":"imports preloader for immediate Bible data loading","auth":"wraps app in AuthProvider for authentication context","errors":"none directly - handled by child components","dependencies":["wouter","@tanstack/react-query","@/lib/queryClient","@/components/ui/toaster"]},"calls":["Switch","Route","QueryClientProvider","TooltipProvider","ThemeProvider","AuthProvider","HighlightProvider","DynamicBackground"],"called_by":["main.tsx"],"related_files":["client/src/main.tsx","client/src/lib/preloader.ts"],"query_or_table_refs":[],"notes":"Main application component providing routing and context providers"}
{"file":"client/src/hooks/useResponsiveColumns.ts","lines":"29-147","symbol":"useResponsiveColumns","kind":"react_hook","export":"named","signature":"(): ResponsiveColumnConfig","governs":{"ui":"calculates responsive column widths and alignment based on screen size and orientation","state":"manages window dimensions state and responsive configuration","data":"none","routing":"none","side_effects":"listens to window resize events for responsive updates","auth":"none","errors":"none","dependencies":["react"]},"calls":["useState","useEffect","useMemo"],"called_by":["VirtualRow","NewColumnHeaders","BiblePage"],"related_files":["client/src/components/bible/VirtualRow.tsx"],"query_or_table_refs":[],"notes":"Core responsive design system for Bible column layout; calculates optimal widths for portrait/landscape modes"}
{"file":"client/src/data/BibleDataAPI.ts","lines":"24-42","symbol":"fetchFromStorage","kind":"function","export":"named","signature":"(path: string): Promise<string>","governs":{"ui":"none","state":"none","data":"downloads text files from Supabase 'anointed' storage bucket","routing":"none","side_effects":"network requests to Supabase storage","auth":"none directly - relies on Supabase auth","errors":"throws Error if download fails","dependencies":["@/lib/supabaseClient"]},"calls":["supabase.storage.from().download()"],"called_by":["loadTranslation","loadVerseKeys","loadProphecyData","getLabelsData","getDatesCanonical"],"related_files":["client/src/lib/supabaseClient.ts"],"query_or_table_refs":["supabase.storage.anointed"],"notes":"Core data loading function for all Bible content from Supabase Storage"}
{"file":"client/src/data/BibleDataAPI.ts","lines":"81-113","symbol":"loadTranslation","kind":"function","export":"named","signature":"(id: string): Promise<Map<string, string>>","governs":{"ui":"none","state":"caches translation data in masterCache for instant access","data":"loads Bible translation text files, parses verse format (reference#text)","routing":"none","side_effects":"caches parsed translation data, logs loading progress","auth":"none","errors":"none explicitly - relies on fetchFromStorage error handling","dependencies":["@/lib/supabaseClient"]},"calls":["fetchFromStorage","masterCache.set"],"called_by":["useBibleStore","BibleDataAPI.searchVerses","preloader"],"related_files":["client/src/lib/supabaseClient.ts","client/src/lib/preloader.ts"],"query_or_table_refs":["supabase.storage.anointed/translations/"],"notes":"Primary Bible text loader with aggressive caching; supports KJV, AMP, CSB, etc."}
{"file":"client/src/data/BibleDataAPI.ts","lines":"367-437","symbol":"getCrossRefsBatch","kind":"function","export":"named","signature":"(verseIds: string[], cfSet?: 'cf1' | 'cf2'): Promise<Record<string, string[]>>","governs":{"ui":"none","state":"none","data":"loads cross-reference data using optimized HTTP Range requests for batch verse loading","routing":"none","side_effects":"network requests with HTTP 206 Partial Content, logs optimization metrics","auth":"none","errors":"returns empty object on failure, logs errors","dependencies":["@/lib/supabaseClient"]},"calls":["getCfOffsets","fetchSlice","supabase.storage.download()"],"called_by":["getCrossReferences","useBibleStore.loadCrossRefsData","cross-reference system"],"related_files":["client/src/hooks/useCrossRefLoader.ts"],"query_or_table_refs":["supabase.storage.anointed/references/"],"notes":"Expert-optimized cross-reference loader using HTTP Range requests; handles 29k+ verses efficiently"}
{"file":"client/src/data/BibleDataAPI.ts","lines":"498-568","symbol":"loadProphecyData","kind":"function","export":"named","signature":"(): Promise<{verseRoles: Record<string, {P: number[], F: number[], V: number[]}>, prophecyIndex: Record<number, {summary: string, prophecy: string[], fulfillment: string[], verification: string[]}>}>","governs":{"ui":"none","state":"none","data":"loads prophecy system data from Supabase: verse roles (P/F/V) and prophecy definitions","routing":"none","side_effects":"parses complex prophecy format, logs loading progress","auth":"none","errors":"returns empty objects on failure, logs errors","dependencies":["@/data/BibleDataAPI"]},"calls":["loadProphecyRows","loadProphecyIndex"],"called_by":["useBibleStore.toggleProphecies","prophecy system"],"related_files":["client/src/lib/prophecyCache.ts"],"query_or_table_refs":["supabase.storage.anointed/references/prophecy_rows.json","supabase.storage.anointed/references/prophecy_index.txt"],"notes":"Loads Bible prophecy system linking predictions, fulfillments, and verification verses"}
{"file":"server/index.ts","lines":"14-45","symbol":"server","kind":"function","export":"internal","signature":"Express application setup","governs":{"ui":"none","state":"none","data":"none directly","routing":"Express server with /api routes for storage, users, auth, profile, Stripe","side_effects":"starts HTTP server on PORT 3001, serves static files","auth":"delegates to auth routes","errors":"none explicitly","dependencies":["express","cors","./routes/*"]},"calls":["app.use","app.listen","registerStripeRoutes"],"called_by":["main execution"],"related_files":["server/routes/auth.ts","server/routes/users.ts","server/routes/stripe.ts"],"query_or_table_refs":[],"notes":"Main Express server providing API endpoints for the Bible study application"}
{"file":"server/routes/auth.ts","lines":"19-37","symbol":"username-available","kind":"api_handler","export":"internal","signature":"GET /api/auth/username-available","governs":{"ui":"none","state":"none","data":"checks username availability in database","routing":"GET endpoint for username validation","side_effects":"database query to check username existence","auth":"none - public endpoint","errors":"returns 500 on database errors","dependencies":["express","zod","../lib/supabase"]},"calls":["supabaseAdmin.rpc('username_available')"],"called_by":["client signup forms"],"related_files":["migration-username-function.sql"],"query_or_table_refs":["username_available() SQL function"],"notes":"API endpoint for real-time username availability checking during signup"}
{"file":"server/routes/auth.ts","lines":"40-72","symbol":"signup","kind":"api_handler","export":"internal","signature":"POST /api/auth/signup","governs":{"ui":"none","state":"none","data":"creates new user account with username and email","routing":"POST endpoint for user registration","side_effects":"creates user in Supabase auth system","auth":"creates new authenticated user","errors":"returns 400 on validation/signup errors","dependencies":["express","zod","@supabase/supabase-js"]},"calls":["supabaseClient.auth.signUp()"],"called_by":["client signup forms"],"related_files":["shared/schema.ts","migration-username-function.sql"],"query_or_table_refs":["auth.users","profiles"],"notes":"User registration endpoint with username validation and profile creation"}
{"file":"shared/schema.ts","lines":"5-10","symbol":"users","kind":"sql_function","export":"named","signature":"pgTable definition","governs":{"ui":"none","state":"none","data":"PostgreSQL table definition for users with id, email, name, created_at","routing":"none","side_effects":"none","auth":"stores user authentication data","errors":"none","dependencies":["drizzle-orm"]},"calls":[],"called_by":["database migrations","user-related operations"],"related_files":["migration.sql"],"query_or_table_refs":["users table"],"notes":"Core user table definition for authentication and profile management"}
{"file":"shared/schema.ts","lines":"23-28","symbol":"notes","kind":"sql_function","export":"named","signature":"pgTable definition","governs":{"ui":"none","state":"none","data":"PostgreSQL table for verse notes with user_id, verse_ref, text","routing":"none","side_effects":"none","auth":"enforces user ownership via RLS","errors":"none","dependencies":["drizzle-orm"]},"calls":[],"called_by":["notes CRUD operations","user data sync"],"related_files":["client/src/hooks/useNotes.ts","migration.sql"],"query_or_table_refs":["notes table"],"notes":"Stores user's verse-specific notes with reference to Bible verses"}
{"file":"shared/schema.ts","lines":"43-51","symbol":"userBookmarks","kind":"sql_function","export":"named","signature":"pgTable definition","governs":{"ui":"none","state":"none","data":"PostgreSQL table for user bookmarks with translation, verse_key","routing":"none","side_effects":"none","auth":"user-specific via user_id foreign key","errors":"none","dependencies":["drizzle-orm"]},"calls":[],"called_by":["bookmark CRUD operations","user data sync"],"related_files":["client/src/hooks/useBookmarks.ts","migration.sql"],"query_or_table_refs":["user_bookmarks table"],"notes":"User bookmark storage linking to specific Bible verses and translations"}
{"file":"shared/schema.ts","lines":"66-78","symbol":"userHighlights","kind":"sql_function","export":"named","signature":"pgTable definition","governs":{"ui":"none","state":"none","data":"PostgreSQL table for verse text highlights with segments (JSON), translation, verse_key","routing":"none","side_effects":"none","auth":"user-specific via user_id foreign key","errors":"none","dependencies":["drizzle-orm"]},"calls":[],"called_by":["highlight CRUD operations","user data sync"],"related_files":["client/src/hooks/useHighlights.ts","migration.sql"],"query_or_table_refs":["user_highlights table"],"notes":"Stores user text highlighting data as JSON segments for Bible verses"}
{"file":"client/src/components/bible/NewColumnHeaders.tsx","lines":"52-535","symbol":"NewColumnHeaders","kind":"component","export":"named","signature":"(props: NewColumnHeadersProps) => JSX.Element","governs":{"ui":"renders column headers with drag-and-drop reordering, presentation mode toggle, width controls","state":"integrates with useBibleStore for column visibility and adaptive width system","data":"none directly","routing":"none","side_effects":"CSS variable updates for column widths, event emissions for column changes","auth":"checks unlockMode for editing permissions","errors":"none explicitly","dependencies":["react","@dnd-kit/core","@dnd-kit/sortable","zustand"]},"calls":["useAdaptivePortraitColumns","useBibleStore","useTranslationMaps","DndContext","SortableContext"],"called_by":["VirtualBibleTable","BiblePage"],"related_files":["client/src/hooks/useAdaptivePortraitColumns.ts","client/src/utils/scrollNav.ts"],"query_or_table_refs":[],"notes":"Advanced column header system with drag-and-drop reordering and responsive width management"}
{"file":"client/src/components/bible/VirtualRow.tsx","lines":"1-1031","symbol":"VirtualRow","kind":"component","export":"default","signature":"({ verse, index, style }: VirtualRowProps) => JSX.Element","governs":{"ui":"renders individual Bible verse rows with translation cells, cross-references, prophecy indicators, notes","state":"integrates with useBibleStore for verse data and column configuration","data":"displays verse text, cross-references, prophecy data, user notes","routing":"none","side_effects":"handles double-click navigation, responsive width calculations","auth":"requires user for notes and highlights functionality","errors":"handles missing verse data gracefully","dependencies":["react","zustand","@/data/BibleDataAPI"]},"calls":["useBibleStore","useResponsiveColumns","ReferenceCell","CrossReferencesCell","TranslationCell","renderSlot"],"called_by":["VirtualBibleTable","react-window"],"related_files":["client/src/hooks/useResponsiveColumns.ts","client/src/data/BibleDataAPI.ts"],"query_or_table_refs":[],"notes":"Core Bible verse rendering component with full column system integration"}
{"file":"client/src/components/bible/VirtualBibleTable.tsx","lines":"1-200","symbol":"VirtualBibleTable","kind":"component","export":"default","signature":"({ verses }: VirtualBibleTableProps) => JSX.Element","governs":{"ui":"manages virtual scrolling Bible table with headers and verse rows","state":"integrates multiple hooks for column management, scrolling, and data loading","data":"none directly - delegates to child components","routing":"none","side_effects":"virtual scrolling performance optimizations, column width measurements","auth":"none directly","errors":"none explicitly","dependencies":["react","react-window","@/components/bible/NewColumnHeaders","@/components/bible/VirtualRow"]},"calls":["NewColumnHeaders","FixedSizeList","VirtualRow","useMeasureVisibleColumns","useColumnData"],"called_by":["BiblePage"],"related_files":["client/src/hooks/useMeasureVisibleColumns.ts","client/src/hooks/useColumnData.ts"],"query_or_table_refs":[],"notes":"Main Bible table component implementing virtual scrolling for 31k+ verses"}
{"file":"client/src/lib/queryClient.ts","lines":"10-35","symbol":"apiRequest","kind":"function","export":"named","signature":"(url: string, method: string, data?: unknown, userId?: string): Promise<Response>","governs":{"ui":"none","state":"none","data":"makes HTTP requests to API endpoints with authentication headers","routing":"none","side_effects":"HTTP requests with credentials, JSON serialization","auth":"adds user ID header for authenticated requests","errors":"throws on non-OK responses with status and message","dependencies":["fetch API"]},"calls":["fetch","throwIfResNotOk"],"called_by":["TanStack Query mutations","user data operations"],"related_files":["server/routes/*"],"query_or_table_refs":[],"notes":"Primary HTTP client for API communication with error handling and auth"}
{"file":"client/src/lib/queryClient.ts","lines":"55-68","symbol":"queryClient","kind":"function","export":"named","signature":"QueryClient instance","governs":{"ui":"none","state":"manages React Query cache and configuration","data":"global query caching for API requests","routing":"none","side_effects":"HTTP requests via getQueryFn","auth":"handles 401 errors appropriately","errors":"configured retry behavior and error handling","dependencies":["@tanstack/react-query"]},"calls":["getQueryFn"],"called_by":["App","all components using useQuery/useMutation"],"related_files":["client/src/App.tsx"],"query_or_table_refs":[],"notes":"Global React Query client with custom configuration for Bible app"}
{"file":"client/src/hooks/useAdaptivePortraitColumns.ts","lines":"22-95","symbol":"calculatePrecisionPortraitWidths","kind":"function","export":"internal","signature":"(viewportWidth: number, viewportHeight: number): AdaptiveWidths","governs":{"ui":"calculates exact column widths for portrait mode responsive design","state":"none","data":"none","routing":"none","side_effects":"none","auth":"none","errors":"none","dependencies":["none"]},"calls":[],"called_by":["useAdaptivePortraitColumns"],"related_files":["client/src/hooks/useAdaptivePortraitColumns.ts"],"query_or_table_refs":[],"notes":"Precision calculator for 3-column portrait layout ensuring perfect fit"}
{"file":"client/src/hooks/useAdaptivePortraitColumns.ts","lines":"97-150","symbol":"useAdaptivePortraitColumns","kind":"react_hook","export":"named","signature":"(): AdaptivePortraitConfig","governs":{"ui":"manages adaptive column widths for portrait orientation","state":"tracks window dimensions and CSS variable updates","data":"none","routing":"none","side_effects":"updates CSS variables for adaptive widths, window resize listener","auth":"none","errors":"none","dependencies":["react"]},"calls":["calculatePrecisionPortraitWidths","useState","useEffect","document.documentElement.style.setProperty"],"called_by":["NewColumnHeaders","VirtualRow"],"related_files":["client/src/components/bible/NewColumnHeaders.tsx"],"query_or_table_refs":[],"notes":"Specialized responsive system for mobile portrait orientation"}
{"file":"client/src/hooks/useMeasureVisibleColumns.ts","lines":"4-67","symbol":"useMeasureVisibleColumns","kind":"react_hook","export":"named","signature":"(containerEl: HTMLElement | null): void","governs":{"ui":"none","state":"calculates and updates visible column count based on container width","data":"none","routing":"none","side_effects":"ResizeObserver for container width monitoring, store updates","auth":"none","errors":"none","dependencies":["react","zustand"]},"calls":["useBibleStore","ResizeObserver","setVisibleCount","setContainerWidthPx"],"called_by":["VirtualBibleTable","column layout system"],"related_files":["client/src/components/bible/VirtualBibleTable.tsx"],"query_or_table_refs":[],"notes":"Dynamic column visibility calculator for responsive layout system"}
{"file":"client/src/hooks/useColumnChangeSignal.ts","lines":"1-150","symbol":"ColumnChangeSignal","kind":"class","export":"internal","signature":"class ColumnChangeSignal extends EventTarget","governs":{"ui":"none","state":"manages column change event system for cross-component communication","data":"none","routing":"none","side_effects":"custom event emission and listening","auth":"none","errors":"none","dependencies":["EventTarget API"]},"calls":["dispatchEvent","addEventListener","removeEventListener"],"called_by":["useColumnChangeEmitter","useColumnChangeSignal"],"related_files":["client/src/hooks/useReferenceColumnWidth.ts"],"query_or_table_refs":[],"notes":"Event system for coordinating column width and visibility changes across components"}
{"file":"client/src/hooks/useColumnData.ts","lines":"6-38","symbol":"useColumnData","kind":"react_hook","export":"named","signature":"(): {loadProphecyData: () => Promise<void>}","governs":{"ui":"none","state":"triggers data loading when columns are toggled","data":"loads prophecy data when prophecy columns are enabled","routing":"none","side_effects":"data loading via dynamic imports","auth":"none","errors":"logs data loading failures","dependencies":["react","zustand"]},"calls":["useBibleStore","import('@/lib/prophecyCache')"],"called_by":["VirtualBibleTable","column toggle system"],"related_files":["client/src/lib/prophecyCache.ts"],"query_or_table_refs":[],"notes":"Data loading coordinator for column-specific features"}
{"file":"client/src/utils/scrollNav.ts","lines":"31-95","symbol":"makeColumnScroller","kind":"function","export":"named","signature":"({headerEl, bodyEl, navigableKeys}: ScrollNavOpts): ScrollerInstance","governs":{"ui":"manages horizontal column navigation and synchronized scrolling","state":"none","data":"none","routing":"none","side_effects":"DOM scroll synchronization, smooth scroll behavior","auth":"none","errors":"none","dependencies":["DOM APIs"]},"calls":["addEventListener","scrollTo","getStickyLeftPx","measureLefts"],"called_by":["ColumnNavigationArrows"],"related_files":["client/src/components/bible/ColumnNavigationArrows.tsx"],"query_or_table_refs":[],"notes":"Advanced column navigation system with header/body scroll synchronization"}
{"file":"client/src/utils/columnLayout.ts","lines":"30-91","symbol":"computeVisibleRangeDynamic","kind":"function","export":"named","signature":"(p: LayoutParams): LayoutResult","governs":{"ui":"calculates which columns are visible in current viewport","state":"none","data":"none","routing":"none","side_effects":"none","auth":"none","errors":"none","dependencies":["none"]},"calls":[],"called_by":["column navigation system","visibility calculations"],"related_files":["client/src/utils/scrollNav.ts"],"query_or_table_refs":[],"notes":"Core algorithm for dynamic column visibility calculation"}
{"file":"client/src/contexts/AuthContext.tsx","lines":"1-100","symbol":"AuthProvider","kind":"component","export":"named","signature":"({children}: {children: React.ReactNode}) => JSX.Element","governs":{"ui":"provides authentication UI state and user profile data","state":"manages user authentication state, profile data, session management","data":"loads user profile from Supabase","routing":"none","side_effects":"Supabase auth state monitoring, profile data loading","auth":"core authentication provider for entire app","errors":"handles auth errors and loading states","dependencies":["react","@supabase/supabase-js"]},"calls":["supabase.auth.onAuthStateChange","supabase.from('profiles').select()"],"called_by":["App"],"related_files":["client/src/lib/supabaseClient.ts","shared/schema.ts"],"query_or_table_refs":["profiles"],"notes":"Core authentication context providing user state throughout the application"}
{"file":"client/src/contexts/HighlightContext.tsx","lines":"1-80","symbol":"HighlightProvider","kind":"component","export":"named","signature":"({children}: {children: React.ReactNode}) => JSX.Element","governs":{"ui":"manages text highlighting interface and color selection","state":"manages highlight state, color palettes, selection ranges","data":"handles highlight data persistence via useHighlights hook","routing":"none","side_effects":"text selection detection, highlight rendering","auth":"requires authentication for highlight persistence","errors":"handles highlight save/load errors","dependencies":["react","@/hooks/useHighlights"]},"calls":["useHighlights","useState","useEffect"],"called_by":["App"],"related_files":["client/src/hooks/useHighlights.ts","shared/schema.ts"],"query_or_table_refs":["user_highlights"],"notes":"Context provider for Bible verse text highlighting functionality"}
{"file":"client/src/hooks/useAuth.ts","lines":"1-50","symbol":"useAuth","kind":"react_hook","export":"named","signature":"(): AuthHookReturn","governs":{"ui":"provides auth UI state (loading, user data)","state":"manages authentication state and user profile","data":"none directly - uses AuthContext","routing":"none","side_effects":"none","auth":"core auth hook for components","errors":"none","dependencies":["react","@/contexts/AuthContext"]},"calls":["useContext"],"called_by":["TopHeader","UserProfile","AuthModals","protected components"],"related_files":["client/src/contexts/AuthContext.tsx"],"query_or_table_refs":[],"notes":"Hook for accessing authentication state and user data"}
{"file":"client/src/hooks/useNotes.ts","lines":"1-100","symbol":"useNotes","kind":"react_hook","export":"named","signature":"(): NotesHookReturn","governs":{"ui":"manages notes UI state and interactions","state":"manages verse notes state with optimistic updates","data":"CRUD operations for verse notes via API","routing":"none","side_effects":"auto-save functionality, local state synchronization","auth":"requires user authentication","errors":"handles save/load failures with rollback","dependencies":["react","@tanstack/react-query","@/lib/queryClient"]},"calls":["useQuery","useMutation","queryClient.setQueryData"],"called_by":["NotesCell","note management components"],"related_files":["client/src/components/user/NotesCell.tsx","shared/schema.ts"],"query_or_table_refs":["notes"],"notes":"Notes management with optimistic updates and auto-save"}
{"file":"client/src/hooks/useBookmarks.ts","lines":"1-80","symbol":"useBookmarks","kind":"react_hook","export":"named","signature":"(): BookmarksHookReturn","governs":{"ui":"manages bookmark UI state and list rendering","state":"manages user bookmarks with real-time updates","data":"CRUD operations for bookmarks via API","routing":"none","side_effects":"bookmark synchronization with server","auth":"requires user authentication","errors":"handles bookmark save/delete failures","dependencies":["react","@tanstack/react-query","@/lib/queryClient"]},"calls":["useQuery","useMutation","queryClient.invalidateQueries"],"called_by":["BookmarkButton","BookmarksList"],"related_files":["client/src/components/user/BookmarkButton.tsx","shared/schema.ts"],"query_or_table_refs":["user_bookmarks"],"notes":"Bookmark management with real-time synchronization"}
{"file":"client/src/hooks/useHighlights.ts","lines":"1-120","symbol":"useHighlights","kind":"react_hook","export":"named","signature":"(): HighlightsHookReturn","governs":{"ui":"manages verse text highlighting UI and color selection","state":"manages highlight segments with conflict resolution","data":"CRUD operations for highlights with server synchronization","routing":"none","side_effects":"real-time highlight rendering, server_rev conflict resolution","auth":"requires user authentication","errors":"handles highlight save failures with conflict resolution","dependencies":["react","@tanstack/react-query","@/lib/queryClient"]},"calls":["useQuery","useMutation","queryClient.setQueryData"],"called_by":["HighlightableText","HighlightContext"],"related_files":["client/src/contexts/HighlightContext.tsx","shared/schema.ts"],"query_or_table_refs":["user_highlights"],"notes":"Advanced highlighting system with conflict resolution and real-time updates"}
{"file":"client/src/workers/crossReferencesWorker.ts","lines":"1-50","symbol":"crossReferencesWorker","kind":"function","export":"internal","signature":"Web Worker message handler","governs":{"ui":"none","state":"none","data":"processes cross-reference data in background thread","routing":"none","side_effects":"heavy data processing without blocking UI","auth":"none","errors":"posts error messages to main thread","dependencies":["Web Worker API"]},"calls":["postMessage","importScripts"],"called_by":["useCrossRefLoader"],"related_files":["client/src/hooks/useCrossRefLoader.ts"],"query_or_table_refs":[],"notes":"Background worker for processing large cross-reference datasets"}
{"file":"client/src/workers/labelsWorker.ts","lines":"1-60","symbol":"labelsWorker","kind":"function","export":"internal","signature":"Web Worker message handler","governs":{"ui":"none","state":"none","data":"processes semantic label data for verse highlighting","routing":"none","side_effects":"heavy label processing without blocking UI","auth":"none","errors":"posts error messages to main thread","dependencies":["Web Worker API"]},"calls":["postMessage"],"called_by":["useDynamicLabels"],"related_files":["client/src/hooks/useDynamicLabels.ts"],"query_or_table_refs":[],"notes":"Background worker for semantic label processing and highlighting"}
{"file":"client/src/workers/strongsWorker.ts","lines":"1-80","symbol":"strongsWorker","kind":"function","export":"internal","signature":"Web Worker message handler","governs":{"ui":"none","state":"none","data":"processes Strong's concordance data for word analysis","routing":"none","side_effects":"heavy concordance processing without blocking UI","auth":"none","errors":"posts error messages to main thread","dependencies":["Web Worker API"]},"calls":["postMessage"],"called_by":["useStrongsWorker"],"related_files":["client/src/hooks/useStrongsWorker.ts"],"query_or_table_refs":[],"notes":"Background worker for Strong's concordance word analysis"}
{"file":"migration.sql","lines":"4-13","symbol":"DROP_TABLES","kind":"sql_function","export":"internal","signature":"DROP TABLE statements","governs":{"ui":"none","state":"none","data":"drops existing database tables for clean migration","routing":"none","side_effects":"destroys existing table data","auth":"none","errors":"none","dependencies":["PostgreSQL"]},"calls":[],"called_by":["database migration"],"related_files":["shared/schema.ts"],"query_or_table_refs":["navigation_history","user_sessions","user_highlights","user_bookmarks","user_notes","notes","profiles","users"],"notes":"Database cleanup for fresh schema migration"}
{"file":"migration.sql","lines":"15-71","symbol":"CREATE_TABLES","kind":"sql_function","export":"internal","signature":"CREATE TABLE statements","governs":{"ui":"none","state":"none","data":"creates core database schema for users, bookmarks, notes, highlights, navigation","routing":"none","side_effects":"creates database structure","auth":"establishes user relationship constraints","errors":"none","dependencies":["PostgreSQL"]},"calls":[],"called_by":["database migration"],"related_files":["shared/schema.ts"],"query_or_table_refs":["users","user_bookmarks","user_notes","user_highlights","navigation_history","user_sessions"],"notes":"Core database schema creation for Bible study application"}
{"file":"migration.sql","lines":"74-77","symbol":"CREATE_INDEXES","kind":"sql_function","export":"internal","signature":"CREATE INDEX statements","governs":{"ui":"none","state":"none","data":"creates database indexes for query performance","routing":"none","side_effects":"improves database query performance","auth":"none","errors":"none","dependencies":["PostgreSQL"]},"calls":[],"called_by":["database migration"],"related_files":[],"query_or_table_refs":["idx_user_bookmarks_user_id","idx_user_notes_user_id","idx_user_highlights_user_id","idx_navigation_history_user_visited"],"notes":"Performance optimization indexes for user data queries"}
{"file":"migration.sql","lines":"80-100","symbol":"RLS_POLICIES","kind":"sql_function","export":"internal","signature":"CREATE POLICY statements","governs":{"ui":"none","state":"none","data":"enforces row-level security for user data isolation","routing":"none","side_effects":"database security enforcement","auth":"enforces user data access control","errors":"none","dependencies":["PostgreSQL RLS"]},"calls":["auth.uid()"],"called_by":["database security system"],"related_files":[],"query_or_table_refs":["user_bookmarks","user_notes","user_highlights","navigation_history","user_sessions"],"notes":"Row-level security policies ensuring users can only access their own data"}
{"file":"migration-username-function.sql","lines":"4-17","symbol":"username_available","kind":"sql_function","export":"named","signature":"(u text) RETURNS boolean","governs":{"ui":"none","state":"none","data":"checks if username is available in profiles table","routing":"none","side_effects":"database query for username validation","auth":"requires authenticated user to execute","errors":"returns false for invalid usernames","dependencies":["PostgreSQL","profiles table"]},"calls":["EXISTS","SELECT"],"called_by":["server/routes/auth.ts signup endpoint"],"related_files":["server/routes/auth.ts"],"query_or_table_refs":["profiles.username"],"notes":"SQL function for real-time username availability checking"}
{"file":"migration-username-function.sql","lines":"29-41","symbol":"handle_new_user","kind":"sql_function","export":"internal","signature":"() RETURNS trigger","governs":{"ui":"none","state":"none","data":"creates profile record when new user signs up","routing":"none","side_effects":"inserts into profiles table on user creation","auth":"triggered by auth.users INSERT","errors":"none","dependencies":["PostgreSQL triggers"]},"calls":["INSERT INTO profiles"],"called_by":["on_auth_user_created trigger"],"related_files":["shared/schema.ts"],"query_or_table_refs":["profiles","auth.users"],"notes":"Database trigger for automatic profile creation on user signup"}
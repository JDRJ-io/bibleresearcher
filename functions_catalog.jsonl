{"file":"client/src/App.tsx","lines":"73-946","symbol":"useBibleStore","kind":"react_hook","export":"named","signature":"create<BibleStoreInterface>((set, get) => ({ ... }))","governs":{"ui":"manages all Bible interface state including column visibility, search modals, theme switching","state":"central Zustand store: translations, prophecies, cross-refs, notes, bookmarks, column layout, size controls","data":"loads/caches Bible data from Supabase storage: translations, cross-refs, prophecy data, dates, labels","routing":"none","side_effects":"triggers data loading when features toggled, manages event emissions for UI updates","auth":"integrates with user session for personalized data","errors":"handles data loading failures with fallbacks and error logging","dependencies":["zustand","@/data/BibleDataAPI","@/lib/labelBits"]},"calls":["loadCrossRefsData","loadProphecyData","loadDatesData","getContextGroups","buildActiveColumns","getVisibleSlice"],"called_by":["App","BiblePage","NewColumnHeaders","VirtualRow","all Bible components"],"related_files":["client/src/data/BibleDataAPI.ts","client/src/hooks/useColumnData.ts"],"query_or_table_refs":[],"notes":"Central state management hub for entire Bible study application; controls 20-column layout system"}
{"file":"client/src/App.tsx","lines":"947-969","symbol":"App","kind":"component","export":"default","signature":"() => JSX.Element","governs":{"ui":"renders main application shell with routing, providers, background, toast notifications","state":"none directly - delegates to providers","data":"none directly - delegates to providers","routing":"uses wouter for client-side routing between pages (bible, auth, profile, etc.)","side_effects":"imports preloader for immediate Bible data loading","auth":"wraps app in AuthProvider for authentication context","errors":"none directly - handled by child components","dependencies":["wouter","@tanstack/react-query","@/lib/queryClient","@/components/ui/toaster"]},"calls":["Switch","Route","QueryClientProvider","TooltipProvider","ThemeProvider","AuthProvider","HighlightProvider","DynamicBackground"],"called_by":["main.tsx"],"related_files":["client/src/main.tsx","client/src/lib/preloader.ts"],"query_or_table_refs":[],"notes":"Main application component providing routing and context providers"}
{"file":"client/src/hooks/useResponsiveColumns.ts","lines":"29-147","symbol":"useResponsiveColumns","kind":"react_hook","export":"named","signature":"(): ResponsiveColumnConfig","governs":{"ui":"calculates responsive column widths and alignment based on screen size and orientation","state":"manages window dimensions state and responsive configuration","data":"none","routing":"none","side_effects":"listens to window resize events for responsive updates","auth":"none","errors":"none","dependencies":["react"]},"calls":["useState","useEffect","useMemo"],"called_by":["VirtualRow","NewColumnHeaders","BiblePage"],"related_files":["client/src/components/bible/VirtualRow.tsx"],"query_or_table_refs":[],"notes":"Core responsive design system for Bible column layout; calculates optimal widths for portrait/landscape modes"}
{"file":"client/src/data/BibleDataAPI.ts","lines":"24-42","symbol":"fetchFromStorage","kind":"function","export":"named","signature":"(path: string): Promise<string>","governs":{"ui":"none","state":"none","data":"downloads text files from Supabase 'anointed' storage bucket","routing":"none","side_effects":"network requests to Supabase storage","auth":"none directly - relies on Supabase auth","errors":"throws Error if download fails","dependencies":["@/lib/supabaseClient"]},"calls":["supabase.storage.from().download()"],"called_by":["loadTranslation","loadVerseKeys","loadProphecyData","getLabelsData","getDatesCanonical"],"related_files":["client/src/lib/supabaseClient.ts"],"query_or_table_refs":["supabase.storage.anointed"],"notes":"Core data loading function for all Bible content from Supabase Storage"}
{"file":"client/src/data/BibleDataAPI.ts","lines":"81-113","symbol":"loadTranslation","kind":"function","export":"named","signature":"(id: string): Promise<Map<string, string>>","governs":{"ui":"none","state":"caches translation data in masterCache for instant access","data":"loads Bible translation text files, parses verse format (reference#text)","routing":"none","side_effects":"caches parsed translation data, logs loading progress","auth":"none","errors":"none explicitly - relies on fetchFromStorage error handling","dependencies":["@/lib/supabaseClient"]},"calls":["fetchFromStorage","masterCache.set"],"called_by":["useBibleStore","BibleDataAPI.searchVerses","preloader"],"related_files":["client/src/lib/supabaseClient.ts","client/src/lib/preloader.ts"],"query_or_table_refs":["supabase.storage.anointed/translations/"],"notes":"Primary Bible text loader with aggressive caching; supports KJV, AMP, CSB, etc."}
{"file":"client/src/data/BibleDataAPI.ts","lines":"367-437","symbol":"getCrossRefsBatch","kind":"function","export":"named","signature":"(verseIds: string[], cfSet?: 'cf1' | 'cf2'): Promise<Record<string, string[]>>","governs":{"ui":"none","state":"none","data":"loads cross-reference data using optimized HTTP Range requests for batch verse loading","routing":"none","side_effects":"network requests with HTTP 206 Partial Content, logs optimization metrics","auth":"none","errors":"returns empty object on failure, logs errors","dependencies":["@/lib/supabaseClient"]},"calls":["getCfOffsets","fetchSlice","supabase.storage.download()"],"called_by":["getCrossReferences","useBibleStore.loadCrossRefsData","cross-reference system"],"related_files":["client/src/hooks/useCrossRefLoader.ts"],"query_or_table_refs":["supabase.storage.anointed/references/"],"notes":"Expert-optimized cross-reference loader using HTTP Range requests; handles 29k+ verses efficiently"}
{"file":"client/src/data/BibleDataAPI.ts","lines":"498-568","symbol":"loadProphecyData","kind":"function","export":"named","signature":"(): Promise<{verseRoles: Record<string, {P: number[], F: number[], V: number[]}>, prophecyIndex: Record<number, {summary: string, prophecy: string[], fulfillment: string[], verification: string[]}>}>","governs":{"ui":"none","state":"none","data":"loads prophecy system data from Supabase: verse roles (P/F/V) and prophecy definitions","routing":"none","side_effects":"parses complex prophecy format, logs loading progress","auth":"none","errors":"returns empty objects on failure, logs errors","dependencies":["@/data/BibleDataAPI"]},"calls":["loadProphecyRows","loadProphecyIndex"],"called_by":["useBibleStore.toggleProphecies","prophecy system"],"related_files":["client/src/lib/prophecyCache.ts"],"query_or_table_refs":["supabase.storage.anointed/references/prophecy_rows.json","supabase.storage.anointed/references/prophecy_index.txt"],"notes":"Loads Bible prophecy system linking predictions, fulfillments, and verification verses"}
{"file":"server/index.ts","lines":"14-45","symbol":"server","kind":"function","export":"internal","signature":"Express application setup","governs":{"ui":"none","state":"none","data":"none directly","routing":"Express server with /api routes for storage, users, auth, profile, Stripe","side_effects":"starts HTTP server on PORT 3001, serves static files","auth":"delegates to auth routes","errors":"none explicitly","dependencies":["express","cors","./routes/*"]},"calls":["app.use","app.listen","registerStripeRoutes"],"called_by":["main execution"],"related_files":["server/routes/auth.ts","server/routes/users.ts","server/routes/stripe.ts"],"query_or_table_refs":[],"notes":"Main Express server providing API endpoints for the Bible study application"}
{"file":"server/routes/auth.ts","lines":"19-37","symbol":"username-available","kind":"api_handler","export":"internal","signature":"GET /api/auth/username-available","governs":{"ui":"none","state":"none","data":"checks username availability in database","routing":"GET endpoint for username validation","side_effects":"database query to check username existence","auth":"none - public endpoint","errors":"returns 500 on database errors","dependencies":["express","zod","../lib/supabase"]},"calls":["supabaseAdmin.rpc('username_available')"],"called_by":["client signup forms"],"related_files":["migration-username-function.sql"],"query_or_table_refs":["username_available() SQL function"],"notes":"API endpoint for real-time username availability checking during signup"}
{"file":"server/routes/auth.ts","lines":"40-72","symbol":"signup","kind":"api_handler","export":"internal","signature":"POST /api/auth/signup","governs":{"ui":"none","state":"none","data":"creates new user account with username and email","routing":"POST endpoint for user registration","side_effects":"creates user in Supabase auth system","auth":"creates new authenticated user","errors":"returns 400 on validation/signup errors","dependencies":["express","zod","@supabase/supabase-js"]},"calls":["supabaseClient.auth.signUp()"],"called_by":["client signup forms"],"related_files":["shared/schema.ts","migration-username-function.sql"],"query_or_table_refs":["auth.users","profiles"],"notes":"User registration endpoint with username validation and profile creation"}
{"file":"shared/schema.ts","lines":"5-10","symbol":"users","kind":"sql_function","export":"named","signature":"pgTable definition","governs":{"ui":"none","state":"none","data":"PostgreSQL table definition for users with id, email, name, created_at","routing":"none","side_effects":"none","auth":"stores user authentication data","errors":"none","dependencies":["drizzle-orm"]},"calls":[],"called_by":["database migrations","user-related operations"],"related_files":["migration.sql"],"query_or_table_refs":["users table"],"notes":"Core user table definition for authentication and profile management"}
{"file":"shared/schema.ts","lines":"23-28","symbol":"notes","kind":"sql_function","export":"named","signature":"pgTable definition","governs":{"ui":"none","state":"none","data":"PostgreSQL table for verse notes with user_id, verse_ref, text","routing":"none","side_effects":"none","auth":"enforces user ownership via RLS","errors":"none","dependencies":["drizzle-orm"]},"calls":[],"called_by":["notes CRUD operations","user data sync"],"related_files":["client/src/hooks/useNotes.ts","migration.sql"],"query_or_table_refs":["notes table"],"notes":"Stores user's verse-specific notes with reference to Bible verses"}
{"file":"shared/schema.ts","lines":"43-51","symbol":"userBookmarks","kind":"sql_function","export":"named","signature":"pgTable definition","governs":{"ui":"none","state":"none","data":"PostgreSQL table for user bookmarks with translation, verse_key","routing":"none","side_effects":"none","auth":"user-specific via user_id foreign key","errors":"none","dependencies":["drizzle-orm"]},"calls":[],"called_by":["bookmark CRUD operations","user data sync"],"related_files":["client/src/hooks/useBookmarks.ts","migration.sql"],"query_or_table_refs":["user_bookmarks table"],"notes":"User bookmark storage linking to specific Bible verses and translations"}
{"file":"shared/schema.ts","lines":"66-78","symbol":"userHighlights","kind":"sql_function","export":"named","signature":"pgTable definition","governs":{"ui":"none","state":"none","data":"PostgreSQL table for verse text highlights with segments (JSON), translation, verse_key","routing":"none","side_effects":"none","auth":"user-specific via user_id foreign key","errors":"none","dependencies":["drizzle-orm"]},"calls":[],"called_by":["highlight CRUD operations","user data sync"],"related_files":["client/src/hooks/useHighlights.ts","migration.sql"],"query_or_table_refs":["user_highlights table"],"notes":"Stores user text highlighting data as JSON segments for Bible verses"}
{"file":"client/src/components/bible/NewColumnHeaders.tsx","lines":"52-535","symbol":"NewColumnHeaders","kind":"component","export":"named","signature":"(props: NewColumnHeadersProps) => JSX.Element","governs":{"ui":"renders column headers with drag-and-drop reordering, presentation mode toggle, width controls","state":"integrates with useBibleStore for column visibility and adaptive width system","data":"none directly","routing":"none","side_effects":"CSS variable updates for column widths, event emissions for column changes","auth":"checks unlockMode for editing permissions","errors":"none explicitly","dependencies":["react","@dnd-kit/core","@dnd-kit/sortable","zustand"]},"calls":["useAdaptivePortraitColumns","useBibleStore","useTranslationMaps","DndContext","SortableContext"],"called_by":["VirtualBibleTable","BiblePage"],"related_files":["client/src/hooks/useAdaptivePortraitColumns.ts","client/src/utils/scrollNav.ts"],"query_or_table_refs":[],"notes":"Advanced column header system with drag-and-drop reordering and responsive width management"}
{"file":"client/src/components/bible/VirtualRow.tsx","lines":"1-1031","symbol":"VirtualRow","kind":"component","export":"default","signature":"({ verse, index, style }: VirtualRowProps) => JSX.Element","governs":{"ui":"renders individual Bible verse rows with translation cells, cross-references, prophecy indicators, notes","state":"integrates with useBibleStore for verse data and column configuration","data":"displays verse text, cross-references, prophecy data, user notes","routing":"none","side_effects":"handles double-click navigation, responsive width calculations","auth":"requires user for notes and highlights functionality","errors":"handles missing verse data gracefully","dependencies":["react","zustand","@/data/BibleDataAPI"]},"calls":["useBibleStore","useResponsiveColumns","ReferenceCell","CrossReferencesCell","TranslationCell","renderSlot"],"called_by":["VirtualBibleTable","react-window"],"related_files":["client/src/hooks/useResponsiveColumns.ts","client/src/data/BibleDataAPI.ts"],"query_or_table_refs":[],"notes":"Core Bible verse rendering component with full column system integration"}
{"file":"client/src/components/bible/VirtualBibleTable.tsx","lines":"1-200","symbol":"VirtualBibleTable","kind":"component","export":"default","signature":"({ verses }: VirtualBibleTableProps) => JSX.Element","governs":{"ui":"manages virtual scrolling Bible table with headers and verse rows","state":"integrates multiple hooks for column management, scrolling, and data loading","data":"none directly - delegates to child components","routing":"none","side_effects":"virtual scrolling performance optimizations, column width measurements","auth":"none directly","errors":"none explicitly","dependencies":["react","react-window","@/components/bible/NewColumnHeaders","@/components/bible/VirtualRow"]},"calls":["NewColumnHeaders","FixedSizeList","VirtualRow","useMeasureVisibleColumns","useColumnData"],"called_by":["BiblePage"],"related_files":["client/src/hooks/useMeasureVisibleColumns.ts","client/src/hooks/useColumnData.ts"],"query_or_table_refs":[],"notes":"Main Bible table component implementing virtual scrolling for 31k+ verses"}
{"file":"client/src/lib/queryClient.ts","lines":"10-35","symbol":"apiRequest","kind":"function","export":"named","signature":"(url: string, method: string, data?: unknown, userId?: string): Promise<Response>","governs":{"ui":"none","state":"none","data":"makes HTTP requests to API endpoints with authentication headers","routing":"none","side_effects":"HTTP requests with credentials, JSON serialization","auth":"adds user ID header for authenticated requests","errors":"throws on non-OK responses with status and message","dependencies":["fetch API"]},"calls":["fetch","throwIfResNotOk"],"called_by":["TanStack Query mutations","user data operations"],"related_files":["server/routes/*"],"query_or_table_refs":[],"notes":"Primary HTTP client for API communication with error handling and auth"}
{"file":"client/src/lib/queryClient.ts","lines":"55-68","symbol":"queryClient","kind":"function","export":"named","signature":"QueryClient instance","governs":{"ui":"none","state":"manages React Query cache and configuration","data":"global query caching for API requests","routing":"none","side_effects":"HTTP requests via getQueryFn","auth":"handles 401 errors appropriately","errors":"configured retry behavior and error handling","dependencies":["@tanstack/react-query"]},"calls":["getQueryFn"],"called_by":["App","all components using useQuery/useMutation"],"related_files":["client/src/App.tsx"],"query_or_table_refs":[],"notes":"Global React Query client with custom configuration for Bible app"}
{"file":"client/src/hooks/useAdaptivePortraitColumns.ts","lines":"22-95","symbol":"calculatePrecisionPortraitWidths","kind":"function","export":"internal","signature":"(viewportWidth: number, viewportHeight: number): AdaptiveWidths","governs":{"ui":"calculates exact column widths for portrait mode responsive design","state":"none","data":"none","routing":"none","side_effects":"none","auth":"none","errors":"none","dependencies":["none"]},"calls":[],"called_by":["useAdaptivePortraitColumns"],"related_files":["client/src/hooks/useAdaptivePortraitColumns.ts"],"query_or_table_refs":[],"notes":"Precision calculator for 3-column portrait layout ensuring perfect fit"}
{"file":"client/src/hooks/useAdaptivePortraitColumns.ts","lines":"97-150","symbol":"useAdaptivePortraitColumns","kind":"react_hook","export":"named","signature":"(): AdaptivePortraitConfig","governs":{"ui":"manages adaptive column widths for portrait orientation","state":"tracks window dimensions and CSS variable updates","data":"none","routing":"none","side_effects":"updates CSS variables for adaptive widths, window resize listener","auth":"none","errors":"none","dependencies":["react"]},"calls":["calculatePrecisionPortraitWidths","useState","useEffect","document.documentElement.style.setProperty"],"called_by":["NewColumnHeaders","VirtualRow"],"related_files":["client/src/components/bible/NewColumnHeaders.tsx"],"query_or_table_refs":[],"notes":"Specialized responsive system for mobile portrait orientation"}
{"file":"client/src/hooks/useMeasureVisibleColumns.ts","lines":"4-67","symbol":"useMeasureVisibleColumns","kind":"react_hook","export":"named","signature":"(containerEl: HTMLElement | null): void","governs":{"ui":"none","state":"calculates and updates visible column count based on container width","data":"none","routing":"none","side_effects":"ResizeObserver for container width monitoring, store updates","auth":"none","errors":"none","dependencies":["react","zustand"]},"calls":["useBibleStore","ResizeObserver","setVisibleCount","setContainerWidthPx"],"called_by":["VirtualBibleTable","column layout system"],"related_files":["client/src/components/bible/VirtualBibleTable.tsx"],"query_or_table_refs":[],"notes":"Dynamic column visibility calculator for responsive layout system"}
{"file":"client/src/hooks/useColumnChangeSignal.ts","lines":"1-150","symbol":"ColumnChangeSignal","kind":"class","export":"internal","signature":"class ColumnChangeSignal extends EventTarget","governs":{"ui":"none","state":"manages column change event system for cross-component communication","data":"none","routing":"none","side_effects":"custom event emission and listening","auth":"none","errors":"none","dependencies":["EventTarget API"]},"calls":["dispatchEvent","addEventListener","removeEventListener"],"called_by":["useColumnChangeEmitter","useColumnChangeSignal"],"related_files":["client/src/hooks/useReferenceColumnWidth.ts"],"query_or_table_refs":[],"notes":"Event system for coordinating column width and visibility changes across components"}
{"file":"client/src/hooks/useColumnData.ts","lines":"6-38","symbol":"useColumnData","kind":"react_hook","export":"named","signature":"(): {loadProphecyData: () => Promise<void>}","governs":{"ui":"none","state":"triggers data loading when columns are toggled","data":"loads prophecy data when prophecy columns are enabled","routing":"none","side_effects":"data loading via dynamic imports","auth":"none","errors":"logs data loading failures","dependencies":["react","zustand"]},"calls":["useBibleStore","import('@/lib/prophecyCache')"],"called_by":["VirtualBibleTable","column toggle system"],"related_files":["client/src/lib/prophecyCache.ts"],"query_or_table_refs":[],"notes":"Data loading coordinator for column-specific features"}
{"file":"client/src/utils/scrollNav.ts","lines":"31-95","symbol":"makeColumnScroller","kind":"function","export":"named","signature":"({headerEl, bodyEl, navigableKeys}: ScrollNavOpts): ScrollerInstance","governs":{"ui":"manages horizontal column navigation and synchronized scrolling","state":"none","data":"none","routing":"none","side_effects":"DOM scroll synchronization, smooth scroll behavior","auth":"none","errors":"none","dependencies":["DOM APIs"]},"calls":["addEventListener","scrollTo","getStickyLeftPx","measureLefts"],"called_by":["ColumnNavigationArrows"],"related_files":["client/src/components/bible/ColumnNavigationArrows.tsx"],"query_or_table_refs":[],"notes":"Advanced column navigation system with header/body scroll synchronization"}
{"file":"client/src/utils/columnLayout.ts","lines":"30-91","symbol":"computeVisibleRangeDynamic","kind":"function","export":"named","signature":"(p: LayoutParams): LayoutResult","governs":{"ui":"calculates which columns are visible in current viewport","state":"none","data":"none","routing":"none","side_effects":"none","auth":"none","errors":"none","dependencies":["none"]},"calls":[],"called_by":["column navigation system","visibility calculations"],"related_files":["client/src/utils/scrollNav.ts"],"query_or_table_refs":[],"notes":"Core algorithm for dynamic column visibility calculation"}
{"file":"client/src/contexts/AuthContext.tsx","lines":"1-100","symbol":"AuthProvider","kind":"component","export":"named","signature":"({children}: {children: React.ReactNode}) => JSX.Element","governs":{"ui":"provides authentication UI state and user profile data","state":"manages user authentication state, profile data, session management","data":"loads user profile from Supabase","routing":"none","side_effects":"Supabase auth state monitoring, profile data loading","auth":"core authentication provider for entire app","errors":"handles auth errors and loading states","dependencies":["react","@supabase/supabase-js"]},"calls":["supabase.auth.onAuthStateChange","supabase.from('profiles').select()"],"called_by":["App"],"related_files":["client/src/lib/supabaseClient.ts","shared/schema.ts"],"query_or_table_refs":["profiles"],"notes":"Core authentication context providing user state throughout the application"}
{"file":"client/src/contexts/HighlightContext.tsx","lines":"1-80","symbol":"HighlightProvider","kind":"component","export":"named","signature":"({children}: {children: React.ReactNode}) => JSX.Element","governs":{"ui":"manages text highlighting interface and color selection","state":"manages highlight state, color palettes, selection ranges","data":"handles highlight data persistence via useHighlights hook","routing":"none","side_effects":"text selection detection, highlight rendering","auth":"requires authentication for highlight persistence","errors":"handles highlight save/load errors","dependencies":["react","@/hooks/useHighlights"]},"calls":["useHighlights","useState","useEffect"],"called_by":["App"],"related_files":["client/src/hooks/useHighlights.ts","shared/schema.ts"],"query_or_table_refs":["user_highlights"],"notes":"Context provider for Bible verse text highlighting functionality"}
{"file":"client/src/hooks/useAuth.ts","lines":"1-50","symbol":"useAuth","kind":"react_hook","export":"named","signature":"(): AuthHookReturn","governs":{"ui":"provides auth UI state (loading, user data)","state":"manages authentication state and user profile","data":"none directly - uses AuthContext","routing":"none","side_effects":"none","auth":"core auth hook for components","errors":"none","dependencies":["react","@/contexts/AuthContext"]},"calls":["useContext"],"called_by":["TopHeader","UserProfile","AuthModals","protected components"],"related_files":["client/src/contexts/AuthContext.tsx"],"query_or_table_refs":[],"notes":"Hook for accessing authentication state and user data"}
{"file":"client/src/hooks/useNotes.ts","lines":"1-100","symbol":"useNotes","kind":"react_hook","export":"named","signature":"(): NotesHookReturn","governs":{"ui":"manages notes UI state and interactions","state":"manages verse notes state with optimistic updates","data":"CRUD operations for verse notes via API","routing":"none","side_effects":"auto-save functionality, local state synchronization","auth":"requires user authentication","errors":"handles save/load failures with rollback","dependencies":["react","@tanstack/react-query","@/lib/queryClient"]},"calls":["useQuery","useMutation","queryClient.setQueryData"],"called_by":["NotesCell","note management components"],"related_files":["client/src/components/user/NotesCell.tsx","shared/schema.ts"],"query_or_table_refs":["notes"],"notes":"Notes management with optimistic updates and auto-save"}
{"file":"client/src/hooks/useBookmarks.ts","lines":"1-80","symbol":"useBookmarks","kind":"react_hook","export":"named","signature":"(): BookmarksHookReturn","governs":{"ui":"manages bookmark UI state and list rendering","state":"manages user bookmarks with real-time updates","data":"CRUD operations for bookmarks via API","routing":"none","side_effects":"bookmark synchronization with server","auth":"requires user authentication","errors":"handles bookmark save/delete failures","dependencies":["react","@tanstack/react-query","@/lib/queryClient"]},"calls":["useQuery","useMutation","queryClient.invalidateQueries"],"called_by":["BookmarkButton","BookmarksList"],"related_files":["client/src/components/user/BookmarkButton.tsx","shared/schema.ts"],"query_or_table_refs":["user_bookmarks"],"notes":"Bookmark management with real-time synchronization"}
{"file":"client/src/hooks/useHighlights.ts","lines":"1-120","symbol":"useHighlights","kind":"react_hook","export":"named","signature":"(): HighlightsHookReturn","governs":{"ui":"manages verse text highlighting UI and color selection","state":"manages highlight segments with conflict resolution","data":"CRUD operations for highlights with server synchronization","routing":"none","side_effects":"real-time highlight rendering, server_rev conflict resolution","auth":"requires user authentication","errors":"handles highlight save failures with conflict resolution","dependencies":["react","@tanstack/react-query","@/lib/queryClient"]},"calls":["useQuery","useMutation","queryClient.setQueryData"],"called_by":["HighlightableText","HighlightContext"],"related_files":["client/src/contexts/HighlightContext.tsx","shared/schema.ts"],"query_or_table_refs":["user_highlights"],"notes":"Advanced highlighting system with conflict resolution and real-time updates"}
{"file":"client/src/workers/crossReferencesWorker.ts","lines":"1-50","symbol":"crossReferencesWorker","kind":"function","export":"internal","signature":"Web Worker message handler","governs":{"ui":"none","state":"none","data":"processes cross-reference data in background thread","routing":"none","side_effects":"heavy data processing without blocking UI","auth":"none","errors":"posts error messages to main thread","dependencies":["Web Worker API"]},"calls":["postMessage","importScripts"],"called_by":["useCrossRefLoader"],"related_files":["client/src/hooks/useCrossRefLoader.ts"],"query_or_table_refs":[],"notes":"Background worker for processing large cross-reference datasets"}
{"file":"client/src/workers/labelsWorker.ts","lines":"1-60","symbol":"labelsWorker","kind":"function","export":"internal","signature":"Web Worker message handler","governs":{"ui":"none","state":"none","data":"processes semantic label data for verse highlighting","routing":"none","side_effects":"heavy label processing without blocking UI","auth":"none","errors":"posts error messages to main thread","dependencies":["Web Worker API"]},"calls":["postMessage"],"called_by":["useDynamicLabels"],"related_files":["client/src/hooks/useDynamicLabels.ts"],"query_or_table_refs":[],"notes":"Background worker for semantic label processing and highlighting"}
{"file":"client/src/main.tsx","lines":"1-14","symbol":"main","kind":"entry_point","export":"none","signature":"module execution","governs":{"ui":"bootstraps React root and renders App component","state":"none","data":"none","routing":"none","side_effects":"DOM mounting, CSS imports, service worker dev guard","auth":"none","errors":"none","dependencies":["react-dom/client","./App","./index.css"]},"calls":["createRoot","render"],"called_by":["Vite/browser"],"related_files":["client/src/App.tsx","client/src/index.css","client/src/styles/column-headers-scrollbar-fix.css"],"query_or_table_refs":[],"notes":"Application entry point that mounts React app to DOM root"}
{"file":"client/src/pages/bible.tsx","lines":"28-467","symbol":"BiblePage","kind":"component","export":"default","signature":"() => JSX.Element","governs":{"ui":"orchestrates complete Bible reading interface: table, overlays, modals, navigation","state":"manages verse selection, prophecy drawers, search modal, menu state, welcome flow","data":"coordinates Bible verse loading, translation management, verse navigation","routing":"handles URL hash parameters for verse navigation","side_effects":"localStorage management, event listeners for navigation/scrolling, adaptive loading","auth":"integrates with user authentication for personalized features","errors":"handles verse navigation failures with fallback search","dependencies":["react","@/hooks/useBibleData","@/hooks/useVerseNav","@/components/bible/VirtualBibleTable"]},"calls":["useBibleStore","useAuth","useBibleData","useVerseNav","useTranslationMaps","useReadingState","useHashParams","useBodyClass","useAdaptiveScaling","useLoadingDetection","VirtualBibleTable","TopHeader","StrongsOverlay","ProphecyDetailDrawer","SearchModal","HamburgerMenu","Welcome","IntroOverlay","Footer"],"called_by":["App (via routing)"],"related_files":["client/src/hooks/useBibleData.ts","client/src/hooks/useVerseNav.ts","client/src/components/bible/VirtualBibleTable.tsx"],"query_or_table_refs":[],"notes":"Main Bible reading page coordinating all Bible study features and user interface"}
{"file":"client/src/hooks/useBibleData.ts","lines":"631-1519","symbol":"useBibleData","kind":"react_hook","export":"named","signature":"(): BibleDataReturn","governs":{"ui":"none directly","state":"manages complete Bible data state: 31k+ verses, translations, loading progress","data":"loads Bible structure from Supabase, coordinates dynamic text loading, translation management","routing":"handles chronological vs canonical verse ordering","side_effects":"dynamic verse text loading around scroll position, translation caching","auth":"none directly","errors":"handles Bible data loading failures with fallbacks","dependencies":["react","@tanstack/react-query","@/data/BibleDataAPI","@/lib/translationLoader"]},"calls":["loadFullBibleIndex","loadKJVTextMap","createFullBibleIndexWithoutText","loadAdditionalData","parseActualSupabaseKJV","loadProphecyDataOnDemand","useState","useEffect","useQuery"],"called_by":["BiblePage"],"related_files":["client/src/data/BibleDataAPI.ts","client/src/lib/translationLoader.ts","client/src/lib/supabaseClient.ts"],"query_or_table_refs":["supabase.storage.anointed"],"notes":"Master Bible data management hook handling 31,102 verses with dynamic loading and translation coordination"}
{"file":"client/src/hooks/useBibleData.ts","lines":"20-36","symbol":"loadKJVTextMap","kind":"function","export":"internal","signature":"(): Promise<void>","governs":{"ui":"none","state":"loads and caches global KJV text map","data":"loads KJV translation from BibleDataAPI into global cache","routing":"none","side_effects":"populates globalKjvTextMap variable, console logging","auth":"none","errors":"sets empty Map on failure","dependencies":["@/data/BibleDataAPI"]},"calls":["loadTranslation"],"called_by":["loadFullBibleIndex","createFullBibleWithHeights"],"related_files":["client/src/data/BibleDataAPI.ts"],"query_or_table_refs":[],"notes":"Optimized KJV text loader for instant verse access"}
{"file":"client/src/hooks/useBibleData.ts","lines":"39-91","symbol":"loadFullBibleIndex","kind":"function","export":"internal","signature":"(progressCallback?: Function, isChronological?: boolean): Promise<BibleVerse[]>","governs":{"ui":"none","state":"none","data":"loads complete Bible index (31k+ verses) with empty text placeholders","routing":"none","side_effects":"progress callbacks, dynamic KJV loading","auth":"none","errors":"throws on Supabase loading failure","dependencies":["@/data/BibleDataAPI"]},"calls":["loadVerseKeys","loadKJVTextMap","createFullBibleIndexWithoutText"],"called_by":["useBibleData"],"related_files":["client/src/data/BibleDataAPI.ts"],"query_or_table_refs":[],"notes":"Creates foundation Bible structure for virtual scrolling without preloading all text"}
{"file":"client/src/hooks/useVerseNav.ts","lines":"9-168","symbol":"useVerseNav","kind":"react_hook","export":"named","signature":"(scrollToVerse: ScrollToFn): VerseNavReturn","governs":{"ui":"none directly","state":"manages navigation history (mobile internal stack vs desktop browser history)","data":"none","routing":"coordinates verse navigation with browser/internal history","side_effects":"browser history manipulation, navigation event emissions, localStorage","auth":"none","errors":"none","dependencies":["react","@/lib/verseKeysLoader","@/hooks/useMobileDetection"]},"calls":["useMobileDetection","useState","useEffect","window.history.pushState","window.history.back","window.history.forward","window.dispatchEvent"],"called_by":["BiblePage"],"related_files":["client/src/lib/verseKeysLoader.ts","client/src/hooks/useMobileDetection.ts"],"query_or_table_refs":[],"notes":"Intelligent navigation system with mobile-optimized internal history and desktop browser history integration"}
{"file":"client/src/components/bible/TopHeader.tsx","lines":"31-409","symbol":"TopHeader","kind":"component","export":"named","signature":"(props: TopHeaderProps): JSX.Element","governs":{"ui":"renders top navigation header with search, bookmarks, auth, navigation controls","state":"manages auth modals, bookmark modal, responsive layout","data":"none directly","routing":"none","side_effects":"search modal triggers, bookmark creation via Supabase","auth":"integrates authentication UI and bookmark saving","errors":"handles bookmark save failures with toasts","dependencies":["react","@/components/ui/*","@/contexts/AuthContext","@tanstack/react-query"]},"calls":["useTheme","useAuth","useState","useWindowSize","useBibleStore","useMutation","useQueryClient","useToast","useAdaptiveScaling","Button","Select","UserProfileDropdown","AuthModals","BookmarkModal"],"called_by":["BiblePage"],"related_files":["client/src/contexts/AuthContext.tsx","client/src/lib/supabaseClient.ts"],"query_or_table_refs":["bookmarks"],"notes":"Responsive header component with integrated authentication and bookmark management"}
{"file":"client/src/lib/supabaseClient.ts","lines":"18-25","symbol":"supabase","kind":"singleton","export":"named","signature":"ReturnType<typeof createClient>","governs":{"ui":"none","state":"none","data":"provides singleton Supabase client for all database/storage operations","routing":"none","side_effects":"globalThis attachment to prevent multiple GoTrue warnings","auth":"provides authentication methods and session management","errors":"throws on missing environment variables","dependencies":["@supabase/supabase-js"]},"calls":["createClient"],"called_by":["all components using Supabase"],"related_files":["client/src/contexts/AuthContext.tsx"],"query_or_table_refs":["supabase.storage.anointed","supabase.auth"],"notes":"Singleton Supabase client preventing multiple GoTrue warnings"}
{"file":"client/src/lib/supabaseClient.ts","lines":"34-82","symbol":"LRUCache","kind":"class","export":"internal","signature":"class with get/set/has methods","governs":{"ui":"none","state":"manages LRU eviction for translation cache","data":"optimizes memory usage with 12-translation limit","routing":"none","side_effects":"automatic cache eviction, console logging","auth":"none","errors":"none","dependencies":["none"]},"calls":[],"called_by":["masterCache"],"related_files":[],"query_or_table_refs":[],"notes":"Memory-optimized LRU cache with 12 translation limit per PR-B requirement"}
{"file":"client/src/lib/supabaseClient.ts","lines":"84","symbol":"masterCache","kind":"singleton","export":"named","signature":"LRUCache","governs":{"ui":"none","state":"global translation cache with LRU eviction","data":"caches Bible translations to prevent repeated downloads","routing":"none","side_effects":"automatic cache management","auth":"none","errors":"none","dependencies":["LRUCache"]},"calls":["LRUCache"],"called_by":["loadTranslationSecure","preloader"],"related_files":["client/src/lib/preloader.ts"],"query_or_table_refs":[],"notes":"Single master cache instance for all Bible translation data"}
{"file":"client/src/lib/supabaseClient.ts","lines":"90-116","symbol":"loadVerseKeys","kind":"function","export":"named","signature":"(): Promise<string[]>","governs":{"ui":"none","state":"caches verse keys globally","data":"loads master verse index from Supabase storage","routing":"none","side_effects":"verse keys caching, console logging","auth":"requires Supabase authentication","errors":"throws on Supabase download failure","dependencies":["supabase"]},"calls":["supabase.storage.from.download"],"called_by":["verseKeysLoader","useBibleData"],"related_files":["client/src/lib/verseKeysLoader.ts"],"query_or_table_refs":["supabase.storage.anointed.metadata/verseKeys-canonical.json"],"notes":"Loads 31k+ verse keys as foundation for Bible structure"}
{"file":"client/src/lib/supabaseClient.ts","lines":"119-167","symbol":"loadTranslationSecure","kind":"function","export":"named","signature":"(translationId: string): Promise<Map<string, string>>","governs":{"ui":"none","state":"none","data":"loads Bible translations from Supabase with caching","routing":"none","side_effects":"master cache updates, console logging","auth":"requires Supabase authentication","errors":"throws on network/parsing failures","dependencies":["supabase","masterCache"]},"calls":["supabase.storage.from.createSignedUrl","fetch","masterCache.get","masterCache.set"],"called_by":["BibleDataAPI","preloader"],"related_files":["client/src/data/BibleDataAPI.ts","client/src/lib/preloader.ts"],"query_or_table_refs":["supabase.storage.anointed.translations/*.txt"],"notes":"Secure translation loading with signed URLs and master cache integration"}
{"file":"client/src/lib/supabaseClient.ts","lines":"170-211","symbol":"auth_helpers","kind":"function_group","export":"named","signature":"various auth functions","governs":{"ui":"none","state":"none","data":"none","routing":"none","side_effects":"browser history, session management","auth":"provides complete authentication interface","errors":"returns auth errors","dependencies":["supabase"]},"calls":["supabase.auth.signInWithOtp","supabase.auth.signOut","supabase.auth.getUser","supabase.auth.getSession","supabase.auth.onAuthStateChange"],"called_by":["AuthContext","TopHeader"],"related_files":["client/src/contexts/AuthContext.tsx"],"query_or_table_refs":[],"notes":"Complete authentication helper functions for magic link and session management"}
{"file":"client/src/lib/preloader.ts","lines":"7-25","symbol":"preloadKJV","kind":"function","export":"named","signature":"(): Promise<Map<string, string>>","governs":{"ui":"none","state":"none","data":"aggressively loads KJV for instant display","routing":"none","side_effects":"module-level KJV loading, console logging","auth":"none directly","errors":"returns empty Map on failure","dependencies":["@/data/BibleDataAPI"]},"calls":["loadTranslation"],"called_by":["module initialization","isKJVReady","getKJVTextInstant"],"related_files":["client/src/data/BibleDataAPI.ts"],"query_or_table_refs":[],"notes":"Aggressive KJV preloader for instant verse display without waiting"}
{"file":"client/src/lib/preloader.ts","lines":"28-30","symbol":"isKJVReady","kind":"function","export":"named","signature":"(): boolean","governs":{"ui":"none","state":"none","data":"checks if KJV is ready for instant access","routing":"none","side_effects":"none","auth":"none","errors":"none","dependencies":["masterCache"]},"calls":["masterCache.has"],"called_by":["components needing instant KJV access"],"related_files":["client/src/lib/supabaseClient.ts"],"query_or_table_refs":[],"notes":"Instant readiness check for KJV text without async operations"}
{"file":"client/src/lib/preloader.ts","lines":"33-36","symbol":"getKJVTextInstant","kind":"function","export":"named","signature":"(verseId: string): string","governs":{"ui":"none","state":"none","data":"provides instant KJV text access","routing":"none","side_effects":"none","auth":"none","errors":"returns empty string on failure","dependencies":["masterCache"]},"calls":["masterCache.get"],"called_by":["components needing instant KJV display"],"related_files":["client/src/lib/supabaseClient.ts"],"query_or_table_refs":[],"notes":"Instant KJV text getter without async operations or loading delays"}
{"file":"client/src/hooks/useMobileDetection.ts","lines":"3-30","symbol":"useMobileDetection","kind":"react_hook","export":"named","signature":"(): boolean","governs":{"ui":"none directly","state":"tracks mobile device status with window resize","data":"none","routing":"none","side_effects":"window resize event listeners","auth":"none","errors":"none","dependencies":["react"]},"calls":["useState","useEffect","window.addEventListener","window.removeEventListener"],"called_by":["useVerseNav","VirtualBibleTable","mobile-responsive components"],"related_files":["client/src/hooks/useVerseNav.ts"],"query_or_table_refs":[],"notes":"Intelligent mobile detection combining user agent, touch capability, and screen size"}
{"file":"client/src/lib/verseKeysLoader.ts","lines":"19-124","symbol":"loadVerseKeysCanonical","kind":"function","export":"named","signature":"(): Promise<string[]>","governs":{"ui":"none","state":"caches canonical verse keys globally","data":"loads master 31k+ verse index in canonical order","routing":"none","side_effects":"global cache updates, console logging","auth":"none directly","errors":"falls back to hardcoded Bible structure","dependencies":["@/data/BibleDataAPI"]},"calls":["loadVerseKeys"],"called_by":["useBibleData","verseKeysLoader system"],"related_files":["client/src/data/BibleDataAPI.ts"],"query_or_table_refs":[],"notes":"Foundation loader for master verse index with complete 66-book fallback"}
{"file":"client/src/lib/verseKeysLoader.ts","lines":"130-154","symbol":"createVerseObjectsFromKeys","kind":"function","export":"named","signature":"(verseKeys: string[]): BibleVerse[]","governs":{"ui":"none","state":"none","data":"creates skeleton Bible verse objects from master key index","routing":"none","side_effects":"console logging","auth":"none","errors":"none","dependencies":["@/types/bible"]},"calls":[],"called_by":["useBibleData"],"related_files":["client/src/types/bible.ts"],"query_or_table_refs":[],"notes":"Creates 31k+ verse objects as foundation structure for all other data"}
{"file":"client/src/lib/verseKeysLoader.ts","lines":"167-284","symbol":"getVerseKeys","kind":"function","export":"named","signature":"(): string[]","governs":{"ui":"none","state":"none","data":"provides current verse keys with fallback generation","routing":"none","side_effects":"synchronous verse key generation if needed","auth":"none","errors":"none","dependencies":["useBibleStore (optional)"]},"calls":["useBibleStore.getState (optional)"],"called_by":["VirtualBibleTable","navigation components"],"related_files":["client/src/stores/useBibleStore.ts"],"query_or_table_refs":[],"notes":"Critical function providing verse keys for virtual scrolling with immediate fallback"}
{"file":"client/src/lib/verseKeysLoader.ts","lines":"298-322","symbol":"loadVerseKeysChronological","kind":"function","export":"named","signature":"(): Promise<string[]>","governs":{"ui":"none","state":"caches chronological verse keys globally","data":"loads master verse index in chronological order","routing":"none","side_effects":"global cache updates, console logging","auth":"none directly","errors":"falls back to canonical order","dependencies":["@/data/BibleDataAPI"]},"calls":["loadVerseKeys","loadVerseKeysCanonical"],"called_by":["useBibleData (chronological mode)"],"related_files":["client/src/data/BibleDataAPI.ts"],"query_or_table_refs":[],"notes":"Chronological verse ordering system with canonical fallback"}
{"file":"client/src/data/BibleDataAPI.ts","lines":"6-22","symbol":"paths","kind":"constant","export":"internal","signature":"Record<string, string | Function>","governs":{"ui":"none","state":"none","data":"defines canonical bucket paths for all Bible data sources","routing":"none","side_effects":"none","auth":"none","errors":"none","dependencies":["none"]},"calls":[],"called_by":["all data loading functions"],"related_files":[],"query_or_table_refs":["supabase.storage.anointed.*"],"notes":"Single source of truth for all Supabase storage paths including translations, references, metadata"}
{"file":"client/src/data/BibleDataAPI.ts","lines":"24-32","symbol":"fetchFromStorage","kind":"function","export":"named","signature":"(path: string): Promise<string>","governs":{"ui":"none","state":"none","data":"core Supabase storage download function","routing":"none","side_effects":"network requests, console logging","auth":"requires Supabase authentication","errors":"throws on download failure","dependencies":["supabase"]},"calls":["supabase.storage.from.download"],"called_by":["all data loading functions"],"related_files":["client/src/lib/supabaseClient.ts"],"query_or_table_refs":["supabase.storage.anointed"],"notes":"Foundation function for all Supabase storage operations with error handling"}
{"file":"client/src/data/BibleDataAPI.ts","lines":"70-79","symbol":"getOrFetch","kind":"function","export":"internal","signature":"<T>(key: string, fetchFn: () => Promise<T>): Promise<T>","governs":{"ui":"none","state":"none","data":"provides caching layer for all data operations","routing":"none","side_effects":"master cache updates","auth":"none directly","errors":"none","dependencies":["masterCache"]},"calls":["masterCache.has","masterCache.get","masterCache.set"],"called_by":["all caching data functions"],"related_files":["client/src/lib/supabaseClient.ts"],"query_or_table_refs":[],"notes":"Central caching mechanism preventing redundant Supabase requests"}
{"file":"client/src/data/BibleDataAPI.ts","lines":"81-113","symbol":"loadTranslation","kind":"function","export":"named","signature":"(id: string): Promise<Map<string, string>>","governs":{"ui":"none","state":"none","data":"loads Bible translations with optimized parsing and caching","routing":"none","side_effects":"master cache updates, console logging","auth":"requires Supabase authentication","errors":"throws on download/parsing failure","dependencies":["fetchFromStorage","masterCache"]},"calls":["fetchFromStorage","masterCache.has","masterCache.get","masterCache.set"],"called_by":["preloader","useBibleData","searchVerses"],"related_files":["client/src/lib/preloader.ts","client/src/hooks/useBibleData.ts"],"query_or_table_refs":["supabase.storage.anointed.translations/*.txt"],"notes":"Core translation loader with regex-optimized parsing for 31k+ verses"}
{"file":"client/src/data/BibleDataAPI.ts","lines":"121-153","symbol":"loadVerseKeys","kind":"function","export":"named","signature":"(chronological: boolean): Promise<string[]>","governs":{"ui":"none","state":"none","data":"loads master verse index from Supabase with chronological support","routing":"none","side_effects":"console logging","auth":"requires Supabase authentication","errors":"falls back to canonical on chronological failure","dependencies":["getOrFetch","fetchFromStorage"]},"calls":["getOrFetch","fetchFromStorage","JSON.parse"],"called_by":["verseKeysLoader","useBibleData"],"related_files":["client/src/lib/verseKeysLoader.ts"],"query_or_table_refs":["supabase.storage.anointed.metadata/verseKeys-*.json"],"notes":"Foundation loader providing 31k+ verse keys with chronological/canonical ordering"}
{"file":"client/src/data/BibleDataAPI.ts","lines":"256-295","symbol":"searchVerses","kind":"function","export":"named","signature":"(query: string, translationId: string): Promise<SearchResult[]>","governs":{"ui":"none","state":"none","data":"provides global Bible verse search with special % random feature","routing":"none","side_effects":"none","auth":"none directly","errors":"none","dependencies":["loadTranslation","loadVerseKeys"]},"calls":["loadTranslation","loadVerseKeys"],"called_by":["search components"],"related_files":[],"query_or_table_refs":[],"notes":"Global search system with 100-result limit and special % random verse feature"}
{"file":"client/src/data/BibleDataAPI.ts","lines":"367-437","symbol":"getCrossRefsBatch","kind":"function","export":"named","signature":"(verseIds: string[], cfSet: 'cf1' | 'cf2'): Promise<Record<string, string[]>>","governs":{"ui":"none","state":"none","data":"ultra-fast cross-reference loading using HTTP Range requests","routing":"none","side_effects":"console logging","auth":"requires Supabase authentication","errors":"returns empty object on failure","dependencies":["getCfOffsets","fetchSlice"]},"calls":["getCfOffsets","fetchSlice","Promise.all"],"called_by":["cross-reference components"],"related_files":[],"query_or_table_refs":["supabase.storage.anointed.references/*.txt"],"notes":"Expert implementation using HTTP 206 Partial Content for optimized cross-reference batch loading"}
{"file":"client/src/data/BibleDataAPI.ts","lines":"200-225","symbol":"prophecy_loaders","kind":"function_group","export":"named","signature":"various prophecy functions","governs":{"ui":"none","state":"none","data":"loads prophecy data from JSON and text files","routing":"none","side_effects":"console logging, caching","auth":"requires Supabase authentication","errors":"throws on load failure","dependencies":["getOrFetch","fetchFromStorage"]},"calls":["getOrFetch","fetchFromStorage","JSON.parse"],"called_by":["prophecy components"],"related_files":[],"query_or_table_refs":["supabase.storage.anointed.references/prophecy_*"],"notes":"Prophecy data loading system with rows and index files"}
{"file":"client/src/store/translationSlice.ts","lines":"27-92","symbol":"useTranslationMaps","kind":"zustand_store","export":"named","signature":"() => TranslationState & Actions","governs":{"ui":"none directly","state":"manages main/alternate translation state with persistence","data":"none directly","routing":"none","side_effects":"localStorage persistence, custom events for slot visibility","auth":"none","errors":"none","dependencies":["zustand/middleware/persist"]},"calls":["create","persist","window.dispatchEvent"],"called_by":["Bible components","TopHeader"],"related_files":["client/src/components/bible/*"],"query_or_table_refs":[],"notes":"Central translation state store with alternate translation management and mobile reset capabilities"}
{"file":"client/src/contexts/AuthContext.tsx","lines":"19-113","symbol":"AuthProvider","kind":"component","export":"named","signature":"({ children }): JSX.Element","governs":{"ui":"none directly","state":"manages complete authentication state and profile data","data":"none directly","routing":"none","side_effects":"URL parameter cleanup, custom events, cross-domain cookies","auth":"provides complete authentication interface for entire app","errors":"handles auth state changes","dependencies":["react","@/lib/supabaseClient","@/hooks/useMyProfile"]},"calls":["useState","useEffect","supabase.auth.getSession","supabase.auth.onAuthStateChange","useMyProfile","window.dispatchEvent"],"called_by":["App (root provider)"],"related_files":["client/src/hooks/useMyProfile.ts","client/src/lib/supabaseClient.ts"],"query_or_table_refs":[],"notes":"Root authentication provider with magic link handling, cross-domain cookie sharing, and profile integration"}
{"file":"client/src/contexts/AuthContext.tsx","lines":"16-17","symbol":"useAuth","kind":"react_hook","export":"named","signature":"(): AuthCtx","governs":{"ui":"none","state":"none","data":"provides authentication context access","routing":"none","side_effects":"none","auth":"provides user, session, profile data and auth functions","errors":"none","dependencies":["react"]},"calls":["useContext"],"called_by":["all components needing auth"],"related_files":[],"query_or_table_refs":[],"notes":"Authentication context hook providing user, session, profile, and auth functions throughout the app"}
{"file":"client/src/components/bible/VirtualBibleTable.tsx","lines":"64-919","symbol":"VirtualBibleTable","kind":"component","export":"default","signature":"forwardRef<VirtualBibleTableHandle, VirtualBibleTableProps>","governs":{"ui":"renders complete virtual scrolling Bible table with 20-column system","state":"manages scrollbar dragging, tooltip visibility, anchor-based navigation","data":"coordinates verse loading, translation maps, cross-references, notes, labels","routing":"none directly","side_effects":"scroll event handling, custom events, performance optimization","auth":"integrates user authentication for notes and bookmarks","errors":"handles verse loading failures and navigation errors","dependencies":["react","@tanstack/react-query","20+ custom hooks"]},"calls":["useAuth","useToast","useNotesCache","useBibleData","useTranslationMaps","useAnchorSlice","useRowData","useViewportLabels","useBibleStore","useVerseNav","NewColumnHeaders","VirtualRow","ScrollbarTooltip"],"called_by":["BiblePage"],"related_files":["client/src/hooks/useAnchorSlice.ts","client/src/hooks/useRowData.ts","client/src/components/bible/VirtualRow.tsx"],"query_or_table_refs":[],"notes":"Core 919-line Bible table component orchestrating virtual scrolling, anchor-centered navigation, and 20-column responsive layout"}
{"file":"client/src/components/bible/VirtualBibleTable.tsx","lines":"115-117","symbol":"useAnchorSlice","kind":"hook_call","export":"internal","signature":"(containerRef, verseKeys, options): { anchorIndex, slice }","governs":{"ui":"none directly","state":"manages anchor-centered virtual scrolling","data":"provides current verse slice for rendering","routing":"none","side_effects":"scroll position tracking, performance pausing during drag","auth":"none","errors":"none","dependencies":["useAnchorSlice hook"]},"calls":["useAnchorSlice"],"called_by":["VirtualBibleTable"],"related_files":["client/src/hooks/useAnchorSlice.ts"],"query_or_table_refs":[],"notes":"Anchor-centered virtual scrolling with performance optimization during scrollbar dragging"}
{"file":"client/src/components/bible/VirtualBibleTable.tsx","lines":"131-134","symbol":"getCurrentVerse","kind":"function","export":"internal","signature":"(): { reference: string, index: number }","governs":{"ui":"none","state":"none","data":"provides current verse reference and index","routing":"none","side_effects":"none","auth":"none","errors":"falls back to Gen.1:1","dependencies":["anchorIndex","verseKeys"]},"calls":[],"called_by":["useEffect","onCurrentVerseChange"],"related_files":[],"query_or_table_refs":[],"notes":"Current verse getter with fallback to Genesis 1:1 for navigation"}
{"file":"client/src/hooks/useMyProfile.ts","lines":"15-85","symbol":"useMyProfile","kind":"react_hook","export":"named","signature":"(user: User | null, authLoading: boolean): ProfileHookReturn","governs":{"ui":"none directly","state":"manages user profile state with loading/error states","data":"CRUD operations for user profiles","routing":"none","side_effects":"Supabase profile queries, console logging","auth":"requires authenticated user for profile operations","errors":"handles profile loading and update errors","dependencies":["react","@supabase/supabase-js","@/lib/supabaseClient"]},"calls":["useState","useEffect","supabase.from.select","supabase.from.update"],"called_by":["AuthProvider"],"related_files":["client/src/contexts/AuthContext.tsx","client/src/lib/supabaseClient.ts"],"query_or_table_refs":["profiles"],"notes":"Profile management hook with tier system (free/premium/lifetime) and dev code upgrade functionality"}
{"file":"client/src/hooks/useMyProfile.ts","lines":"51-59","symbol":"save","kind":"function","export":"internal","signature":"(update: Partial<ProfileData>): Promise<void>","governs":{"ui":"none","state":"updates local profile state","data":"saves profile updates to Supabase","routing":"none","side_effects":"database updates, local state sync","auth":"requires authenticated user","errors":"throws on save failure","dependencies":["supabase"]},"calls":["supabase.from.update","setProfile"],"called_by":["AuthProvider","profile components"],"related_files":[],"query_or_table_refs":["profiles"],"notes":"Profile save helper with local state synchronization"}
{"file":"client/src/hooks/useMyProfile.ts","lines":"62-82","symbol":"upgradeToPremium","kind":"function","export":"internal","signature":"(code?: string): Promise<{ ok: boolean, msg: string }>","governs":{"ui":"none","state":"updates user tier to premium","data":"updates profile tier in database","routing":"none","side_effects":"database updates, local state sync","auth":"requires authenticated user","errors":"returns error messages for invalid codes","dependencies":["supabase"]},"calls":["supabase.from.update","setProfile"],"called_by":["AuthProvider","upgrade components"],"related_files":[],"query_or_table_refs":["profiles"],"notes":"Premium upgrade function with DEV-ALPHA-2025 code validation"}
{"file":"client/src/workers/strongsWorker.ts","lines":"1-80","symbol":"strongsWorker","kind":"function","export":"internal","signature":"Web Worker message handler","governs":{"ui":"none","state":"none","data":"processes Strong's concordance data for word analysis","routing":"none","side_effects":"heavy concordance processing without blocking UI","auth":"none","errors":"posts error messages to main thread","dependencies":["Web Worker API"]},"calls":["postMessage"],"called_by":["useStrongsWorker"],"related_files":["client/src/hooks/useStrongsWorker.ts"],"query_or_table_refs":[],"notes":"Background worker for Strong's concordance word analysis"}
{"file":"migration.sql","lines":"4-13","symbol":"DROP_TABLES","kind":"sql_function","export":"internal","signature":"DROP TABLE statements","governs":{"ui":"none","state":"none","data":"drops existing database tables for clean migration","routing":"none","side_effects":"destroys existing table data","auth":"none","errors":"none","dependencies":["PostgreSQL"]},"calls":[],"called_by":["database migration"],"related_files":["shared/schema.ts"],"query_or_table_refs":["navigation_history","user_sessions","user_highlights","user_bookmarks","user_notes","notes","profiles","users"],"notes":"Database cleanup for fresh schema migration"}
{"file":"migration.sql","lines":"15-71","symbol":"CREATE_TABLES","kind":"sql_function","export":"internal","signature":"CREATE TABLE statements","governs":{"ui":"none","state":"none","data":"creates core database schema for users, bookmarks, notes, highlights, navigation","routing":"none","side_effects":"creates database structure","auth":"establishes user relationship constraints","errors":"none","dependencies":["PostgreSQL"]},"calls":[],"called_by":["database migration"],"related_files":["shared/schema.ts"],"query_or_table_refs":["users","user_bookmarks","user_notes","user_highlights","navigation_history","user_sessions"],"notes":"Core database schema creation for Bible study application"}
{"file":"migration.sql","lines":"74-77","symbol":"CREATE_INDEXES","kind":"sql_function","export":"internal","signature":"CREATE INDEX statements","governs":{"ui":"none","state":"none","data":"creates database indexes for query performance","routing":"none","side_effects":"improves database query performance","auth":"none","errors":"none","dependencies":["PostgreSQL"]},"calls":[],"called_by":["database migration"],"related_files":[],"query_or_table_refs":["idx_user_bookmarks_user_id","idx_user_notes_user_id","idx_user_highlights_user_id","idx_navigation_history_user_visited"],"notes":"Performance optimization indexes for user data queries"}
{"file":"migration.sql","lines":"80-100","symbol":"RLS_POLICIES","kind":"sql_function","export":"internal","signature":"CREATE POLICY statements","governs":{"ui":"none","state":"none","data":"enforces row-level security for user data isolation","routing":"none","side_effects":"database security enforcement","auth":"enforces user data access control","errors":"none","dependencies":["PostgreSQL RLS"]},"calls":["auth.uid()"],"called_by":["database security system"],"related_files":[],"query_or_table_refs":["user_bookmarks","user_notes","user_highlights","navigation_history","user_sessions"],"notes":"Row-level security policies ensuring users can only access their own data"}
{"file":"migration-username-function.sql","lines":"4-17","symbol":"username_available","kind":"sql_function","export":"named","signature":"(u text) RETURNS boolean","governs":{"ui":"none","state":"none","data":"checks if username is available in profiles table","routing":"none","side_effects":"database query for username validation","auth":"requires authenticated user to execute","errors":"returns false for invalid usernames","dependencies":["PostgreSQL","profiles table"]},"calls":["EXISTS","SELECT"],"called_by":["server/routes/auth.ts signup endpoint"],"related_files":["server/routes/auth.ts"],"query_or_table_refs":["profiles.username"],"notes":"SQL function for real-time username availability checking"}
{"file":"migration-username-function.sql","lines":"29-41","symbol":"handle_new_user","kind":"sql_function","export":"internal","signature":"() RETURNS trigger","governs":{"ui":"none","state":"none","data":"creates profile record when new user signs up","routing":"none","side_effects":"inserts into profiles table on user creation","auth":"triggered by auth.users INSERT","errors":"none","dependencies":["PostgreSQL triggers"]},"calls":["INSERT INTO profiles"],"called_by":["on_auth_user_created trigger"],"related_files":["shared/schema.ts"],"query_or_table_refs":["profiles","auth.users"],"notes":"Database trigger for automatic profile creation on user signup"}
{"file":"client/src/components/user/BookmarkButton.tsx","lines":"22-156","symbol":"BookmarkButton","kind":"react_component","export":"named","signature":"(props: BookmarkButtonProps): JSX.Element | null","governs":{"ui":"renders bookmark creation dialog with color selection","state":"manages dialog state, bookmark name, and color selection","data":"none","routing":"none","side_effects":"bookmark database operations, toast notifications","auth":"requires user authentication for bookmark operations","errors":"handles bookmark save failures and validation","dependencies":["useAuth","useBookmarks","useToast","Dialog components"]},"calls":["useAuth","useBookmarks","useToast","useState","addBookmark","toast","console.log","console.error"],"called_by":["verse action components"],"related_files":["client/src/hooks/useBookmarks.ts"],"query_or_table_refs":["bookmarks"],"notes":"Bookmark button: dialog with name input, 6 color options, authentication check, error handling, loading states"}
{"file":"client/src/components/user/BookmarkButton.tsx","lines":"52-79","symbol":"handleSaveBookmark","kind":"function","export":"internal","signature":"(): Promise<void>","governs":{"ui":"none","state":"manages dialog closure and form reset","data":"none","routing":"none","side_effects":"bookmark creation, toast notifications, form state reset","auth":"none directly","errors":"handles bookmark creation failures with toast messages","dependencies":["addBookmark","toast","useState"]},"calls":["addBookmark","toast","setIsOpen","setBookmarkName","setColor","console.error"],"called_by":["save bookmark button"],"related_files":[],"query_or_table_refs":[],"notes":"Save handler: validates name, creates bookmark, shows success/error toasts, resets form state"}
{"file":"client/src/components/user/BookmarksList.tsx","lines":"21-308","symbol":"BookmarksList","kind":"react_component","export":"named","signature":"(props: BookmarksListProps): JSX.Element","governs":{"ui":"renders paginated list of user bookmarks with edit/delete actions","state":"manages editing state, delete confirmation, and form data","data":"none","routing":"none","side_effects":"bookmark database operations, navigation callbacks","auth":"requires user authentication for bookmark operations","errors":"handles bookmark update/delete failures","dependencies":["useAuth","useQuery","useMutation","useQueryClient","useToast","Dialog components"]},"calls":["useAuth","useQuery","useMutation","useQueryClient","useToast","useState","supabase.from","formatDistanceToNow","console.log","console.error","toast"],"called_by":["bookmark management interfaces"],"related_files":["@shared/schema"],"query_or_table_refs":["bookmarks"],"notes":"Bookmarks list: direct Supabase queries, edit/delete mutations, navigation callbacks, loading states, empty states"}
{"file":"client/src/components/user/BookmarksList.tsx","lines":"48-63","symbol":"updateBookmark","kind":"mutation","export":"internal","signature":"useMutation configuration","governs":{"ui":"none","state":"none","data":"none","routing":"none","side_effects":"database update operations, query cache invalidation","auth":"requires authenticated user","errors":"handles database update failures","dependencies":["supabase","useQueryClient"]},"calls":["supabase.from.update","queryClient.invalidateQueries"],"called_by":["bookmark edit functionality"],"related_files":[],"query_or_table_refs":["bookmarks"],"notes":"Update mutation: uses composite key (user_id + name), invalidates cache on success"}
{"file":"client/src/components/user/BookmarksList.tsx","lines":"66-91","symbol":"deleteBookmark","kind":"mutation","export":"internal","signature":"useMutation configuration","governs":{"ui":"none","state":"none","data":"none","routing":"none","side_effects":"database deletion operations, query cache invalidation, toast notifications","auth":"requires authenticated user","errors":"handles database deletion failures with error toasts","dependencies":["supabase","useQueryClient","useToast"]},"calls":["supabase.from.delete","queryClient.invalidateQueries","toast","console.error","setDeletingBookmark"],"called_by":["bookmark delete functionality"],"related_files":[],"query_or_table_refs":["bookmarks"],"notes":"Delete mutation: uses composite key (user_id + name), shows success/error toasts, clears delete state"}
{"file":"client/src/components/user/NotesCell.tsx","lines":"18-139","symbol":"NotesCell","kind":"react_component","export":"named","signature":"(props: NotesCellProps): JSX.Element","governs":{"ui":"renders dual-mode notes interface with editing and viewing states","state":"manages note text, editing mode, and existing note tracking","data":"none","routing":"none","side_effects":"auto-save operations, note database CRUD","auth":"requires user authentication for note operations","errors":"none directly","dependencies":["useAuth","useNotes","useDebouncedEffect","useToast","NotesTextWithLinks"]},"calls":["useAuth","useNotes","useDebouncedEffect","useToast","useState","useEffect","addNote","updateNote","deleteNote"],"called_by":["verse row components"],"related_files":["client/src/hooks/useNotes.ts","client/src/components/user/NotesTextWithLinks.tsx"],"query_or_table_refs":["notes"],"notes":"Notes cell: dual-mode interface, auto-save with 500ms debounce, hyperlink support, auto-delete empty notes, toggle between edit/view"}
{"file":"client/src/components/user/NotesTextWithLinks.tsx","lines":"16-66","symbol":"NotesTextWithLinks","kind":"react_component","export":"named","signature":"(props: NotesTextWithLinksProps): JSX.Element | null","governs":{"ui":"renders text with clickable verse reference hyperlinks","state":"none","data":"none","routing":"none","side_effects":"navigation callbacks for verse references","auth":"none","errors":"none","dependencies":["segmentTextWithReferences","Button","ExternalLink"]},"calls":["segmentTextWithReferences","map","preventDefault","stopPropagation","console.log","console.warn"],"called_by":["NotesCell component"],"related_files":["client/src/lib/verseReferenceParser.ts"],"query_or_table_refs":[],"notes":"Notes hyperlinks: parses verse references (Gen.1:1, John 3:16), creates clickable links with external icon, navigation callbacks"}
{"file":"client/src/components/bible/VirtualBibleTable.tsx","lines":"64-919","symbol":"VirtualBibleTable","kind":"react_component","export":"forwardRef","signature":"forwardRef<VirtualBibleTableHandle, VirtualBibleTableProps>","governs":{"ui":"renders virtualized Bible table with columns and rows","state":"manages anchor-based scrolling, scrollbar dragging, tooltip display","data":"coordinates data loading for visible verses","routing":"none","side_effects":"scroll management, data prefetching, query cache management","auth":"none directly","errors":"none directly","dependencies":["useAnchorSlice","useRowData","useTranslationMaps","useViewportLabels","VirtualRow","NewColumnHeaders"]},"calls":["useState","useRef","useEffect","useLayoutEffect","useCallback","useMemo","useImperativeHandle","useAuth","useToast","useQuery","useMutation","useQueryClient"],"called_by":["main Bible interface"],"related_files":["client/src/components/bible/VirtualRow.tsx","client/src/components/bible/NewColumnHeaders.tsx"],"query_or_table_refs":[],"notes":"Virtual Bible table: anchor-centered scrolling, responsive columns, label system integration, scroll tooltip, data loading coordination"}
{"file":"client/src/components/bible/VirtualBibleTable.tsx","lines":"131-134","symbol":"getCurrentVerse","kind":"function","export":"internal","signature":"(): { reference: string; index: number }","governs":{"ui":"none","state":"none","data":"none","routing":"none","side_effects":"none","auth":"none","errors":"none","dependencies":["useCallback"]},"calls":["useCallback"],"called_by":["verse tracking functionality"],"related_files":[],"query_or_table_refs":[],"notes":"Current verse getter: returns reference and index from anchor position, provides fallback to first verse"}
{"file":"client/src/components/bible/VirtualRow.tsx","lines":"1-1056","symbol":"VirtualRow","kind":"react_component","export":"named","signature":"(props: VirtualRowProps): JSX.Element","governs":{"ui":"renders individual Bible verse row with multiple columns","state":"none directly","data":"none","routing":"none","side_effects":"none directly","auth":"none directly","errors":"none directly","dependencies":["ReferenceCell","CrossReferencesCell","ProphecyCell","NotesCell","VerseText","HoverVerseBar"]},"calls":["useEffect","useMemo","useState","getVisibleColumns","getColumnWidth","getDataRequirements"],"called_by":["VirtualBibleTable"],"related_files":["client/src/components/bible/LabeledText.tsx","client/src/components/user/NotesCell.tsx","client/src/components/highlights/VerseText.tsx"],"query_or_table_refs":[],"notes":"Virtual row: coordinate multiple column cells, responsive layout, label system integration, hover effects"}
{"file":"client/src/components/bible/VirtualRow.tsx","lines":"46-60","symbol":"ReferenceCell","kind":"react_component","export":"internal","signature":"(props: CellProps): JSX.Element","governs":{"ui":"renders verse reference column with responsive styling","state":"none","data":"none","routing":"none","side_effects":"none","auth":"none","errors":"none","dependencies":["useIsMobile"]},"calls":["useIsMobile"],"called_by":["VirtualRow"],"related_files":[],"query_or_table_refs":[],"notes":"Reference cell: displays verse reference, responsive mobile/desktop styling, glass morphism effects"}
{"file":"client/src/components/bible/VirtualRow.tsx","lines":"62-178","symbol":"CrossReferencesCell","kind":"react_component","export":"internal","signature":"(props: CellProps): JSX.Element","governs":{"ui":"renders cross-references with clickable links and text","state":"none","data":"none","routing":"none","side_effects":"navigation callbacks for cross-reference clicks","auth":"none","errors":"none","dependencies":["useBibleStore","LabeledText"]},"calls":["useBibleStore","handleCrossRefClick","renderTextWithLabels","map","getVerseText","console.log","console.warn","stopPropagation","preventDefault"],"called_by":["VirtualRow"],"related_files":["client/src/components/bible/LabeledText.tsx"],"query_or_table_refs":[],"notes":"Cross-references cell: clickable reference links, verse text display, label highlighting, touch event handling, optimization with dot format"}
{"file":"client/src/components/bible/VirtualRow.tsx","lines":"180-225","symbol":"ProphecyCell","kind":"react_component","export":"internal","signature":"(props: CellProps & { type: 'P' | 'F' | 'V' }): JSX.Element","governs":{"ui":"renders prophecy data for specific type (Prediction/Fulfillment/Verification)","state":"none","data":"none","routing":"none","side_effects":"none directly","auth":"none","errors":"none","dependencies":["useBibleStore","LabeledText"]},"calls":["useBibleStore","renderTextWithLabels","Array.from","Set"],"called_by":["VirtualRow"],"related_files":["client/src/components/bible/LabeledText.tsx"],"query_or_table_refs":[],"notes":"Prophecy cell: handles P/F/V types, removes duplicate prophecy IDs, label highlighting integration, handles missing prophecy data"}
{"file":"client/src/components/bible/NewColumnHeaders.tsx","lines":"52-535","symbol":"NewColumnHeaders","kind":"react_component","export":"named","signature":"(props: NewColumnHeadersProps): JSX.Element | null","governs":{"ui":"renders adaptive column headers with drag-and-drop, navigation arrows, and presentation mode","state":"manages presentation mode, drag state, and column width multiplier","data":"none","routing":"none","side_effects":"CSS custom property manipulation, column change signal emission","auth":"none","errors":"none","dependencies":["useTranslationMaps","useBibleStore","useAdaptivePortraitColumns","ColumnNavigationArrows","DndContext"]},"calls":["useState","useEffect","useCallback","useRef","useMemo","useSensors","useSensor","useTranslationMaps","useBibleStore","useAdaptivePortraitColumns","getComputedStyle","document.documentElement.style.setProperty"],"called_by":["VirtualBibleTable"],"related_files":["client/src/components/bible/ColumnNavigationArrows.tsx","client/src/hooks/useColumnChangeSignal.ts"],"query_or_table_refs":[],"notes":"Column headers: adaptive widths with CSS calc expressions, presentation mode toggle (2x width, 1.5x text, 1.35x height), drag-and-drop reordering, responsive layout"}
{"file":"client/src/components/bible/NewColumnHeaders.tsx","lines":"143-177","symbol":"togglePresentationMode","kind":"function","export":"internal","signature":"(): Promise<void>","governs":{"ui":"none","state":"manages presentation mode state and CSS variables","data":"none","routing":"none","side_effects":"CSS custom property manipulation, column change signal emission","auth":"none","errors":"none","dependencies":["useCallback","document.documentElement","useColumnChangeEmitter"]},"calls":["document.documentElement.style.setProperty","setIsPresentationMode","console.log","useColumnChangeEmitter"],"called_by":["presentation mode button"],"related_files":["client/src/hooks/useColumnChangeSignal.ts"],"query_or_table_refs":[],"notes":"Presentation toggle: scales width x2, text x1.5, row height x1.35, emits column change signals, toggles state"}
{"file":"client/src/components/bible/NewColumnHeaders.tsx","lines":"198-222","symbol":"getResponsiveWidth","kind":"function","export":"internal","signature":"(columnType: string): string","governs":{"ui":"none","state":"none","data":"none","routing":"none","side_effects":"none","auth":"none","errors":"none","dependencies":["window.innerHeight","window.innerWidth"]},"calls":["window.innerHeight","window.innerWidth"],"called_by":["column width calculations"],"related_files":[],"query_or_table_refs":[],"notes":"Responsive width calculator: returns CSS calc expressions with column-width-mult variable, handles portrait/landscape modes"}
{"file":"client/src/components/bible/ColumnNavigationArrows.tsx","lines":"13-178","symbol":"ColumnNavigationArrows","kind":"react_component","export":"named","signature":"(props: ColumnNavigationArrowsProps): JSX.Element | null","governs":{"ui":"renders left/right navigation arrows with column indicator","state":"manages visible range state and navigation capabilities","data":"none","routing":"none","side_effects":"scroll event listening, column scrolling operations","auth":"none","errors":"none","dependencies":["useBibleStore","makeColumnScroller","ChevronLeft","ChevronRight"]},"calls":["useBibleStore","useMemo","useState","useEffect","buildActiveColumns","filter","map","makeColumnScroller","addEventListener","removeEventListener","console.log"],"called_by":["NewColumnHeaders"],"related_files":["client/src/utils/scrollNav.ts"],"query_or_table_refs":[],"notes":"Column navigation: left/right arrows with enable/disable states, column indicator (start-end/total), scroll event handling, column scroller integration"}
{"file":"client/src/components/bible/TopHeader.tsx","lines":"31-409","symbol":"TopHeader","kind":"react_component","export":"named","signature":"(props: TopHeaderProps): JSX.Element","governs":{"ui":"renders main application header with navigation, search, bookmarks, and user controls","state":"manages modal states, responsive layout detection","data":"none","routing":"handles back/forward navigation","side_effects":"bookmark creation, navigation callbacks, modal display","auth":"integrates user authentication and profile","errors":"handles bookmark creation failures","dependencies":["useAuth","useTheme","useToast","useMutation","BookmarkButton","UserProfileDropdown","AuthModals"]},"calls":["useAuth","useTheme","useToast","useMutation","useState","useWindowSize","useBibleStore","useAdaptiveScaling","supabase.from.upsert","queryClient.invalidateQueries","getCurrentCentralVerse","JSON.parse","localStorage.getItem"],"called_by":["main application layout"],"related_files":["client/src/components/user/BookmarkButton.tsx","client/src/components/auth/UserProfileDropdown.tsx","client/src/components/auth/AuthModals.tsx","client/src/components/bible/BookmarkModal.tsx"],"query_or_table_refs":["bookmarks"],"notes":"Top header: responsive mobile/desktop layouts, navigation controls, search integration, bookmark creation with Supabase, theme switching, authentication"}
{"file":"client/src/components/bible/TopHeader.tsx","lines":"58-78","symbol":"getCurrentCentralVerse","kind":"function","export":"internal","signature":"(): { reference: string; index: number }","governs":{"ui":"none","state":"none","data":"none","routing":"none","side_effects":"localStorage access","auth":"none","errors":"handles errors with fallback verse","dependencies":["getCurrentVerse","localStorage","bibleStore"]},"calls":["getCurrentVerse","JSON.parse","localStorage.getItem","console.log","console.error"],"called_by":["bookmark creation"],"related_files":[],"query_or_table_refs":[],"notes":"Central verse getter: uses table ref or localStorage fallback, provides error handling with Gen.1:1 default"}
{"file":"client/src/components/bible/TopHeader.tsx","lines":"81-127","symbol":"createBookmarkMutation","kind":"mutation","export":"internal","signature":"useMutation configuration","governs":{"ui":"none","state":"none","data":"none","routing":"none","side_effects":"bookmark database operations, query cache invalidation, toast notifications","auth":"requires authenticated user","errors":"handles bookmark creation failures with error toasts","dependencies":["useMutation","supabase","useQueryClient","useToast"]},"calls":["supabase.from.upsert","queryClient.invalidateQueries","toast","console.error","getCurrentCentralVerse"],"called_by":["bookmark save functionality"],"related_files":[],"query_or_table_refs":["bookmarks"],"notes":"Bookmark mutation: uses Supabase upsert with composite key (user_id, name), handles conflicts, invalidates cache, error handling"}
{"file":"client/src/components/bible/HamburgerMenu.tsx","lines":"27-576","symbol":"HamburgerMenu","kind":"react_component","export":"named","signature":"(props: HorizontalMenuProps): JSX.Element | null","governs":{"ui":"renders slide-out menu with tabbed interface for Bible study settings","state":"manages active tab, bookmark form, and local UI state","data":"none","routing":"none","side_effects":"bookmark creation, store state mutations, navigation callbacks","auth":"integrates user authentication for bookmarks","errors":"handles bookmark creation failures","dependencies":["useBibleStore","useAuth","useToast","useMutation","BookmarksList","LabelsLegend","MainTranslationSelector","AlternateTranslationSelector"]},"calls":["useState","useBibleStore","useAuth","useToast","useMutation","useQueryClient","apiRequest","toast","createBookmarkMutation.mutate","handleOverlayClick"],"called_by":["main application layout"],"related_files":["client/src/components/user/BookmarksList.tsx","client/src/components/bible/LabelsLegend.tsx","client/src/components/bible/MainTranslationSelector.tsx","client/src/components/bible/AlternateTranslationSelector.tsx"],"query_or_table_refs":["bookmarks"],"notes":"Hamburger menu: 8 tabbed sections (translations, labels, study tools, display, theme, bookmarks, docs), store integration, bookmark management"}
{"file":"client/src/components/bible/HamburgerMenu.tsx","lines":"73-98","symbol":"createBookmarkMutation","kind":"mutation","export":"internal","signature":"useMutation configuration","governs":{"ui":"none","state":"none","data":"none","routing":"none","side_effects":"bookmark creation, query cache invalidation, toast notifications, form reset","auth":"requires authenticated user","errors":"handles bookmark creation failures with error toasts","dependencies":["useMutation","apiRequest","useQueryClient","useToast"]},"calls":["apiRequest","queryClient.invalidateQueries","toast","setShowBookmarkForm","setBookmarkName"],"called_by":["bookmark creation functionality"],"related_files":[],"query_or_table_refs":["bookmarks"],"notes":"Bookmark mutation: API request-based bookmark creation, cache invalidation, success/error handling, form state reset"}
{"file":"client/src/components/bible/MainTranslationSelector.tsx","lines":"13-59","symbol":"MainTranslationSelector","kind":"react_component","export":"named","signature":"(props: MainTranslationSelectorProps): JSX.Element","governs":{"ui":"renders radio group for main translation selection","state":"none","data":"none","routing":"none","side_effects":"translation loading, store updates, callback execution","auth":"none","errors":"handles translation switching failures","dependencies":["useTranslationMaps","useEnsureTranslationLoaded","RadioGroup","Label"]},"calls":["useTranslationMaps","useEnsureTranslationLoaded","ensureTranslationLoaded","setMain","console.log","console.error","onUpdate"],"called_by":["HamburgerMenu"],"related_files":["client/src/store/translationSlice.ts","client/src/hooks/useEnsureTranslationLoaded.ts"],"query_or_table_refs":[],"notes":"Main translation selector: 12 available translations, ensures data loading before switching, updates store, triggers re-renders"}
{"file":"client/src/components/bible/MainTranslationSelector.tsx","lines":"17-33","symbol":"handleMainChange","kind":"function","export":"internal","signature":"(value: string): Promise<void>","governs":{"ui":"none","state":"none","data":"none","routing":"none","side_effects":"translation data loading, store updates, callback execution","auth":"none","errors":"handles translation loading failures","dependencies":["ensureTranslationLoaded","setMain","onUpdate"]},"calls":["ensureTranslationLoaded","setMain","onUpdate","console.log","console.error"],"called_by":["radio group value change"],"related_files":[],"query_or_table_refs":[],"notes":"Translation change handler: loads translation from Supabase, updates store, triggers re-render, comprehensive error handling"}
{"file":"client/src/lib/supabaseClient.ts","lines":"1-211","symbol":"supabaseClient","kind":"module","export":"named","signature":"Supabase client configuration and caching system","governs":{"ui":"none","state":"none","data":"provides central data access and caching infrastructure","routing":"none","side_effects":"global Supabase client creation, LRU cache management","auth":"none directly","errors":"handles missing environment variables","dependencies":["@supabase/supabase-js","globalThis"]},"calls":["createClient","console.log","console.error","Date.now","JSON.parse","supabase.storage.download"],"called_by":["all data access operations"],"related_files":["client/src/data/BibleDataAPI.ts"],"query_or_table_refs":[],"notes":"Supabase client: singleton pattern, LRU cache (max 12 translations), master cache for performance, verse keys loading, translation caching"}
{"file":"client/src/lib/supabaseClient.ts","lines":"34-84","symbol":"LRUCache","kind":"class","export":"internal","signature":"class LRUCache","governs":{"ui":"none","state":"manages cache entries with LRU eviction","data":"none","routing":"none","side_effects":"cache entry management, LRU eviction","auth":"none","errors":"none","dependencies":["Map","Date"]},"calls":["Map","Date.now","console.log"],"called_by":["masterCache operations"],"related_files":[],"query_or_table_refs":[],"notes":"LRU cache implementation: max 12 entries, timestamp and access count tracking, automatic eviction of oldest entries"}
{"file":"client/src/lib/supabaseClient.ts","lines":"90-116","symbol":"loadVerseKeys","kind":"function","export":"named","signature":"(): Promise<string[]>","governs":{"ui":"none","state":"manages verse keys cache","data":"none","routing":"none","side_effects":"Supabase storage download, cache population","auth":"none","errors":"handles storage download failures","dependencies":["supabase.storage","JSON.parse"]},"calls":["supabase.storage.from.download","data.text","JSON.parse","console.log","console.error"],"called_by":["verse navigation systems"],"related_files":[],"query_or_table_refs":[],"notes":"Verse keys loader: downloads from private anointed bucket, caches results, loads verseKeys-canonical.json"}
{"file":"client/src/lib/supabaseClient.ts","lines":"119-211","symbol":"loadTranslationSecure","kind":"function","export":"named","signature":"(translationId: string): Promise<Map<string, string>>","governs":{"ui":"none","state":"none","data":"none","routing":"none","side_effects":"translation loading with master cache","auth":"none","errors":"handles translation loading failures","dependencies":["masterCache","supabase.storage"]},"calls":["masterCache.has","masterCache.get","console.log"],"called_by":["translation loading operations"],"related_files":[],"query_or_table_refs":[],"notes":"Secure translation loader: uses master cache, loads from private bucket, returns Map for verse lookup"}
{"file":"client/src/data/BibleDataAPI.ts","lines":"1-665","symbol":"BibleDataAPI","kind":"module","export":"named","signature":"Central data API for all Bible content operations","governs":{"ui":"none","state":"none","data":"provides unified interface for all Bible data (translations, cross-refs, prophecy, dates, labels)","routing":"none","side_effects":"Supabase storage operations, master cache management","auth":"none directly","errors":"handles storage failures and fallbacks","dependencies":["supabase","masterCache","offlineDB","queueSync"]},"calls":["supabase.storage.download","supabase.storage.upload","masterCache.has","masterCache.get","masterCache.set","JSON.parse","fetchFromStorage"],"called_by":["all Bible data consumers"],"related_files":["client/src/lib/supabaseClient.ts","client/src/offline/offlineDB.ts"],"query_or_table_refs":[],"notes":"Bible Data API: canonical bucket paths, master cache integration, translation/cross-ref/prophecy/dates/labels loading, offline support"}
{"file":"client/src/data/BibleDataAPI.ts","lines":"24-32","symbol":"fetchFromStorage","kind":"function","export":"named","signature":"(path: string): Promise<string>","governs":{"ui":"none","state":"none","data":"none","routing":"none","side_effects":"Supabase storage download operations","auth":"none","errors":"handles storage download failures","dependencies":["supabase.storage"]},"calls":["supabase.storage.from.download","data.text"],"called_by":["all data loading operations"],"related_files":[],"query_or_table_refs":[],"notes":"Storage fetcher: downloads from anointed bucket, converts to text, centralized error handling"}
{"file":"client/src/data/BibleDataAPI.ts","lines":"70-79","symbol":"getOrFetch","kind":"function","export":"internal","signature":"<T>(key: string, fetchFn: () => Promise<T>): Promise<T>","governs":{"ui":"none","state":"none","data":"none","routing":"none","side_effects":"master cache operations","auth":"none","errors":"none","dependencies":["masterCache"]},"calls":["masterCache.has","masterCache.get","masterCache.set"],"called_by":["all cached data operations"],"related_files":[],"query_or_table_refs":[],"notes":"Cache-or-fetch helper: checks master cache first, executes fetch function if needed, caches result"}
{"file":"client/src/data/BibleDataAPI.ts","lines":"81-113","symbol":"loadTranslation","kind":"function","export":"named","signature":"(id: string): Promise<Map<string, string>>","governs":{"ui":"none","state":"none","data":"none","routing":"none","side_effects":"translation loading and caching","auth":"none","errors":"none","dependencies":["masterCache","fetchFromStorage","regex parsing"]},"calls":["masterCache.has","masterCache.get","fetchFromStorage","line.match","masterCache.set","console.log"],"called_by":["translation systems"],"related_files":[],"query_or_table_refs":[],"notes":"Translation loader: optimized regex parsing, immediate cache storage, returns Map for verse lookup, handles reference#text format"}
{"file":"client/src/data/BibleDataAPI.ts","lines":"121-153","symbol":"loadVerseKeys","kind":"function","export":"named","signature":"(chronological?: boolean): Promise<string[]>","governs":{"ui":"none","state":"none","data":"none","routing":"none","side_effects":"verse keys loading with chronological/canonical fallback","auth":"none","errors":"handles missing chronological files with canonical fallback","dependencies":["getOrFetch","fetchFromStorage","JSON.parse"]},"calls":["getOrFetch","fetchFromStorage","JSON.parse","console.log","console.warn"],"called_by":["verse navigation and ordering systems"],"related_files":[],"query_or_table_refs":[],"notes":"Verse keys loader: supports canonical/chronological modes, automatic fallback to canonical if chronological missing, comprehensive logging"}
{"file":"client/src/data/BibleDataAPI.ts","lines":"44-68","symbol":"loadDatesMap","kind":"function","export":"named","signature":"(chronological?: boolean): Promise<Map<string, string>>","governs":{"ui":"none","state":"none","data":"none","routing":"none","side_effects":"dates data loading and parsing","auth":"none","errors":"none","dependencies":["getOrFetch","fetchFromStorage","Map"]},"calls":["getOrFetch","fetchFromStorage","split","trim","Map.set","console.log"],"called_by":["date display systems"],"related_files":[],"query_or_table_refs":[],"notes":"Dates map loader: parses verse_reference#date_info format, returns Map for verse lookup, supports canonical/chronological modes"}
{"file":"client/src/components/bible/AlternateTranslationSelector.tsx","lines":"13-66","symbol":"AlternateTranslationSelector","kind":"react_component","export":"named","signature":"(props: AlternateTranslationSelectorProps): JSX.Element","governs":{"ui":"renders checkbox grid for alternate translation selection","state":"none","data":"none","routing":"none","side_effects":"translation loading, store updates, callback execution","auth":"none","errors":"handles translation loading failures","dependencies":["useTranslationMaps","useEnsureTranslationLoaded","Checkbox","Label"]},"calls":["useTranslationMaps","useEnsureTranslationLoaded","filter","includes","map","ensureTranslationLoaded","toggleAlternate","console.log","console.error","onUpdate"],"called_by":["HamburgerMenu"],"related_files":["client/src/store/translationSlice.ts","client/src/hooks/useEnsureTranslationLoaded.ts"],"query_or_table_refs":[],"notes":"Alternate translation selector: 12 available translations excluding main, checkbox grid, ensures data loading before toggling, slots 5-16 display"}
{"file":"client/src/components/bible/AlternateTranslationSelector.tsx","lines":"17-29","symbol":"handleAlternateToggle","kind":"function","export":"internal","signature":"(translationId: string, checked: boolean): Promise<void>","governs":{"ui":"none","state":"none","data":"none","routing":"none","side_effects":"translation data loading, store updates, callback execution","auth":"none","errors":"handles translation loading failures","dependencies":["ensureTranslationLoaded","toggleAlternate","onUpdate"]},"calls":["ensureTranslationLoaded","toggleAlternate","onUpdate","console.log","console.error"],"called_by":["checkbox change handlers"],"related_files":[],"query_or_table_refs":[],"notes":"Alternate toggle handler: loads translation if checked, updates store, triggers re-render, comprehensive error handling"}
{"file":"client/src/components/bible/LabeledText.tsx","lines":"15-66","symbol":"LabeledText","kind":"react_component","export":"default","signature":"(props: Props): JSX.Element","governs":{"ui":"renders text segments with semantic label styling","state":"none","data":"none","routing":"none","side_effects":"none","auth":"none","errors":"none","dependencies":["useLabeledText","classesForMask","LabelName"]},"calls":["useLabeledText","classesForMask","text.slice","map","console.log"],"called_by":["CrossReferencesCell","ProphecyCell"],"related_files":["client/src/hooks/useLabeledText.ts","client/src/lib/labelRenderer.ts","client/src/lib/labelBits.ts"],"query_or_table_refs":[],"notes":"Labeled text: applies semantic styling to text segments based on label masks, handles empty text with loading state, type-safe label conversion"}
{"file":"client/src/components/bible/LabelsLegend.tsx","lines":"25-119","symbol":"LabelsLegend","kind":"react_component","export":"named","signature":"(props: LabelsLegendProps): JSX.Element","governs":{"ui":"renders semantic label legend with checkboxes and effects preview","state":"manages label cache loading and translation changes","data":"none","routing":"none","side_effects":"label cache operations, store updates","auth":"none","errors":"handles label loading failures","dependencies":["useBibleStore","ensureLabelCacheLoaded","clearLabelCacheForTranslation","Checkbox","Label"]},"calls":["useBibleStore","useState","useEffect","ensureLabelCacheLoaded","clearLabelCacheForTranslation","setActiveLabels","filter","includes","console.error"],"called_by":["HamburgerMenu"],"related_files":["client/src/lib/labelsCache.ts","client/src/lib/labelBits.ts"],"query_or_table_refs":[],"notes":"Labels legend: 10 semantic labels (who/what/when/where/command/action/why/seed/harvest/prediction), cache management, clear all functionality"}
{"file":"client/src/components/bible/LabelsLegend.tsx","lines":"51-70","symbol":"handleLabelToggle","kind":"function","export":"internal","signature":"(labelKey: LabelName, checked: boolean): Promise<void>","governs":{"ui":"none","state":"none","data":"none","routing":"none","side_effects":"label store updates, cache loading","auth":"none","errors":"handles label cache loading failures","dependencies":["setActiveLabels","ensureLabelCacheLoaded"]},"calls":["setActiveLabels","ensureLabelCacheLoaded","filter","console.error"],"called_by":["checkbox change handlers"],"related_files":[],"query_or_table_refs":[],"notes":"Label toggle handler: adds/removes labels from active set, ensures cache loaded when adding, maintains up to 10 search history"}
{"file":"client/src/components/bible/SearchModal.tsx","lines":"39-852","symbol":"SearchModal","kind":"react_component","export":"named","signature":"(props: SearchModalProps): JSX.Element","governs":{"ui":"renders comprehensive Bible search interface with advanced features","state":"manages search query, results, history, navigation, and translation selection","data":"none","routing":"none","side_effects":"translation loading, search execution, navigation callbacks","auth":"none","errors":"handles translation loading and search failures","dependencies":["BibleSearchEngine","useTranslationMaps","Dialog","Tabs","LoadingWheel","ScrollWheelSelector"]},"calls":["useState","useEffect","useMemo","useRef","useIsMobile","useTranslationMaps","BibleSearchEngine","loadTranslationForSearch","performSearch","console.log","console.error","console.warn"],"called_by":["main application search functionality"],"related_files":["client/src/lib/bibleSearchEngine.ts","client/src/hooks/useTranslationMaps.ts","client/src/components/bible/ScrollWheelSelector.tsx"],"query_or_table_refs":[],"notes":"Search modal: comprehensive search with multiple translations, advanced navigation, search history, result highlighting, mobile responsive"}
{"file":"client/src/components/bible/SearchModal.tsx","lines":"15-29","symbol":"useIsMobile","kind":"custom_hook","export":"internal","signature":"(): boolean","governs":{"ui":"none","state":"manages mobile detection state","data":"none","routing":"none","side_effects":"window resize event listening","auth":"none","errors":"none","dependencies":["useState","useEffect","window.addEventListener"]},"calls":["useState","useEffect","window.innerWidth","window.addEventListener","window.removeEventListener"],"called_by":["SearchModal"],"related_files":[],"query_or_table_refs":[],"notes":"Mobile detection hook: monitors window width (<768px), handles resize events, provides mobile state"}
{"file":"client/src/components/bible/SearchModal.tsx","lines":"66-85","symbol":"loadTranslationForSearch","kind":"function","export":"internal","signature":"(translationCode: string): Promise<Map<string, string> | null>","governs":{"ui":"none","state":"manages loaded translations cache","data":"none","routing":"none","side_effects":"dynamic translation loading, cache updates","auth":"none","errors":"handles translation loading failures","dependencies":["loadedTranslations","loadTranslation","setLoadedTranslations"]},"calls":["loadedTranslations.has","loadedTranslations.get","import","loadTranslation","setLoadedTranslations"],"called_by":["search functionality"],"related_files":["client/src/data/BibleDataAPI.ts"],"query_or_table_refs":[],"notes":"Translation loader for search: caches loaded translations, dynamic import of BibleDataAPI, handles loading failures gracefully"}
{"file":"client/src/components/bible/SearchModal.tsx","lines":"149-225","symbol":"performSearch","kind":"function","export":"internal","signature":"(): Promise<void>","governs":{"ui":"none","state":"manages search state and results","data":"none","routing":"none","side_effects":"search execution, history updates, translation loading","auth":"none","errors":"none","dependencies":["searchQuery","selectedTranslations","searchHistory","setSearchHistory","setIsSearching"]},"calls":["setIsSearching","setHasSearched","setSelectedResultIndex","setSearchHistory","loadTranslationForSearch","getVerseText","toLowerCase","includes","replace","console.log","console.warn"],"called_by":["search triggers"],"related_files":[],"query_or_table_refs":[],"notes":"Search performer: direct text matching across translations, highlighted results, search history management, loads additional translations as needed"}
{"file":"client/src/components/bible/StrongsDetailDrawer.tsx","lines":"24-177","symbol":"StrongsDetailDrawer","kind":"react_component","export":"named","signature":"(props: StrongsDetailDrawerProps): JSX.Element","governs":{"ui":"renders detailed Strong's concordance word analysis modal","state":"manages active tab between definition and verses","data":"none","routing":"none","side_effects":"navigation callbacks, modal closure","auth":"none","errors":"none","dependencies":["motion","AnimatePresence","Button","ScrollArea","Badge"]},"calls":["useState","motion.div","AnimatePresence","setActiveTab","onNavigateToVerse","onClose","map"],"called_by":["Strong's word analysis features"],"related_files":[],"query_or_table_refs":[],"notes":"Strong's drawer: two-tab interface (definition/related verses), animated modal with Hebrew/Greek word display, pronunciation guide, navigation to related verses"}
{"file":"client/src/components/bible/ProphecyDetailDrawer.tsx","lines":"26-205","symbol":"ProphecyDetailDrawer","kind":"react_component","export":"named","signature":"(props: ProphecyDetailDrawerProps): JSX.Element","governs":{"ui":"renders prophecy detail drawer with three-tab interface","state":"manages prophecy loading, active tab state","data":"none","routing":"none","side_effects":"prophecy data loading, navigation callbacks","auth":"none","errors":"handles prophecy loading failures","dependencies":["Sheet","Tabs","Badge","Button","LoadingWheel","ScrollArea"]},"calls":["useState","useEffect","loadProphecyDetails","setIsLoading","setProphecyDetails","setActiveTab","onNavigateToVerse","onClose","map","console.error"],"called_by":["prophecy tracking systems"],"related_files":[],"query_or_table_refs":[],"notes":"Prophecy drawer: three tabs (predictions/fulfillments/verifications), mock data structure, animated sheet interface, verse navigation"}
{"file":"client/src/components/bible/ProphecyDetailDrawer.tsx","lines":"42-62","symbol":"loadProphecyDetails","kind":"function","export":"internal","signature":"(): Promise<void>","governs":{"ui":"none","state":"manages prophecy loading state","data":"none","routing":"none","side_effects":"prophecy data loading (mock currently)","auth":"none","errors":"handles loading failures","dependencies":["prophecyIds","setProphecyDetails","setIsLoading"]},"calls":["setIsLoading","map","setProphecyDetails","console.error"],"called_by":["useEffect trigger"],"related_files":[],"query_or_table_refs":[],"notes":"Prophecy loader: creates mock data for prophecy IDs, tracks loading state, handles errors"}
{"file":"client/src/components/bible/ProphecyDetailDrawer.tsx","lines":"64-67","symbol":"handleVerseClick","kind":"function","export":"internal","signature":"(verseReference: string): void","governs":{"ui":"none","state":"none","data":"none","routing":"none","side_effects":"navigation callback, modal closure","auth":"none","errors":"none","dependencies":["onNavigateToVerse","onClose"]},"calls":["onNavigateToVerse","onClose"],"called_by":["verse click handlers"],"related_files":[],"query_or_table_refs":[],"notes":"Verse click handler: navigates to verse and closes modal"}
{"file":"client/src/components/bible/ProphecyDetailDrawer.tsx","lines":"69-95","symbol":"renderVerseList","kind":"function","export":"internal","signature":"(verses: string[], icon: React.ReactNode, emptyMessage: string): JSX.Element","governs":{"ui":"renders verse list with navigation buttons","state":"none","data":"none","routing":"none","side_effects":"none","auth":"none","errors":"none","dependencies":["Button","ExternalLink","handleVerseClick"]},"calls":["map","handleVerseClick"],"called_by":["tab content renderers"],"related_files":[],"query_or_table_refs":[],"notes":"Verse list renderer: displays verses as clickable buttons with icons, handles empty states"}
{"file":"client/src/components/bible/VerseSelector.tsx","lines":"92-271","symbol":"VerseSelector","kind":"react_component","export":"named","signature":"(props: VerseSelectorProps): JSX.Element","governs":{"ui":"renders verse navigation selector with book/chapter/verse dropdowns","state":"manages book/chapter/verse selection, modal open state, random verses","data":"none","routing":"none","side_effects":"navigation callbacks","auth":"none","errors":"none","dependencies":["Select","Button","useAuth","useWindowSize"]},"calls":["useState","useAuth","useWindowSize","find","getRandomCuratedVerses","handleNavigate","handleQuickNavigate","setIsOpen","onNavigate"],"called_by":["main navigation systems"],"related_files":["client/src/hooks/useAuth.ts"],"query_or_table_refs":[],"notes":"Verse selector: 66 Bible books with chapter/verse counts, curated verse shortcuts, authentication-aware display, mobile responsive"}
{"file":"client/src/components/bible/VerseSelector.tsx","lines":"124-127","symbol":"getRandomCuratedVerses","kind":"function","export":"internal","signature":"(): string[]","governs":{"ui":"none","state":"none","data":"none","routing":"none","side_effects":"none","auth":"none","errors":"none","dependencies":["curatedVerses"]},"calls":["sort","slice","Math.random"],"called_by":["component initialization"],"related_files":[],"query_or_table_refs":[],"notes":"Random verse selector: shuffles curated list of 20 verses, returns 3 random selections"}
{"file":"client/src/components/bible/VerseSelector.tsx","lines":"105-109","symbol":"handleNavigate","kind":"function","export":"internal","signature":"(): void","governs":{"ui":"none","state":"none","data":"none","routing":"none","side_effects":"navigation callback, modal closure","auth":"none","errors":"none","dependencies":["selectedBook","selectedChapter","selectedVerse","onNavigate","setIsOpen"]},"calls":["onNavigate","setIsOpen"],"called_by":["navigation triggers"],"related_files":[],"query_or_table_refs":[],"notes":"Navigation handler: constructs reference from selected book/chapter/verse, triggers callback, closes modal"}
{"file":"client/src/components/bible/VerseSelector.tsx","lines":"111-114","symbol":"handleQuickNavigate","kind":"function","export":"internal","signature":"(ref: string): void","governs":{"ui":"none","state":"none","data":"none","routing":"none","side_effects":"navigation callback, modal closure","auth":"none","errors":"none","dependencies":["onNavigate","setIsOpen"]},"calls":["onNavigate","setIsOpen"],"called_by":["quick navigation buttons"],"related_files":[],"query_or_table_refs":[],"notes":"Quick navigation: handles predefined verse shortcuts, closes modal"}
{"file":"client/src/hooks/useAuth.ts","lines":"5-101","symbol":"useAuth","kind":"custom_hook","export":"named","signature":"(): AuthHookReturn","governs":{"ui":"none","state":"manages user authentication state and loading","data":"none","routing":"none","side_effects":"Supabase auth operations, localStorage updates","auth":"provides authentication interface","errors":"handles auth operation failures","dependencies":["supabase","User"]},"calls":["useState","useEffect","supabase.auth.getUser","supabase.auth.signInWithPassword","supabase.auth.signUp","supabase.auth.signOut","setUser","setLoading","console.info","console.error"],"called_by":["authentication components","VerseSelector","other auth-dependent components"],"related_files":["client/src/lib/supabaseClient.ts","shared/schema.ts"],"query_or_table_refs":[],"notes":"Auth hook: manages Supabase authentication, provides signIn/signUp/signOut methods, maps Supabase user to local User type, handles loading states"}
{"file":"client/src/hooks/useAuth.ts","lines":"11-31","symbol":"checkAuth","kind":"function","export":"internal","signature":"(): Promise<void>","governs":{"ui":"none","state":"manages user state","data":"none","routing":"none","side_effects":"user session checking","auth":"checks authentication status","errors":"handles auth check failures","dependencies":["supabase.auth.getUser","setUser","setLoading"]},"calls":["supabase.auth.getUser","setUser","setLoading","console.info"],"called_by":["useEffect on mount"],"related_files":[],"query_or_table_refs":[],"notes":"Auth checker: verifies current session, maps Supabase user to local format, handles missing sessions gracefully"}
{"file":"client/src/hooks/useAuth.ts","lines":"33-55","symbol":"signIn","kind":"function","export":"internal","signature":"(email: string, password: string): Promise<AuthResult>","governs":{"ui":"none","state":"updates user state on success","data":"none","routing":"none","side_effects":"Supabase sign-in operation","auth":"performs user sign-in","errors":"returns error messages on failure","dependencies":["supabase.auth.signInWithPassword","setUser"]},"calls":["supabase.auth.signInWithPassword","setUser"],"called_by":["sign-in forms"],"related_files":[],"query_or_table_refs":[],"notes":"Sign-in method: handles password authentication, returns success/error result, updates user state"}
{"file":"client/src/hooks/useAuth.ts","lines":"57-82","symbol":"signUp","kind":"function","export":"internal","signature":"(email: string, password: string, name: string): Promise<AuthResult>","governs":{"ui":"none","state":"updates user state on success","data":"none","routing":"none","side_effects":"Supabase sign-up operation","auth":"performs user registration","errors":"returns error messages on failure","dependencies":["supabase.auth.signUp","setUser"]},"calls":["supabase.auth.signUp","setUser"],"called_by":["registration forms"],"related_files":[],"query_or_table_refs":[],"notes":"Sign-up method: handles user registration with metadata, returns success/error result, updates user state"}
{"file":"client/src/hooks/useAuth.ts","lines":"84-91","symbol":"signOut","kind":"function","export":"internal","signature":"(): Promise<void>","governs":{"ui":"none","state":"clears user state","data":"none","routing":"none","side_effects":"Supabase sign-out operation","auth":"performs user sign-out","errors":"logs errors","dependencies":["supabase.auth.signOut","setUser"]},"calls":["supabase.auth.signOut","setUser","console.error"],"called_by":["sign-out actions"],"related_files":[],"query_or_table_refs":[],"notes":"Sign-out method: clears session and user state, handles errors gracefully"}
{"file":"client/src/hooks/useBibleData.ts","lines":"1-1519","symbol":"useBibleData","kind":"custom_hook","export":"default","signature":"(): BibleDataReturn","governs":{"ui":"none","state":"manages Bible data loading and verse state","data":"loads complete Bible index and translations","routing":"none","side_effects":"Supabase data loading, master cache operations, translation loading","auth":"none","errors":"handles data loading failures","dependencies":["useQuery","supabase","masterCache","useTranslationMaps","loadTranslation","loadVerseKeys"]},"calls":["useQuery","useState","useEffect","useRef","useTranslationMaps","loadFullBibleIndex","createFullBibleIndexWithoutText","loadKJVTextMap","loadAdditionalData","parseActualSupabaseKJV","createFullBibleWithHeights","console.log","console.error"],"called_by":["main application Bible data management"],"related_files":["client/src/data/BibleDataAPI.ts","client/src/hooks/useTranslationMaps.ts","client/src/lib/supabaseClient.ts"],"query_or_table_refs":[],"notes":"Bible data hook: loads 31,102 verses, supports chronological/canonical ordering, anchor-centered virtual scrolling, master cache integration, dynamic text loading"}
{"file":"client/src/hooks/useBibleData.ts","lines":"20-36","symbol":"loadKJVTextMap","kind":"function","export":"internal","signature":"(): Promise<void>","governs":{"ui":"none","state":"manages global KJV text map","data":"loads KJV translation from BibleDataAPI","routing":"none","side_effects":"global variable updates, master cache operations","auth":"none","errors":"handles KJV loading failures","dependencies":["globalKjvTextMap","loadTranslation"]},"calls":["import","loadTranslation","console.log","console.error"],"called_by":["Bible data initialization"],"related_files":["client/src/data/BibleDataAPI.ts"],"query_or_table_refs":[],"notes":"KJV loader: populates global text map for dynamic verse loading, optimized for speed, background loading"}
{"file":"client/src/hooks/useBibleData.ts","lines":"39-91","symbol":"loadFullBibleIndex","kind":"function","export":"internal","signature":"(progressCallback?: Function, isChronological?: boolean): Promise<BibleVerse[]>","governs":{"ui":"none","state":"none","data":"loads complete Bible verse index","routing":"none","side_effects":"verse keys loading, KJV text loading, progress callbacks","auth":"none","errors":"handles Supabase loading failures","dependencies":["loadVerseKeys","loadKJVTextMap","createFullBibleIndexWithoutText"]},"calls":["loadVerseKeys","loadKJVTextMap","createFullBibleIndexWithoutText","progressCallback","console.log","console.error"],"called_by":["Bible data initialization"],"related_files":["client/src/data/BibleDataAPI.ts"],"query_or_table_refs":[],"notes":"Bible index loader: supports canonical/chronological modes, creates placeholder text structure, enables proper height mapping"}
{"file":"client/src/hooks/useBibleData.ts","lines":"94-140","symbol":"createFullBibleIndexWithoutText","kind":"function","export":"internal","signature":"(verseKeys: string[]): BibleVerse[]","governs":{"ui":"none","state":"none","data":"creates Bible verse structures","routing":"none","side_effects":"none","auth":"none","errors":"none","dependencies":["verseKeys"]},"calls":["map","split","parseInt","console.log"],"called_by":["loadFullBibleIndex"],"related_files":[],"query_or_table_refs":[],"notes":"Index creator: maps verse keys to BibleVerse objects, handles multiple reference formats, creates empty text objects for dynamic loading"}
{"file":"client/src/hooks/useBibleData.ts","lines":"142-172","symbol":"loadAdditionalData","kind":"function","export":"internal","signature":"(verses: BibleVerse[]): Promise<void>","governs":{"ui":"none","state":"none","data":"loads cross-references and prophecy data","routing":"none","side_effects":"Supabase storage downloads","auth":"none","errors":"handles missing additional data files","dependencies":["supabase.storage"]},"calls":["supabase.storage.from.download","data.text","console.log","console.warn"],"called_by":["Bible data initialization"],"related_files":["client/src/lib/supabaseClient.ts"],"query_or_table_refs":[],"notes":"Additional data loader: loads cross-references (cf1.txt) and prophecy data, handles missing files gracefully"}
{"file":"client/src/hooks/useBibleData.ts","lines":"369-499","symbol":"createFullBibleWithHeights","kind":"function","export":"internal","signature":"(verseKeys: string[]): Promise<BibleVerse[]>","governs":{"ui":"none","state":"none","data":"creates Bible with calculated heights for scrolling","routing":"none","side_effects":"KJV text loading, height calculations","auth":"none","errors":"handles text loading failures","dependencies":["loadTranslationAsText","calculateTextHeight","textMap"]},"calls":["loadTranslationAsText","map","match","replace","split","filter","console.log","console.error"],"called_by":["Bible data initialization"],"related_files":["client/src/data/BibleDataAPI.ts"],"query_or_table_refs":[],"notes":"Bible with heights: fixed 120px height for stable scrolling, comprehensive text map with multiple key formats, global KJV storage"}
{"file":"client/src/hooks/useTranslationMaps.ts","lines":"32-219","symbol":"useTranslationMaps","kind":"custom_hook","export":"named","signature":"(): UseTranslationMapsReturn","governs":{"ui":"none","state":"manages translation loading and selection","data":"none","routing":"none","side_effects":"translation loading, master cache operations, store updates","auth":"none","errors":"handles translation loading failures with toasts","dependencies":["useTranslationStore","masterCache","preloadKJV","loadTranslation"]},"calls":["useTranslationStore","useState","useCallback","useEffect","preloadKJV","isKJVReady","import","loadTranslation","masterCache.has","masterCache.get","translationStore.setMain","translationStore.toggleAlternate","console.log","console.error"],"called_by":["translation components","SearchModal","AlternateTranslationSelector"],"related_files":["client/src/store/translationSlice.ts","client/src/data/BibleDataAPI.ts","client/src/lib/preloader.ts"],"query_or_table_refs":[],"notes":"Translation maps: manages 12 available translations, KJV preloading, master cache integration, Zustand store persistence, loading failure toasts"}
{"file":"client/src/hooks/useTranslationMaps.ts","lines":"96-148","symbol":"toggleTranslation","kind":"function","export":"internal","signature":"(code: string, setAsMain?: boolean): Promise<void>","governs":{"ui":"none","state":"updates translation state via store","data":"none","routing":"none","side_effects":"translation loading, cache operations, store updates, toast notifications","auth":"none","errors":"shows user-visible toasts for failures","dependencies":["masterCache","loadTranslation","translationStore","toast"]},"calls":["setIsLoading","masterCache.has","import","loadTranslation","translationStore.setMain","translationStore.toggleAlternate","toast","console.log","console.error"],"called_by":["translation toggle actions"],"related_files":["client/src/hooks/use-toast.ts"],"query_or_table_refs":[],"notes":"Translation toggler: loads on-demand from BibleDataAPI, validates map size, shows failure toasts, updates persistent store"}
{"file":"client/src/hooks/useTranslationMaps.ts","lines":"169-175","symbol":"getVerseText","kind":"function","export":"internal","signature":"(verseID: string, translationCode: string): string | undefined","governs":{"ui":"none","state":"none","data":"retrieves verse text from cache","routing":"none","side_effects":"none","auth":"none","errors":"none","dependencies":["masterCache"]},"calls":["masterCache.get","translationMap.get"],"called_by":["text display components","SearchModal"],"related_files":[],"query_or_table_refs":[],"notes":"Verse text getter: direct Map lookup, optimized for dot format verse IDs, no per-verse fetching"}
{"file":"client/src/hooks/useTranslationMaps.ts","lines":"181-187","symbol":"getMainVerseText","kind":"function","export":"internal","signature":"(verseID: string): string | undefined","governs":{"ui":"none","state":"none","data":"retrieves main translation verse text","routing":"none","side_effects":"none","auth":"none","errors":"none","dependencies":["masterCache","mainTranslation"]},"calls":["masterCache.get","translationMap.get"],"called_by":["cross-references","prophecy systems","date displays"],"related_files":[],"query_or_table_refs":[],"notes":"Main verse text getter: always uses main translation, used by auxiliary features, direct Map lookup"}
{"file":"client/src/hooks/useEnsureTranslationLoaded.ts","lines":"5-28","symbol":"useEnsureTranslationLoaded","kind":"custom_hook","export":"named","signature":"(): (id: string) => Promise<void>","governs":{"ui":"none","state":"none","data":"none","routing":"none","side_effects":"on-demand translation loading","auth":"none","errors":"handles loading failures","dependencies":["masterCache","loadTranslation"]},"calls":["masterCache.has","loadTranslation","console.log","console.error"],"called_by":["AlternateTranslationSelector","translation switching components"],"related_files":["client/src/data/BibleDataAPI.ts","client/src/lib/supabaseClient.ts"],"query_or_table_refs":[],"notes":"Translation loader helper: ensures translation loaded before switching, checks cache first, provides loading feedback"}
{"file":"client/src/hooks/useLabeledText.ts","lines":"6-50","symbol":"useLabeledText","kind":"custom_hook","export":"named","signature":"(text: string, labelData: Record<string, string[]>, activeLabels: LabelName[]): Segment[]","governs":{"ui":"none","state":"none","data":"none","routing":"none","side_effects":"none","auth":"none","errors":"none","dependencies":["LabelBits","useMemo"]},"calls":["useMemo","forEach","RegExp","exec","sort","push"],"called_by":["LabeledText"],"related_files":["client/src/lib/labelBits.ts"],"query_or_table_refs":[],"notes":"Labeled text: converts text into segments with label masks, handles regex escaping, optimized memoization, supports 10 semantic labels"}
{"file":"client/src/store/translationSlice.ts","lines":"26-92","symbol":"useTranslationMaps","kind":"zustand_store","export":"named","signature":"(): TranslationState","governs":{"ui":"none","state":"manages translation selection state with persistence","data":"none","routing":"none","side_effects":"localStorage persistence, window events for slot visibility","auth":"none","errors":"none","dependencies":["zustand","persist","window.dispatchEvent"]},"calls":["create","persist","set","get","filter","findIndex","window.dispatchEvent","console.log","console.error"],"called_by":["useTranslationMaps hook","translation management components"],"related_files":["client/src/hooks/useTranslationMaps.ts"],"query_or_table_refs":[],"notes":"Translation store: Zustand store with persistence, manages main + alternate translations, slot visibility events, mobile defaults, prevents main demotion"}
{"file":"client/src/store/translationSlice.ts","lines":"6-13","symbol":"getSlotForAlternateIndex","kind":"function","export":"internal","signature":"(index: number): number","governs":{"ui":"none","state":"none","data":"none","routing":"none","side_effects":"none","auth":"none","errors":"none","dependencies":["none"]},"calls":[],"called_by":["toggleAlternate","resetMobileDefaults"],"related_files":[],"query_or_table_refs":[],"notes":"Slot mapper: maps alternate translation index to column slots 12-19, supports maximum 8 alternates"}
{"file":"client/src/store/translationSlice.ts","lines":"31-39","symbol":"setMain","kind":"function","export":"internal","signature":"(id: string): void","governs":{"ui":"none","state":"updates main translation, removes from alternates","data":"none","routing":"none","side_effects":"store state updates","auth":"none","errors":"none","dependencies":["get","set","filter"]},"calls":["get","set","filter"],"called_by":["translation selection actions"],"related_files":[],"query_or_table_refs":[],"notes":"Main setter: updates main translation, removes new main from alternates, prevents duplicate main"}
{"file":"client/src/store/translationSlice.ts","lines":"40-80","symbol":"toggleAlternate","kind":"function","export":"internal","signature":"(id: string): void","governs":{"ui":"none","state":"toggles alternate translation on/off","data":"none","routing":"none","side_effects":"slot visibility events, store updates","auth":"none","errors":"none","dependencies":["get","set","filter","findIndex","window.dispatchEvent","getSlotForAlternateIndex"]},"calls":["get","set","filter","findIndex","window.dispatchEvent","getSlotForAlternateIndex","console.log","console.error"],"called_by":["translation toggle actions"],"related_files":[],"query_or_table_refs":[],"notes":"Alternate toggler: adds/removes alternates, dispatches slot visibility events, prevents main demotion, manages max 8 alternates"}
{"file":"client/src/store/translationSlice.ts","lines":"95-98","symbol":"useColumnKeys","kind":"custom_hook","export":"named","signature":"(): string[]","governs":{"ui":"none","state":"none","data":"none","routing":"none","side_effects":"none","auth":"none","errors":"none","dependencies":["useTranslationMaps"]},"calls":["useTranslationMaps"],"called_by":["column management components"],"related_files":[],"query_or_table_refs":[],"notes":"Column keys: memoized selector for column order, main first then alternates"}
{"file":"client/src/store/useBibleData.ts","lines":"3-8","symbol":"loadTranslationIfNeeded","kind":"function","export":"named","signature":"(id: string): Promise<void>","governs":{"ui":"none","state":"none","data":"none","routing":"none","side_effects":"conditional translation loading","auth":"none","errors":"none","dependencies":["useBibleStore"]},"calls":["useBibleStore.getState"],"called_by":["translation loading systems"],"related_files":["client/src/App.tsx"],"query_or_table_refs":[],"notes":"Translation loader: checks store state, conditionally loads missing translations (implementation incomplete)"}
{"file":"client/src/utils/auth.ts","lines":"3-14","symbol":"sendMagicLink","kind":"function","export":"named","signature":"(email: string): Promise<AuthResponse>","governs":{"ui":"none","state":"none","data":"none","routing":"none","side_effects":"Supabase magic link email sending","auth":"performs magic link authentication","errors":"none","dependencies":["supabase.auth.signInWithOtp","window.location.origin"]},"calls":["window.location.origin","supabase.auth.signInWithOtp"],"called_by":["authentication forms"],"related_files":["client/src/lib/supabaseClient.ts"],"query_or_table_refs":[],"notes":"Magic link sender: generates email redirect URL, sends OTP email via Supabase"}
{"file":"client/src/utils/columnLayout.ts","lines":"30-91","symbol":"computeVisibleRangeDynamic","kind":"function","export":"named","signature":"(p: LayoutParams): LayoutResult","governs":{"ui":"determines visible column range for rendering","state":"none","data":"none","routing":"none","side_effects":"none","auth":"none","errors":"none","dependencies":["LayoutParams","LayoutResult"]},"calls":["Math.max","Math.min","Math.round","map","fitFrom"],"called_by":["column layout systems","VirtualBibleTable"],"related_files":[],"query_or_table_refs":[],"notes":"Column layout: computes visible range with ghost slots, handles trailing clamp, supports measured/base widths with zoom, navigation state"}
{"file":"client/src/utils/themeManager.ts","lines":"6-49","symbol":"applyTheme","kind":"function","export":"named","signature":"(name: ThemeName): void","governs":{"ui":"applies theme to document root","state":"none","data":"none","routing":"none","side_effects":"DOM style property updates, localStorage updates","auth":"none","errors":"none","dependencies":["THEMES","document.documentElement","localStorage"]},"calls":["Array.from","filter","forEach","classList.remove","classList.add","style.setProperty","localStorage.setItem"],"called_by":["theme switching systems"],"related_files":["client/src/themes/registry.ts"],"query_or_table_refs":[],"notes":"Theme applier: removes previous theme classes, sets CSS custom properties, updates Tailwind aliases, persists to localStorage"}
{"file":"client/src/utils/themeManager.ts","lines":"51-55","symbol":"initTheme","kind":"function","export":"named","signature":"(defaultName?: ThemeName): ThemeName","governs":{"ui":"initializes theme on app startup","state":"none","data":"none","routing":"none","side_effects":"theme application","auth":"none","errors":"none","dependencies":["localStorage","applyTheme"]},"calls":["localStorage.getItem","applyTheme"],"called_by":["app initialization"],"related_files":[],"query_or_table_refs":[],"notes":"Theme initializer: loads saved theme from localStorage, applies default if none saved, returns applied theme"}
{"file":"client/src/utils/themeManager.ts","lines":"57-59","symbol":"getCurrentTheme","kind":"function","export":"named","signature":"(): ThemeName","governs":{"ui":"none","state":"none","data":"none","routing":"none","side_effects":"none","auth":"none","errors":"none","dependencies":["localStorage"]},"calls":["localStorage.getItem"],"called_by":["theme state checks"],"related_files":[],"query_or_table_refs":[],"notes":"Theme getter: retrieves current theme from localStorage, defaults to light"}
{"file":"client/src/utils/themeManager.ts","lines":"61-63","symbol":"getAvailableThemes","kind":"function","export":"named","signature":"(): ThemeName[]","governs":{"ui":"none","state":"none","data":"none","routing":"none","side_effects":"none","auth":"none","errors":"none","dependencies":["THEMES"]},"calls":["Object.keys"],"called_by":["theme selection components"],"related_files":["client/src/themes/registry.ts"],"query_or_table_refs":[],"notes":"Theme lister: returns array of available theme names from registry"}
{"file":"client/src/utils/scrollToVerse.ts","lines":"5-42","symbol":"makeScrollToVerse","kind":"function","export":"named","signature":"(containerRef: React.RefObject<HTMLDivElement>): (ref: string) => void","governs":{"ui":"scrolls container to specific verse with highlighting","state":"none","data":"none","routing":"none","side_effects":"scroll position changes, temporary CSS class additions","auth":"none","errors":"handles missing verses gracefully","dependencies":["ROW_HEIGHT","getVerseKeys","containerRef"]},"calls":["getVerseKeys","findIndex","setTimeout","document.querySelector","classList.add","classList.remove","console.log"],"called_by":["verse navigation systems","SearchModal","cross-reference navigation"],"related_files":["client/src/lib/verseKeysLoader.ts","client/src/constants/layout.ts"],"query_or_table_refs":[],"notes":"Scroll to verse: factory function returns verse scroller, uses ROW_HEIGHT calculations, centers verse in viewport, optional flash highlight, dot format lookup"}